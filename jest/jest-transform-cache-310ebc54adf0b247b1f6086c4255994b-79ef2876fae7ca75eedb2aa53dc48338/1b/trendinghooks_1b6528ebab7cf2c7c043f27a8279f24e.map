{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/tanstack-api/trending/src/trending.hooks.ts"],"sourcesContent":["import { axiosClient } from \"@rp/react/axios-client\"\nimport { useInfiniteQuery, useQuery } from \"@tanstack/react-query\"\nimport { TrendingQueriesResponse, TrendingSearchesResponse } from \"./trending.types\"\n\nconst TRENDING_STALE_TIME = 15 * 1000\nconst TRENDING_PATH = \"/llm/trending\"\n\nconst trendingQueryKeys = {\n  all: () => [\"trending\"],\n  latest: () => [\"trending\", \"latest\"],\n}\n\nconst getTrendingSearches = async (pageParam: string | undefined) => {\n  const previous = pageParam || TRENDING_PATH\n  const {\n    data: { Location },\n  } = await axiosClient.get<{ Location: string }>(\n    `${previous}${pageParam ? \"&\" : \"?\"}status-code-override=true&type=searches`,\n  )\n  const { data } = await axiosClient.get<TrendingSearchesResponse>(Location, {\n    withCredentials: false,\n  })\n  return data\n}\n\nconst getTrendingQueries = async (pageParam: string | undefined) => {\n  const previous = pageParam || TRENDING_PATH\n  const {\n    data: { Location },\n  } = await axiosClient.get<{ Location: string }>(\n    `${previous}${pageParam ? \"&\" : \"?\"}status-code-override=true&type=queries`,\n  )\n  const { data } = await axiosClient.get<TrendingQueriesResponse>(Location, {\n    withCredentials: false,\n  })\n  return data\n}\n\nconst useTrendingSearches = () => {\n  return useInfiniteQuery({\n    queryKey: trendingQueryKeys.all(),\n    queryFn: ({ pageParam }) => getTrendingSearches(pageParam),\n    refetchOnWindowFocus: false,\n    staleTime: TRENDING_STALE_TIME,\n    getNextPageParam: (lastPage, arr) => {\n      if (arr.length > 4) return null\n      return lastPage.previous\n    },\n    retry: 3,\n    initialPageParam: \"\",\n  })\n}\n\nconst useLatestTrendingQueries = () => {\n  return useQuery({\n    queryKey: trendingQueryKeys.latest(),\n    queryFn: () => getTrendingQueries(undefined),\n    refetchOnWindowFocus: false,\n    staleTime: TRENDING_STALE_TIME,\n    retry: 3,\n  })\n}\n\nexport { useTrendingSearches, useLatestTrendingQueries }\n"],"names":["useLatestTrendingQueries","useTrendingSearches","TRENDING_STALE_TIME","TRENDING_PATH","trendingQueryKeys","all","latest","getTrendingSearches","pageParam","previous","data","Location","axiosClient","get","withCredentials","getTrendingQueries","useInfiniteQuery","queryKey","queryFn","refetchOnWindowFocus","staleTime","getNextPageParam","lastPage","arr","length","retry","initialPageParam","useQuery","undefined"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IA+D8BA,wBAAwB;eAAxBA;;IAArBC,mBAAmB;eAAnBA;;;6BA/DmB;4BACe;AAG3C,MAAMC,sBAAsB,KAAK;AACjC,MAAMC,gBAAgB;AAEtB,MAAMC,oBAAoB;IACxBC,KAAK,IAAM;YAAC;SAAW;IACvBC,QAAQ,IAAM;YAAC;YAAY;SAAS;AACtC;AAEA,MAAMC,sBAAsB,OAAOC;IACjC,MAAMC,WAAWD,aAAaL;IAC9B,MAAM,EACJO,MAAM,EAAEC,QAAQ,EAAE,EACnB,GAAG,MAAMC,wBAAW,CAACC,GAAG,CACvB,CAAC,EAAEJ,SAAS,EAAED,YAAY,MAAM,IAAI,uCAAuC,CAAC;IAE9E,MAAM,EAAEE,IAAI,EAAE,GAAG,MAAME,wBAAW,CAACC,GAAG,CAA2BF,UAAU;QACzEG,iBAAiB;IACnB;IACA,OAAOJ;AACT;AAEA,MAAMK,qBAAqB,OAAOP;IAChC,MAAMC,WAAWD,aAAaL;IAC9B,MAAM,EACJO,MAAM,EAAEC,QAAQ,EAAE,EACnB,GAAG,MAAMC,wBAAW,CAACC,GAAG,CACvB,CAAC,EAAEJ,SAAS,EAAED,YAAY,MAAM,IAAI,sCAAsC,CAAC;IAE7E,MAAM,EAAEE,IAAI,EAAE,GAAG,MAAME,wBAAW,CAACC,GAAG,CAA0BF,UAAU;QACxEG,iBAAiB;IACnB;IACA,OAAOJ;AACT;AAEA,MAAMT,sBAAsB;IAC1B,OAAOe,IAAAA,4BAAgB,EAAC;QACtBC,UAAUb,kBAAkBC,GAAG;QAC/Ba,SAAS,CAAC,EAAEV,SAAS,EAAE,GAAKD,oBAAoBC;QAChDW,sBAAsB;QACtBC,WAAWlB;QACXmB,kBAAkB,CAACC,UAAUC;YAC3B,IAAIA,IAAIC,MAAM,GAAG,GAAG,OAAO;YAC3B,OAAOF,SAASb,QAAQ;QAC1B;QACAgB,OAAO;QACPC,kBAAkB;IACpB;AACF;AAEA,MAAM1B,2BAA2B;IAC/B,OAAO2B,IAAAA,oBAAQ,EAAC;QACdV,UAAUb,kBAAkBE,MAAM;QAClCY,SAAS,IAAMH,mBAAmBa;QAClCT,sBAAsB;QACtBC,WAAWlB;QACXuB,OAAO;IACT;AACF"}