{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/files/src/lib/FilesUploadDropZone/FilesUploadDropZone.tsx"],"sourcesContent":["import { CSSProperties, useCallback } from \"react\"\nimport { FileRejection } from \"react-dropzone\"\nimport { adapters } from \"@rp/adapters\"\nimport { useUploadFilesContext } from \"@rp/react/common/providers\"\nimport { useQuota } from \"@rp/react/tanstack-api/file\"\nimport { DROP_ZONE_AREA_CLASS_NAME, DropZone } from \"@rp/react/web/common/base-components\"\nimport { ContactSupport } from \"@rp/react/web/common/providers\"\nimport { useSnackbar } from \"@rp/react/web/common/providers\"\nimport { FilesUploadOverlay } from \"./FilesUploadOverlay\"\n\ntype Props = {\n  children: React.ReactNode\n  disabled?: boolean\n  customDropZoneAreaStyle?: CSSProperties\n  customDropZoneStyle?: CSSProperties\n  customFileUploadOverlayStyle?: CSSProperties\n}\n\nexport const FilesUploadDropZone = ({\n  children,\n  disabled,\n  customDropZoneAreaStyle = {},\n  customFileUploadOverlayStyle = {},\n}: Props) => {\n  const { isOverLimit } = useQuota()\n  const { enqueueError } = useSnackbar()\n  const { addToUploadQueue } = useUploadFilesContext()\n\n  const onDrop = useCallback(\n    (acceptedFiles: Array<File>) => {\n      if (isOverLimit) return\n      addToUploadQueue(acceptedFiles, {\n        location: \"filesPage\",\n      })\n    },\n    [addToUploadQueue, isOverLimit],\n  )\n\n  const onDropRejected = useCallback(\n    (rejectedFiles: Array<FileRejection>) => {\n      // Invalid formats\n      const files: Array<string> = [\n        ...new Set<string>(rejectedFiles.map((file: FileRejection) => file.file.type)),\n      ]\n      const notSupported = files.join(\" ,\").replace(/application|\\/|image/gi, \"\")\n      // Error Snackbar\n      enqueueError(\n        `The files format ${notSupported} are not supported.`,\n        {\n          autoHideDuration: 5000,\n        },\n        { action: <ContactSupport /> },\n      )\n    },\n    [enqueueError],\n  )\n\n  return (\n    <DropZone\n      onDrop={onDrop}\n      onDropRejected={onDropRejected}\n      disabled={disabled}\n      Overlay={<FilesUploadOverlay style={customFileUploadOverlayStyle} />}\n      accept={adapters.file.getTaExtension().join(\", \")}\n      sx={{\n        [`& .${DROP_ZONE_AREA_CLASS_NAME}`]: {\n          display: \"flex\",\n          flexGrow: 1,\n          width: \"100%\",\n          height: \"100%\",\n          position: \"relative\",\n          maxHeight: \"100%\",\n          overflow: \"hidden\",\n          ...customDropZoneAreaStyle,\n        },\n      }}\n      multiple\n    >\n      {children}\n    </DropZone>\n  )\n}\n"],"names":["FilesUploadDropZone","children","disabled","customDropZoneAreaStyle","customFileUploadOverlayStyle","isOverLimit","useQuota","enqueueError","useSnackbar","addToUploadQueue","useUploadFilesContext","onDrop","useCallback","acceptedFiles","location","onDropRejected","rejectedFiles","files","Set","map","file","type","notSupported","join","replace","autoHideDuration","action","ContactSupport","DropZone","Overlay","FilesUploadOverlay","style","accept","adapters","getTaExtension","sx","DROP_ZONE_AREA_CLASS_NAME","display","flexGrow","width","height","position","maxHeight","overflow","multiple"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAkBaA;;;eAAAA;;;;uBAlB8B;0BAElB;2BACa;sBACb;gCAC2B;4BACrB;oCAEI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAU5B,MAAMA,sBAAsB,CAAC,EAClCC,QAAQ,EACRC,QAAQ,EACRC,0BAA0B,CAAC,CAAC,EAC5BC,+BAA+B,CAAC,CAAC,EAC3B;IACN,MAAM,EAAEC,WAAW,EAAE,GAAGC,IAAAA,cAAQ;IAChC,MAAM,EAAEC,YAAY,EAAE,GAAGC,IAAAA,uBAAW;IACpC,MAAM,EAAEC,gBAAgB,EAAE,GAAGC,IAAAA,gCAAqB;IAElD,MAAMC,SAASC,IAAAA,kBAAW,EACxB,CAACC;QACC,IAAIR,aAAa;QACjBI,iBAAiBI,eAAe;YAC9BC,UAAU;QACZ;IACF,GACA;QAACL;QAAkBJ;KAAY;IAGjC,MAAMU,iBAAiBH,IAAAA,kBAAW,EAChC,CAACI;QACC,kBAAkB;QAClB,MAAMC,QAAuB;eACxB,IAAIC,IAAYF,cAAcG,GAAG,CAAC,CAACC,OAAwBA,KAAKA,IAAI,CAACC,IAAI;SAC7E;QACD,MAAMC,eAAeL,MAAMM,IAAI,CAAC,MAAMC,OAAO,CAAC,0BAA0B;QACxE,iBAAiB;QACjBjB,aACE,CAAC,iBAAiB,EAAEe,aAAa,mBAAmB,CAAC,EACrD;YACEG,kBAAkB;QACpB,GACA;YAAEC,sBAAQ,qBAACC,0BAAc;QAAI;IAEjC,GACA;QAACpB;KAAa;IAGhB,qBACE,qBAACqB,wBAAQ;QACPjB,QAAQA;QACRI,gBAAgBA;QAChBb,UAAUA;QACV2B,uBAAS,qBAACC,sCAAkB;YAACC,OAAO3B;;QACpC4B,QAAQC,kBAAQ,CAACb,IAAI,CAACc,cAAc,GAAGX,IAAI,CAAC;QAC5CY,IAAI;YACF,CAAC,CAAC,GAAG,EAAEC,yCAAyB,CAAC,CAAC,CAAC,EAAE;gBACnCC,SAAS;gBACTC,UAAU;gBACVC,OAAO;gBACPC,QAAQ;gBACRC,UAAU;gBACVC,WAAW;gBACXC,UAAU;eACPxC;QAEP;QACAyC,QAAQ;kBAEP3C;;AAGP"}