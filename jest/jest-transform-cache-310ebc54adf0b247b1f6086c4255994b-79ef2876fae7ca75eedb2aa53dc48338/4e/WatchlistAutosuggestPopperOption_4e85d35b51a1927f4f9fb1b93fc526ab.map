{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/search-autosuggest-input/src/lib/UnifiedSearch/WatchlistAutosuggestPopperOption.tsx"],"sourcesContent":["import match from \"autosuggest-highlight/match\"\nimport parse from \"autosuggest-highlight/parse\"\nimport {\n  EnhancedCompanySuggestion,\n  EnhancedEntitySuggestion,\n  EnhancedSuggestion,\n  EntitySuggestion,\n  groupCompanySuggestions,\n  isCompanySuggestion,\n  isETFSuggestion,\n} from \"@rp/react/tanstack-api/suggestion\"\nimport { LazyImage, PrimaryCheckedLabel } from \"@rp/react/web/common/base-components\"\nimport { EllipsisTooltip } from \"@rp/react/web/common/composite-components\"\nimport { IconEntity } from \"@rp/react/web/icons\"\nimport { Box, ButtonBase, Typography, lighten, styled } from \"@rp/react/web/mui/core\"\nimport { HightLightText } from \"../SuggestionInput\"\nimport { WatchlistNestedSuggestionIcon } from \"./WatchlistNestedSuggestedIcon\"\n\nconst Icon = styled(IconEntity)(({ theme }) => ({\n  color: theme.palette.grey[200],\n  width: 20,\n  height: 20,\n}))\n\ntype Props = {\n  entity: ReturnType<typeof groupCompanySuggestions>[0]\n  highlightValue: string\n  onClick: (entity: EnhancedEntitySuggestion | EnhancedCompanySuggestion) => void\n  toggleSubsidiaries?: (id: string) => void\n  selectedOption: string | null\n  showTicker?: boolean\n  backgroundColor?: string\n  isChecked?: boolean\n  id: string\n}\n\nconst style = { ml: 1, fontSize: 14, width: 70, fontWeight: 700 }\n\nconst ItemIcon = ({\n  entity,\n  isChecked,\n}: {\n  entity: EnhancedEntitySuggestion | EnhancedCompanySuggestion\n  isChecked?: boolean\n}) => {\n  const icon = entity.category === \"ETFs\" ? \"ETF\" : entity.entityType ?? \"COMP\"\n  if (isChecked) {\n    return (\n      <Box sx={{ \"& p\": { fontSize: 16, px: \"2px\" } }}>\n        <PrimaryCheckedLabel label=\"\" />\n      </Box>\n    )\n  }\n  return entity.metadata4 ? (\n    <LazyImage\n      src={entity.metadata4}\n      alt={entity.name}\n      width={20}\n      height={20}\n      loadingFallback={<Box sx={{ width: 20, height: 20 }} />}\n      fallback={<Icon icon={icon} />}\n    />\n  ) : (\n    <Icon icon={icon} />\n  )\n}\n\nconst isEntitySuggestionWithSubsidiaries = (\n  suggestion: (EnhancedSuggestion | EntitySuggestion) & {\n    subsidiaries?: Array<EnhancedSuggestion>\n  },\n): suggestion is (EnhancedEntitySuggestion | EnhancedCompanySuggestion) & {\n  subsidiaries: Array<EnhancedSuggestion>\n} => {\n  return \"entityType\" in suggestion\n}\n\nexport const WatchlistAutosuggestPopperOption = ({\n  entity,\n  onClick,\n  toggleSubsidiaries,\n  highlightValue,\n  selectedOption,\n  showTicker,\n  backgroundColor,\n  isChecked,\n  id,\n}: Props) => {\n  if (!isEntitySuggestionWithSubsidiaries(entity)) return null\n  const displayLabel = entity.name || entity.label\n  const matches = match(displayLabel, highlightValue)\n  const parts = parse(displayLabel, matches)\n  const hasTicker = (isCompanySuggestion(entity) || isETFSuggestion(entity)) && entity.ticker\n\n  const onToggleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.stopPropagation()\n    event.preventDefault()\n    toggleSubsidiaries?.(id)\n  }\n\n  const isSubsidiary =\n    (isCompanySuggestion(entity) &&\n      !(entity.subsidiaries?.length > 0 && !!entity.parent1) &&\n      entity.typeDesc === \"Subsidiary\" &&\n      entity.subsidiaries?.[0].key !== entity.parent1?.key) ||\n    entity.nested\n\n  return (\n    <Box\n      id={id}\n      onClick={() => onClick(entity)}\n      sx={theme => ({\n        display: \"flex\",\n        alignItems: \"center\",\n        position: \"relative\",\n        p: 1,\n        pl: isSubsidiary ? (showTicker ? 13 : 3) : 1,\n        cursor: \"pointer\",\n        \"&:hover\": {\n          backgroundColor: lighten(backgroundColor ?? theme.palette.elevation.dp24, 0.1),\n        },\n        background:\n          selectedOption === entity.id\n            ? lighten(backgroundColor ?? theme.palette.elevation.dp24, 0.1)\n            : \"transparent\",\n      })}\n    >\n      {isSubsidiary ? (\n        <WatchlistNestedSuggestionIcon showTicker={showTicker} type={entity.nested ?? \"default\"} />\n      ) : null}\n      <Box sx={{ display: \"flex\", alignItems: \"center\", pl: 1 }}>\n        <ItemIcon entity={entity} isChecked={isChecked} />\n        {hasTicker && showTicker && !isSubsidiary && (\n          <EllipsisTooltip tooltipText={entity.ticker} typographyProps={style}>\n            {entity.ticker}\n          </EllipsisTooltip>\n        )}\n        {!hasTicker && showTicker && !isSubsidiary && <Typography sx={style}>&nbsp;</Typography>}\n      </Box>\n      <EllipsisTooltip\n        tooltipText={displayLabel}\n        typographyProps={{\n          flexGrow: 1,\n          ml: 2,\n          fontSize: 14,\n        }}\n      >\n        {parts.map((part, i) => (\n          <HightLightText component=\"span\" key={i} highlight={part.highlight}>\n            {part.text}\n          </HightLightText>\n        ))}\n        {entity.subsidiaries?.length ? (\n          <ButtonBase\n            onClick={onToggleClick}\n            sx={theme => ({\n              fontSize: 12,\n              fontFamily: theme.typography.fontFamily,\n              color: theme.palette.primary.light,\n              marginLeft: theme.spacing(1.5),\n              p: 0.5,\n              \":hover\": {\n                textDecoration: \"underline\",\n              },\n            })}\n          >\n            {entity.subsidiaries?.length} related\n          </ButtonBase>\n        ) : null}\n      </EllipsisTooltip>\n      <Typography sx={{ fontSize: 12, color: \"text.secondary\" }}>{entity.typeDesc}</Typography>\n    </Box>\n  )\n}\n"],"names":["WatchlistAutosuggestPopperOption","Icon","styled","IconEntity","theme","color","palette","grey","width","height","style","ml","fontSize","fontWeight","ItemIcon","entity","isChecked","icon","category","entityType","Box","sx","px","PrimaryCheckedLabel","label","metadata4","LazyImage","src","alt","name","loadingFallback","fallback","isEntitySuggestionWithSubsidiaries","suggestion","onClick","toggleSubsidiaries","highlightValue","selectedOption","showTicker","backgroundColor","id","displayLabel","matches","match","parts","parse","hasTicker","isCompanySuggestion","isETFSuggestion","ticker","onToggleClick","event","stopPropagation","preventDefault","isSubsidiary","subsidiaries","length","parent1","typeDesc","key","nested","display","alignItems","position","p","pl","cursor","lighten","elevation","dp24","background","WatchlistNestedSuggestionIcon","type","EllipsisTooltip","tooltipText","typographyProps","Typography","flexGrow","map","part","i","HightLightText","component","highlight","text","ButtonBase","fontFamily","typography","primary","light","marginLeft","spacing","textDecoration"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}