{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/components/Hub/Watchlists/PortfolioView/PortfolioView.test.tsx"],"sourcesContent":["import { useCqsByIdsContext } from \"@rp/react/tanstack-api/cqs-by-ids\"\nimport { useWatchlist } from \"@rp/react/tanstack-api/watchlist\"\nimport { renderWithProviders } from \"@rp/react/web/common/tools\"\nimport { WatchlistIcon } from \"@rp/react/web/icons\"\nimport { waitFor } from \"@testing-library/react\"\nimport { PortfolioView } from \"./PortfolioView\"\n\nconst mockUseCqsByIdsContext = useCqsByIdsContext as jest.Mock\nconst mockUseWatchlist = useWatchlist as jest.Mock\n\njest.mock(\"@rp/react/tanstack-api/watchlist\", () => ({\n  ...jest.requireActual(\"@rp/react/tanstack-api/watchlist\"),\n  useWatchlist: jest.fn(),\n  useWatchlistsActions: jest.fn(),\n}))\n\njest.mock(\"@rp/react/tanstack-api/cqs-by-ids\", () => ({\n  ...jest.requireActual(\"@rp/react/tanstack-api/cqs-by-ids\"),\n  useCqsByIdsContext: jest.fn(),\n}))\n\nconst mockHistoryPush = jest.fn()\njest.mock(\"react-router-dom\", () => ({\n  ...jest.requireActual(\"react-router-dom\"),\n  useNavigate: () => mockHistoryPush,\n}))\n\nconst dummyWatchlist = {\n  dateCreated: \"2021-07-19T13:38:14.556394\",\n  lastUpdated: \"2021-07-30T15:02:31.600256\",\n  name: \"Tesla and Apple\",\n  subType: \"comp:public\",\n  items: [\"DD3BB1\", \"D8442A\"],\n  id: \"19b2a02d-10ea-4f87-ac34-768ffb8e454d\",\n  owner: \"test@test.com\",\n  shared: { company: { permission: \"read\", id: \"RavenPack\" }, users: [] },\n}\n\nconst mockByIds = {\n  ids: {\n    DD3BB1: {\n      data: {\n        key: \"DD3BB1\",\n        name: \"Bibble\",\n        queryType: \"entity\",\n        volume: 0,\n        queryRelationship: \"direct\",\n      },\n      isLoading: false,\n      isError: false,\n      startLoading: false,\n    },\n    D8442A: {\n      data: {\n        key: \"D8442A\",\n        name: \"Wibble\",\n        queryType: \"entity\",\n        volume: 0,\n        queryRelationship: \"direct\",\n      },\n      isLoading: false,\n      isError: false,\n      startLoading: false,\n    },\n  },\n  addByIds: jest.fn(),\n}\n\nconst props = {\n  icon: WatchlistIcon,\n  iconFill: \"#5DADFF\",\n  iconSize: 24,\n  id: dummyWatchlist.id,\n  runSearch: jest.fn(),\n  onShare: jest.fn(),\n}\n\njest.mock(\"@rp/react/common/providers\", () => ({\n  ...jest.requireActual(\"@rp/react/common/providers\"),\n  useAccount: jest.fn(() => ({\n    canShare: true,\n    hasEntitlement: jest.fn(() => true),\n  })),\n}))\n\ntest(\"should render the watchlist editor\", () => {\n  mockUseCqsByIdsContext.mockReturnValue(mockByIds)\n  mockUseWatchlist.mockReturnValue({\n    data: dummyWatchlist,\n    isLoading: false,\n  })\n\n  const { getByText } = renderWithProviders(<PortfolioView {...props} />)\n\n  expect(getByText(\"Tesla and Apple\")).toBeInTheDocument()\n})\n\ntest(\"should render the watchlist editor with no items\", () => {\n  mockUseWatchlist.mockReturnValue({\n    data: { ...dummyWatchlist, items: [] },\n    isLoading: false,\n  })\n  mockUseCqsByIdsContext.mockReturnValue(mockByIds)\n\n  const { findByText } = renderWithProviders(<PortfolioView {...props} />)\n\n  waitFor(() =>\n    expect(\n      findByText(\n        \"We couldn't find any results that match your search criteria. Please try again with different keywords.\",\n      ),\n    ).toBeInTheDocument(),\n  )\n})\n\ntest(\"should render the watchlist editor loading\", () => {\n  mockUseWatchlist.mockReturnValue({ isLoading: true })\n\n  const { getByTestId } = renderWithProviders(<PortfolioView {...props} />)\n  expect(getByTestId(\"loading-spinner\")).toBeInTheDocument()\n})\n"],"names":["jest","mock","requireActual","useWatchlist","fn","useWatchlistsActions","useCqsByIdsContext","useNavigate","mockHistoryPush","useAccount","canShare","hasEntitlement","mockUseCqsByIdsContext","mockUseWatchlist","dummyWatchlist","dateCreated","lastUpdated","name","subType","items","id","owner","shared","company","permission","users","mockByIds","ids","DD3BB1","data","key","queryType","volume","queryRelationship","isLoading","isError","startLoading","D8442A","addByIds","props","icon","WatchlistIcon","iconFill","iconSize","runSearch","onShare","test","mockReturnValue","getByText","renderWithProviders","PortfolioView","expect","toBeInTheDocument","findByText","waitFor","getByTestId"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";AAUAA,KAAKC,IAAI,CAAC,oCAAoC,IAAO,wCAChDD,KAAKE,aAAa,CAAC;QACtBC,cAAcH,KAAKI,EAAE;QACrBC,sBAAsBL,KAAKI,EAAE;;AAG/BJ,KAAKC,IAAI,CAAC,qCAAqC,IAAO,wCACjDD,KAAKE,aAAa,CAAC;QACtBI,oBAAoBN,KAAKI,EAAE;;AAI7BJ,KAAKC,IAAI,CAAC,oBAAoB,IAAO,wCAChCD,KAAKE,aAAa,CAAC;QACtBK,aAAa,IAAMC;;AAqDrBR,KAAKC,IAAI,CAAC,8BAA8B,IAAO,wCAC1CD,KAAKE,aAAa,CAAC;QACtBO,YAAYT,KAAKI,EAAE,CAAC,IAAO,CAAA;gBACzBM,UAAU;gBACVC,gBAAgBX,KAAKI,EAAE,CAAC,IAAM;YAChC,CAAA;;;;;;0BAlFiC;2BACN;uBACO;uBACN;uBACN;+BACM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE9B,MAAMQ,yBAAyBN,4BAAkB;AACjD,MAAMO,mBAAmBV,uBAAY;AAarC,MAAMK,kBAAkBR,KAAKI,EAAE;AAM/B,MAAMU,iBAAiB;IACrBC,aAAa;IACbC,aAAa;IACbC,MAAM;IACNC,SAAS;IACTC,OAAO;QAAC;QAAU;KAAS;IAC3BC,IAAI;IACJC,OAAO;IACPC,QAAQ;QAAEC,SAAS;YAAEC,YAAY;YAAQJ,IAAI;QAAY;QAAGK,OAAO,EAAE;IAAC;AACxE;AAEA,MAAMC,YAAY;IAChBC,KAAK;QACHC,QAAQ;YACNC,MAAM;gBACJC,KAAK;gBACLb,MAAM;gBACNc,WAAW;gBACXC,QAAQ;gBACRC,mBAAmB;YACrB;YACAC,WAAW;YACXC,SAAS;YACTC,cAAc;QAChB;QACAC,QAAQ;YACNR,MAAM;gBACJC,KAAK;gBACLb,MAAM;gBACNc,WAAW;gBACXC,QAAQ;gBACRC,mBAAmB;YACrB;YACAC,WAAW;YACXC,SAAS;YACTC,cAAc;QAChB;IACF;IACAE,UAAUtC,KAAKI,EAAE;AACnB;AAEA,MAAMmC,QAAQ;IACZC,MAAMC,oBAAa;IACnBC,UAAU;IACVC,UAAU;IACVvB,IAAIN,eAAeM,EAAE;IACrBwB,WAAW5C,KAAKI,EAAE;IAClByC,SAAS7C,KAAKI,EAAE;AAClB;AAUA0C,KAAK,sCAAsC;IACzClC,uBAAuBmC,eAAe,CAACrB;IACvCb,iBAAiBkC,eAAe,CAAC;QAC/BlB,MAAMf;QACNoB,WAAW;IACb;IAEA,MAAM,EAAEc,SAAS,EAAE,GAAGC,IAAAA,0BAAmB,gBAAC,qBAACC,4BAAa,qBAAKX;IAE7DY,OAAOH,UAAU,oBAAoBI,iBAAiB;AACxD;AAEAN,KAAK,oDAAoD;IACvDjC,iBAAiBkC,eAAe,CAAC;QAC/BlB,MAAM,wCAAKf;YAAgBK,OAAO,EAAE;;QACpCe,WAAW;IACb;IACAtB,uBAAuBmC,eAAe,CAACrB;IAEvC,MAAM,EAAE2B,UAAU,EAAE,GAAGJ,IAAAA,0BAAmB,gBAAC,qBAACC,4BAAa,qBAAKX;IAE9De,IAAAA,cAAO,EAAC,IACNH,OACEE,WACE,4GAEFD,iBAAiB;AAEvB;AAEAN,KAAK,8CAA8C;IACjDjC,iBAAiBkC,eAAe,CAAC;QAAEb,WAAW;IAAK;IAEnD,MAAM,EAAEqB,WAAW,EAAE,GAAGN,IAAAA,0BAAmB,gBAAC,qBAACC,4BAAa,qBAAKX;IAC/DY,OAAOI,YAAY,oBAAoBH,iBAAiB;AAC1D"}