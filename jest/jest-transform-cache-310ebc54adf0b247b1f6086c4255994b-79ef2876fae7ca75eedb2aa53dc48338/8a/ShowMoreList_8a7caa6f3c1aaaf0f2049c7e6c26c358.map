{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/composite-components/src/ShowMoreList/ShowMoreList.tsx"],"sourcesContent":["import { JSX, useCallback, useEffect, useRef, useState } from \"react\"\nimport { Box, CircularProgress, Link, styled } from \"@rp/react/web/mui/core\"\n\nconst ShowMore = styled(\"div\")(() => ({\n  textAlign: \"center\",\n  \"& a\": {\n    cursor: \"pointer\",\n    display: \"inline-block\",\n  },\n}))\n\ntype Props<ItemType> = {\n  items: Array<ItemType>\n  renderItem: (item: ItemType, index: number) => JSX.Element\n  fetchNextPage?: () => void\n  hasNextPage?: boolean | undefined\n  loading?: boolean\n  showNextItemsNum?: boolean\n  paginate?: number\n  onShowLess?: () => void\n  showMoreLabel?: { more: string; less: string }\n}\n\nfunction ShowMoreList<ItemType = unknown>({\n  items,\n  renderItem,\n  fetchNextPage,\n  hasNextPage = false,\n  loading = false,\n  paginate = 5,\n  showNextItemsNum = false,\n  onShowLess,\n  showMoreLabel = { more: \"SHOW MORE\", less: \"SHOW LESS\" },\n}: Props<ItemType>) {\n  const myRef = useRef<HTMLDivElement>(null)\n  const [numOfStories, setNumOfStories] = useState(paginate)\n  const showLess = numOfStories >= items.length && !hasNextPage\n  const showProgress = loading && items.length < numOfStories\n\n  const handleShowMore = useCallback(() => {\n    if (showLess) {\n      setNumOfStories(paginate)\n      myRef?.current?.scrollIntoView({\n        behavior: \"smooth\",\n        block: \"start\",\n        inline: \"nearest\",\n      })\n      onShowLess?.()\n    } else {\n      setNumOfStories(prev => prev + paginate)\n    }\n  }, [showLess, paginate, onShowLess])\n\n  useEffect(() => {\n    if (numOfStories >= items.length - paginate && hasNextPage && fetchNextPage) {\n      fetchNextPage()\n    }\n  }, [fetchNextPage, numOfStories, items, hasNextPage, paginate])\n\n  const next = Math.min(paginate, items.length - numOfStories)\n\n  return (\n    <Box ref={myRef}>\n      {items.filter((_, index) => index < numOfStories).map(renderItem)}\n      {showProgress && (\n        <CircularProgress\n          data-testid=\"show-more-list-loading\"\n          sx={{ display: \"flex\", margin: \"0 auto\" }}\n        />\n      )}\n      {items.length > paginate && !showProgress ? (\n        <ShowMore>\n          <Link onClick={handleShowMore}>\n            {showLess\n              ? showMoreLabel.less\n              : `${showMoreLabel.more}${showNextItemsNum ? ` (${next})` : \"\"}`}\n          </Link>\n        </ShowMore>\n      ) : null}\n    </Box>\n  )\n}\n\nexport { ShowMoreList }\n"],"names":["ShowMoreList","ShowMore","styled","textAlign","cursor","display","items","renderItem","fetchNextPage","hasNextPage","loading","paginate","showNextItemsNum","onShowLess","showMoreLabel","more","less","myRef","useRef","numOfStories","setNumOfStories","useState","showLess","length","showProgress","handleShowMore","useCallback","current","scrollIntoView","behavior","block","inline","prev","useEffect","next","Math","min","Box","ref","filter","_","index","map","CircularProgress","data-testid","sx","margin","Link","onClick"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAmFSA;;;eAAAA;;;;uBAnFqD;sBACV;AAEpD,MAAMC,WAAWC,IAAAA,YAAM,EAAC,OAAO,IAAO,CAAA;QACpCC,WAAW;QACX,OAAO;YACLC,QAAQ;YACRC,SAAS;QACX;IACF,CAAA;AAcA,SAASL,aAAiC,EACxCM,KAAK,EACLC,UAAU,EACVC,aAAa,EACbC,cAAc,KAAK,EACnBC,UAAU,KAAK,EACfC,WAAW,CAAC,EACZC,mBAAmB,KAAK,EACxBC,UAAU,EACVC,gBAAgB;IAAEC,MAAM;IAAaC,MAAM;AAAY,CAAC,EACxC;IAChB,MAAMC,QAAQC,IAAAA,aAAM,EAAiB;IACrC,MAAM,CAACC,cAAcC,gBAAgB,GAAGC,IAAAA,eAAQ,EAACV;IACjD,MAAMW,WAAWH,gBAAgBb,MAAMiB,MAAM,IAAI,CAACd;IAClD,MAAMe,eAAed,WAAWJ,MAAMiB,MAAM,GAAGJ;IAE/C,MAAMM,iBAAiBC,IAAAA,kBAAW,EAAC;QACjC,IAAIJ,UAAU;gBAEZL;YADAG,gBAAgBT;YAChBM,kBAAAA,6BAAAA,iBAAAA,MAAOU,OAAO,cAAdV,qCAAAA,eAAgBW,cAAc,CAAC;gBAC7BC,UAAU;gBACVC,OAAO;gBACPC,QAAQ;YACV;YACAlB,uBAAAA,iCAAAA;QACF,OAAO;YACLO,gBAAgBY,CAAAA,OAAQA,OAAOrB;QACjC;IACF,GAAG;QAACW;QAAUX;QAAUE;KAAW;IAEnCoB,IAAAA,gBAAS,EAAC;QACR,IAAId,gBAAgBb,MAAMiB,MAAM,GAAGZ,YAAYF,eAAeD,eAAe;YAC3EA;QACF;IACF,GAAG;QAACA;QAAeW;QAAcb;QAAOG;QAAaE;KAAS;IAE9D,MAAMuB,OAAOC,KAAKC,GAAG,CAACzB,UAAUL,MAAMiB,MAAM,GAAGJ;IAE/C,qBACE,sBAACkB,SAAG;QAACC,KAAKrB;;YACPX,MAAMiC,MAAM,CAAC,CAACC,GAAGC,QAAUA,QAAQtB,cAAcuB,GAAG,CAACnC;YACrDiB,8BACC,qBAACmB,sBAAgB;gBACfC,eAAY;gBACZC,IAAI;oBAAExC,SAAS;oBAAQyC,QAAQ;gBAAS;;YAG3CxC,MAAMiB,MAAM,GAAGZ,YAAY,CAACa,6BAC3B,qBAACvB;0BACC,cAAA,qBAAC8C,UAAI;oBAACC,SAASvB;8BACZH,WACGR,cAAcE,IAAI,GAClB,CAAC,EAAEF,cAAcC,IAAI,CAAC,EAAEH,mBAAmB,CAAC,EAAE,EAAEsB,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC;;iBAGpE;;;AAGV"}