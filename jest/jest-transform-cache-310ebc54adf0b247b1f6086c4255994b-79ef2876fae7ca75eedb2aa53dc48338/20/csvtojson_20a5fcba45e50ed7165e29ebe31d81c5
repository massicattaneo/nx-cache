6a90699ff7e634434741808d819de642
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "csvToJson", {
    enumerable: true,
    get: function() {
        return csvToJson;
    }
});
const csvToJson = (csv, options)=>{
    const json = [];
    const [firstLine] = csv.split("\n");
    const rawFields = firstLine.split(",").map((key)=>key.trim());
    const fields = (options === null || options === void 0 ? void 0 : options.formatFields) ? rawFields.map(options.formatFields) : rawFields;
    let body = csv.replace(`${firstLine}\n`, "");
    while(body.length > 0){
        const line = {};
        while(Object.keys(line).length < fields.length){
            let piece = "";
            const startWithDoubleQuotes = body.startsWith('"');
            const splitter = Object.keys(line).length === fields.length - 1 ? "\n" : ",";
            if (!startWithDoubleQuotes) {
                piece = body.split(splitter)[0];
                body = body.replace(`${piece}${splitter}`, "");
            } else {
                piece = body.split('",')[0].replace('"', "");
                body = body.replace(`"${piece}"${splitter}`, "");
            }
            line[fields[Object.keys(line).length]] = piece;
        }
        json.push(line);
    }
    return {
        json,
        fields
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvY29tbW9uL3V0aWxzL3NyYy9saWIvY3N2LXRvLWpzb24vY3N2LXRvLWpzb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsidHlwZSBPcHRpb25zID0ge1xuICBmb3JtYXRGaWVsZHM/OiAocmF3RmllbGQ6IHN0cmluZykgPT4gc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBjc3ZUb0pzb24gPSAoY3N2OiBzdHJpbmcsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiB7XG4gIGNvbnN0IGpzb246IEFycmF5PFJlY29yZDxzdHJpbmcsIHN0cmluZz4+ID0gW11cbiAgY29uc3QgW2ZpcnN0TGluZV0gPSBjc3Yuc3BsaXQoXCJcXG5cIilcbiAgY29uc3QgcmF3RmllbGRzID0gZmlyc3RMaW5lLnNwbGl0KFwiLFwiKS5tYXAoa2V5ID0+IGtleS50cmltKCkpXG4gIGNvbnN0IGZpZWxkcyA9IG9wdGlvbnM/LmZvcm1hdEZpZWxkcyA/IHJhd0ZpZWxkcy5tYXAob3B0aW9ucy5mb3JtYXRGaWVsZHMpIDogcmF3RmllbGRzXG4gIGxldCBib2R5ID0gY3N2LnJlcGxhY2UoYCR7Zmlyc3RMaW5lfVxcbmAsIFwiXCIpXG4gIHdoaWxlIChib2R5Lmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBsaW5lOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgICB3aGlsZSAoT2JqZWN0LmtleXMobGluZSkubGVuZ3RoIDwgZmllbGRzLmxlbmd0aCkge1xuICAgICAgbGV0IHBpZWNlID0gXCJcIlxuICAgICAgY29uc3Qgc3RhcnRXaXRoRG91YmxlUXVvdGVzID0gYm9keS5zdGFydHNXaXRoKCdcIicpXG4gICAgICBjb25zdCBzcGxpdHRlciA9IE9iamVjdC5rZXlzKGxpbmUpLmxlbmd0aCA9PT0gZmllbGRzLmxlbmd0aCAtIDEgPyBcIlxcblwiIDogXCIsXCJcbiAgICAgIGlmICghc3RhcnRXaXRoRG91YmxlUXVvdGVzKSB7XG4gICAgICAgIHBpZWNlID0gYm9keS5zcGxpdChzcGxpdHRlcilbMF1cbiAgICAgICAgYm9keSA9IGJvZHkucmVwbGFjZShgJHtwaWVjZX0ke3NwbGl0dGVyfWAsIFwiXCIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwaWVjZSA9IGJvZHkuc3BsaXQoJ1wiLCcpWzBdLnJlcGxhY2UoJ1wiJywgXCJcIilcbiAgICAgICAgYm9keSA9IGJvZHkucmVwbGFjZShgXCIke3BpZWNlfVwiJHtzcGxpdHRlcn1gLCBcIlwiKVxuICAgICAgfVxuICAgICAgbGluZVtmaWVsZHNbT2JqZWN0LmtleXMobGluZSkubGVuZ3RoXV0gPSBwaWVjZVxuICAgIH1cbiAgICBqc29uLnB1c2gobGluZSlcbiAgfVxuICByZXR1cm4geyBqc29uLCBmaWVsZHMgfVxufVxuIl0sIm5hbWVzIjpbImNzdlRvSnNvbiIsImNzdiIsIm9wdGlvbnMiLCJqc29uIiwiZmlyc3RMaW5lIiwic3BsaXQiLCJyYXdGaWVsZHMiLCJtYXAiLCJrZXkiLCJ0cmltIiwiZmllbGRzIiwiZm9ybWF0RmllbGRzIiwiYm9keSIsInJlcGxhY2UiLCJsZW5ndGgiLCJsaW5lIiwiT2JqZWN0Iiwia2V5cyIsInBpZWNlIiwic3RhcnRXaXRoRG91YmxlUXVvdGVzIiwic3RhcnRzV2l0aCIsInNwbGl0dGVyIiwicHVzaCJdLCJyYW5nZU1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyIsIm1hcHBpbmdzIjoiOzs7OytCQUlhQTs7O2VBQUFBOzs7QUFBTixNQUFNQSxZQUFZLENBQUNDLEtBQWFDO0lBQ3JDLE1BQU1DLE9BQXNDLEVBQUU7SUFDOUMsTUFBTSxDQUFDQyxVQUFVLEdBQUdILElBQUlJLEtBQUssQ0FBQztJQUM5QixNQUFNQyxZQUFZRixVQUFVQyxLQUFLLENBQUMsS0FBS0UsR0FBRyxDQUFDQyxDQUFBQSxNQUFPQSxJQUFJQyxJQUFJO0lBQzFELE1BQU1DLFNBQVNSLENBQUFBLG9CQUFBQSw4QkFBQUEsUUFBU1MsWUFBWSxJQUFHTCxVQUFVQyxHQUFHLENBQUNMLFFBQVFTLFlBQVksSUFBSUw7SUFDN0UsSUFBSU0sT0FBT1gsSUFBSVksT0FBTyxDQUFDLENBQUMsRUFBRVQsVUFBVSxFQUFFLENBQUMsRUFBRTtJQUN6QyxNQUFPUSxLQUFLRSxNQUFNLEdBQUcsRUFBRztRQUN0QixNQUFNQyxPQUErQixDQUFDO1FBQ3RDLE1BQU9DLE9BQU9DLElBQUksQ0FBQ0YsTUFBTUQsTUFBTSxHQUFHSixPQUFPSSxNQUFNLENBQUU7WUFDL0MsSUFBSUksUUFBUTtZQUNaLE1BQU1DLHdCQUF3QlAsS0FBS1EsVUFBVSxDQUFDO1lBQzlDLE1BQU1DLFdBQVdMLE9BQU9DLElBQUksQ0FBQ0YsTUFBTUQsTUFBTSxLQUFLSixPQUFPSSxNQUFNLEdBQUcsSUFBSSxPQUFPO1lBQ3pFLElBQUksQ0FBQ0ssdUJBQXVCO2dCQUMxQkQsUUFBUU4sS0FBS1AsS0FBSyxDQUFDZ0IsU0FBUyxDQUFDLEVBQUU7Z0JBQy9CVCxPQUFPQSxLQUFLQyxPQUFPLENBQUMsQ0FBQyxFQUFFSyxNQUFNLEVBQUVHLFNBQVMsQ0FBQyxFQUFFO1lBQzdDLE9BQU87Z0JBQ0xILFFBQVFOLEtBQUtQLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDUSxPQUFPLENBQUMsS0FBSztnQkFDekNELE9BQU9BLEtBQUtDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRUssTUFBTSxDQUFDLEVBQUVHLFNBQVMsQ0FBQyxFQUFFO1lBQy9DO1lBQ0FOLElBQUksQ0FBQ0wsTUFBTSxDQUFDTSxPQUFPQyxJQUFJLENBQUNGLE1BQU1ELE1BQU0sQ0FBQyxDQUFDLEdBQUdJO1FBQzNDO1FBQ0FmLEtBQUttQixJQUFJLENBQUNQO0lBQ1o7SUFDQSxPQUFPO1FBQUVaO1FBQU1PO0lBQU87QUFDeEIifQ==