{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/common/hooks/src/lib/useChat/useChat.types.ts"],"sourcesContent":["import { DatasetScope } from \"@rp/common/api-types\"\nimport { WorkflowState } from \"@rp/react/common/workflow\"\nimport {\n  ChatFile,\n  ChatInteractionType,\n  SeededInteraction,\n  StoredAuditTrace,\n  StoredResponseBlockList,\n  UserInteraction,\n} from \"@rp/react/tanstack-api/chat\"\nimport {\n  EngineChartContent,\n  LLMFollowUpMessage,\n  LlmAuditTraceMessage,\n  LlmDocumentSource,\n  LlmExternalSource,\n  LlmExternalStory,\n  LlmIdBlock,\n  LlmProfilingMessage,\n  LlmSourcesMessage,\n  LlmSummaryCqsStory,\n  LlmSummarySource,\n  LlmTextContent,\n} from \"@rp/react/tanstack-api/llm-summary\"\nimport { DeepResearchChatInteraction } from \"../useAgent\"\nimport { CuratedSuggestedPrompt } from \"../useSuggestedPrompts/suggestedPrompts.types\"\n\ntype ChatFileContext = {\n  filesIds?: Array<string>\n  watchlistIds?: Array<string>\n}\n\ntype LlmTimings = {\n  start?: number\n  firstToken?: number\n  audit?: number\n  sources?: number\n  completed?: number\n  profiling?: LlmProfilingMessage\n}\n\ntype StaticSummary = {\n  summary: string\n  sources: Array<LlmSummarySource>\n}\n\ntype ResponseBlockList = Array<LlmIdBlock | LlmTextContent | EngineChartContent>\n\ntype SummaryState = {\n  interactionTimestamp?: string\n  response: string\n  responseBlock?: EngineChartContent\n  responseBlocks: ResponseBlockList\n  timings: LlmTimings\n  auditTraces: Array<StoredAuditTrace>\n  originSources: LlmSourcesMessage[\"originSources\"]\n  profiling?: LlmProfilingMessage\n  interactionType: ChatInteractionType\n  metadata?: LlmSourcesMessage[\"metadata\"]\n  statusData: {\n    step: \"initial\" | \"concluding\" | \"completed\"\n    message?: string | Array<string>\n    queries: Array<{ query: string; queryId: number }>\n  }\n  followUpQuestions?: LLMFollowUpMessage[\"followUp\"][\"queries\"]\n  auditBlocks: StoredResponseBlockList\n}\n\ntype SummaryStatus = \"IDLE\" | \"WAITING\" | \"NOT_READY\" | \"COMPLETED\" | \"STOPPED\" | \"ERROR\"\ntype LlmSummaryError = {\n  message: string\n  type: \"NONE\" | \"ERROR\" | \"WARNING\"\n}\ntype Interaction = {\n  index: number\n  status: {\n    error: boolean\n    stopped: boolean\n  }\n  user: {\n    prompt: string\n    retries?: number\n  }\n  server?: Pick<\n    SummaryState,\n    \"originSources\" | \"response\" | \"responseBlock\" | \"interactionTimestamp\"\n  > & {\n    auditTraces?: Array<LlmAuditTraceMessage[\"trace\"]>\n  }\n  timings: LlmTimings\n  scope?: DatasetScope\n  watchlistId?: string\n  files?: Array<ChatFile>\n}\n\ntype ChatFeedbackData = {\n  feedbackSentiment: number\n  interaction: UserInteraction | SeededInteraction | Interaction | DeepResearchChatInteraction\n  onSubmit: (props: { feedbackTags: Array<string>; feedbackComment: string }) => void\n}\n\ntype NativeChat = {\n  id: string\n  name: string\n  interactions?: Array<Interaction>\n}\n\ntype ChatContext = {\n  type: \"trending\" | \"feed\"\n  context: {\n    title: string\n    summary: string\n    originSources: Array<LlmDocumentSource | LlmExternalSource>\n  }\n}\n\ntype ChatWorkflowContext = {\n  type: \"worflow\"\n  workflow: WorkflowState\n}\n\ntype SourceImage = {\n  id: string\n  hd: string\n  imageUrls?: Array<string> | null\n  name: string\n}\n\ntype ChunkInfo = LlmSummaryCqsStory[\"chunks\"][number] & {\n  parent: LlmSummaryCqsStory\n  relatedSource: SourceImage\n}\ntype ChunkMap = { [chunkId: string]: ChunkInfo }\n\ntype ExternalMap = { [externalId: string]: LlmExternalStory }\ntype NativeDeviceAnalytics = {\n  device?: {\n    model: string | null\n    type: string | null\n    manufacturer: string | null\n    name: string | null\n    timezone: string\n    locale: string\n  }\n  app?: {\n    name?: string\n    build: string\n    namespace: string\n    version: string\n  }\n  network?: {\n    cellular: boolean\n    wifi: boolean\n    bluetooth: boolean\n  }\n  os?: {\n    name: string | null\n    version: string | null\n  }\n}\n\ntype LlmTracking = {\n  chatStartLocation:\n    | \"files\"\n    | \"watchlist\"\n    | \"suggestedPrompts\"\n    | \"trending\"\n    | \"feed\"\n    | \"entity\"\n    | \"brief\"\n    | null\n  status: \"edited\" | \"regenerated\" | null\n  promptTopics: Array<string> | null\n  promptTask: string | null\n  files: Array<{ fileId: string; ownerId: string; userIsOwner: boolean }>\n  watchlists: Array<{ watchlistId: string; ownerId: string; userIsOwner: boolean }>\n  followUpSuggestionIndex: number | null\n  platform: \"web\" | \"native\"\n  platformType: \"web\" | \"ios\" | \"android\" | \"windows\" | \"macos\" | null\n  promptContextLevel: \"watchlist\" | \"entity\" | null\n  promptCategory: string | null\n  promptCompanyType: string | null\n  dataViewAtClick: string | null\n  clickedSuggestedPromptText: string | null\n  suggestedPromptClassification: \"workflow\" | \"structuredData\" | \"standard\" | null\n} & NativeDeviceAnalytics\n\nconst isChatContext = (seed: unknown): seed is ChatContext => {\n  return (\n    typeof seed === \"object\" &&\n    seed !== null &&\n    \"type\" in seed &&\n    \"context\" in seed &&\n    typeof seed.context === \"object\" &&\n    seed.context !== null &&\n    \"summary\" in seed.context\n  )\n}\n\nconst isPromptLibraryContext = (\n  seed: unknown,\n): seed is { type: \"promptLibrary\"; value: CuratedSuggestedPrompt } => {\n  return (\n    typeof seed === \"object\" &&\n    seed !== null &&\n    \"type\" in seed &&\n    seed.type === \"promptLibrary\" &&\n    \"value\" in seed &&\n    seed.value !== null\n  )\n}\n\ntype HomeChatContext = {\n  prompt: string\n  scope?: DatasetScope\n  watchlistId: string | undefined\n  fileIds: Array<string>\n}\n\nconst isHomeChatContext = (seed: unknown): seed is { type: \"homeChat\"; value: HomeChatContext } => {\n  return (\n    typeof seed === \"object\" &&\n    seed !== null &&\n    \"type\" in seed &&\n    seed.type === \"homeChat\" &&\n    \"value\" in seed &&\n    seed.value !== null\n  )\n}\n\nconst isChatFileContext = (seed: unknown): seed is ChatFileContext => {\n  return (\n    typeof seed === \"object\" && seed !== null && \"filesIds\" in seed && Array.isArray(seed.filesIds)\n  )\n}\n\nconst isChatWatchlistContext = (seed: unknown): seed is ChatFileContext => {\n  return (\n    typeof seed === \"object\" &&\n    seed !== null &&\n    \"watchlistIds\" in seed &&\n    Array.isArray(seed.watchlistIds)\n  )\n}\nconst isChatWorkflowContext = (seed: unknown): seed is ChatWorkflowContext => {\n  return typeof seed === \"object\" && seed !== null && \"workflow\" in seed\n}\n\nexport {\n  isChatContext,\n  isChatFileContext,\n  isChatWatchlistContext,\n  isChatWorkflowContext,\n  isHomeChatContext,\n  isPromptLibraryContext,\n}\nexport type {\n  ChatContext,\n  ChatFeedbackData,\n  ChatFileContext,\n  ChatWorkflowContext,\n  ChunkInfo,\n  ChunkMap,\n  ExternalMap,\n  Interaction,\n  LlmSummaryError,\n  LlmTimings,\n  LlmTracking,\n  NativeChat,\n  NativeDeviceAnalytics,\n  ResponseBlockList,\n  StaticSummary,\n  SummaryState,\n  SummaryStatus,\n}\n"],"names":["isChatContext","isChatFileContext","isChatWatchlistContext","isChatWorkflowContext","isHomeChatContext","isPromptLibraryContext","seed","context","type","value","Array","isArray","filesIds","watchlistIds"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IAyPEA,aAAa;eAAbA;;IACAC,iBAAiB;eAAjBA;;IACAC,sBAAsB;eAAtBA;;IACAC,qBAAqB;eAArBA;;IACAC,iBAAiB;eAAjBA;;IACAC,sBAAsB;eAAtBA;;;AAnEF,MAAML,gBAAgB,CAACM;IACrB,OACE,OAAOA,SAAS,YAChBA,SAAS,QACT,UAAUA,QACV,aAAaA,QACb,OAAOA,KAAKC,OAAO,KAAK,YACxBD,KAAKC,OAAO,KAAK,QACjB,aAAaD,KAAKC,OAAO;AAE7B;AAEA,MAAMF,yBAAyB,CAC7BC;IAEA,OACE,OAAOA,SAAS,YAChBA,SAAS,QACT,UAAUA,QACVA,KAAKE,IAAI,KAAK,mBACd,WAAWF,QACXA,KAAKG,KAAK,KAAK;AAEnB;AASA,MAAML,oBAAoB,CAACE;IACzB,OACE,OAAOA,SAAS,YAChBA,SAAS,QACT,UAAUA,QACVA,KAAKE,IAAI,KAAK,cACd,WAAWF,QACXA,KAAKG,KAAK,KAAK;AAEnB;AAEA,MAAMR,oBAAoB,CAACK;IACzB,OACE,OAAOA,SAAS,YAAYA,SAAS,QAAQ,cAAcA,QAAQI,MAAMC,OAAO,CAACL,KAAKM,QAAQ;AAElG;AAEA,MAAMV,yBAAyB,CAACI;IAC9B,OACE,OAAOA,SAAS,YAChBA,SAAS,QACT,kBAAkBA,QAClBI,MAAMC,OAAO,CAACL,KAAKO,YAAY;AAEnC;AACA,MAAMV,wBAAwB,CAACG;IAC7B,OAAO,OAAOA,SAAS,YAAYA,SAAS,QAAQ,cAAcA;AACpE"}