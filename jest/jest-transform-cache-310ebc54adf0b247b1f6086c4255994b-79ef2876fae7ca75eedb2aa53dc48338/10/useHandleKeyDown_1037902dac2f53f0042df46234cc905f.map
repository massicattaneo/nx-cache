{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/search-autosuggest-input/src/lib/UnifiedSearch/useHandleKeyDown.ts"],"sourcesContent":["import { useCallback, useMemo, useState } from \"react\"\n\ntype Callbacks = {\n  autoSelectFirstOption?: boolean\n  onArrowDown: (id: string | null) => void\n  onArrowUp: (id: string | null) => void\n  onArrowLeft?: () => void\n  onArrowRight?: () => void\n  onEscape: () => void\n  onEnter: (selectedIndex: number | null) => void\n}\n\nconst getOptionIndex = <T extends { id: string }>(optionId: string, options: Array<T>) => {\n  return options.findIndex(({ id }) => id === optionId)\n}\n\nexport const useHandleKeyDown = <T extends { id: string }>(\n  options: Array<T>,\n  callbacks: Callbacks,\n) => {\n  const {\n    onArrowDown,\n    onArrowUp,\n    onArrowLeft,\n    onArrowRight,\n    onEnter,\n    onEscape,\n    autoSelectFirstOption,\n  } = callbacks\n  const [selectedOption, setSelectedOption] = useState<string | null>(null)\n\n  const selected = useMemo(() => {\n    if (selectedOption) return selectedOption\n    if (!autoSelectFirstOption) return null\n    if (options.length > 0) return options[0].id\n    return null\n  }, [autoSelectFirstOption, options, selectedOption])\n\n  const handleInputKeydown = useCallback(\n    (event: React.KeyboardEvent<HTMLInputElement>) => {\n      const selectedIndex = selected ? getOptionIndex(selected, options) : null\n\n      switch (event.key) {\n        case \"ArrowDown\":\n          event.preventDefault()\n          event.stopPropagation()\n          // eslint-disable-next-line no-case-declarations\n          const idDown =\n            selectedIndex !== null && selectedIndex !== options.length - 1\n              ? options[selectedIndex + 1].id\n              : options[0]?.id ?? null\n          setSelectedOption(idDown)\n          onArrowDown(idDown)\n          break\n        case \"ArrowUp\":\n          event.preventDefault()\n          event.stopPropagation()\n          // eslint-disable-next-line no-case-declarations\n          const idUp =\n            selectedIndex !== null && selectedIndex !== 0\n              ? options[selectedIndex - 1].id\n              : options[options.length - 1].id\n          setSelectedOption(idUp)\n          onArrowUp(idUp)\n          break\n        case \"ArrowLeft\":\n          onArrowLeft?.()\n          break\n        case \"ArrowRight\":\n          onArrowRight?.()\n          break\n        case \"Escape\":\n          event.preventDefault()\n          event.stopPropagation()\n          setSelectedOption(null)\n          onEscape()\n          break\n        case \"Enter\":\n          event.preventDefault()\n          event.stopPropagation()\n          setSelectedOption(null)\n          onEnter(selectedIndex)\n          break\n      }\n    },\n    [onArrowDown, onArrowUp, onArrowLeft, onArrowRight, onEnter, onEscape, options, selected],\n  )\n\n  return { handleInputKeydown, selectedOption: selected, setSelectedOption }\n}\n"],"names":["useHandleKeyDown","getOptionIndex","optionId","options","findIndex","id","callbacks","onArrowDown","onArrowUp","onArrowLeft","onArrowRight","onEnter","onEscape","autoSelectFirstOption","selectedOption","setSelectedOption","useState","selected","useMemo","length","handleInputKeydown","useCallback","event","selectedIndex","key","preventDefault","stopPropagation","idDown","idUp"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAgBaA;;;eAAAA;;;uBAhBkC;AAY/C,MAAMC,iBAAiB,CAA2BC,UAAkBC;IAClE,OAAOA,QAAQC,SAAS,CAAC,CAAC,EAAEC,EAAE,EAAE,GAAKA,OAAOH;AAC9C;AAEO,MAAMF,mBAAmB,CAC9BG,SACAG;IAEA,MAAM,EACJC,WAAW,EACXC,SAAS,EACTC,WAAW,EACXC,YAAY,EACZC,OAAO,EACPC,QAAQ,EACRC,qBAAqB,EACtB,GAAGP;IACJ,MAAM,CAACQ,gBAAgBC,kBAAkB,GAAGC,IAAAA,eAAQ,EAAgB;IAEpE,MAAMC,WAAWC,IAAAA,cAAO,EAAC;QACvB,IAAIJ,gBAAgB,OAAOA;QAC3B,IAAI,CAACD,uBAAuB,OAAO;QACnC,IAAIV,QAAQgB,MAAM,GAAG,GAAG,OAAOhB,OAAO,CAAC,EAAE,CAACE,EAAE;QAC5C,OAAO;IACT,GAAG;QAACQ;QAAuBV;QAASW;KAAe;IAEnD,MAAMM,qBAAqBC,IAAAA,kBAAW,EACpC,CAACC;QACC,MAAMC,gBAAgBN,WAAWhB,eAAegB,UAAUd,WAAW;QAErE,OAAQmB,MAAME,GAAG;YACf,KAAK;oBAOGrB;gBANNmB,MAAMG,cAAc;gBACpBH,MAAMI,eAAe;oBAKfvB;gBAJN,gDAAgD;gBAChD,MAAMwB,SACJJ,kBAAkB,QAAQA,kBAAkBpB,QAAQgB,MAAM,GAAG,IACzDhB,OAAO,CAACoB,gBAAgB,EAAE,CAAClB,EAAE,GAC7BF,CAAAA,gBAAAA,YAAAA,OAAO,CAAC,EAAE,cAAVA,gCAAAA,UAAYE,EAAE,cAAdF,0BAAAA,eAAkB;gBACxBY,kBAAkBY;gBAClBpB,YAAYoB;gBACZ;YACF,KAAK;gBACHL,MAAMG,cAAc;gBACpBH,MAAMI,eAAe;gBACrB,gDAAgD;gBAChD,MAAME,OACJL,kBAAkB,QAAQA,kBAAkB,IACxCpB,OAAO,CAACoB,gBAAgB,EAAE,CAAClB,EAAE,GAC7BF,OAAO,CAACA,QAAQgB,MAAM,GAAG,EAAE,CAACd,EAAE;gBACpCU,kBAAkBa;gBAClBpB,UAAUoB;gBACV;YACF,KAAK;gBACHnB,wBAAAA,kCAAAA;gBACA;YACF,KAAK;gBACHC,yBAAAA,mCAAAA;gBACA;YACF,KAAK;gBACHY,MAAMG,cAAc;gBACpBH,MAAMI,eAAe;gBACrBX,kBAAkB;gBAClBH;gBACA;YACF,KAAK;gBACHU,MAAMG,cAAc;gBACpBH,MAAMI,eAAe;gBACrBX,kBAAkB;gBAClBJ,QAAQY;gBACR;QACJ;IACF,GACA;QAAChB;QAAaC;QAAWC;QAAaC;QAAcC;QAASC;QAAUT;QAASc;KAAS;IAG3F,OAAO;QAAEG;QAAoBN,gBAAgBG;QAAUF;IAAkB;AAC3E"}