{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/tanstack-api/file/src/utils/handleDeleteFilesSuccess.ts"],"sourcesContent":["import { UserResource } from \"@clerk/types\"\nimport { adapters } from \"@rp/adapters\"\nimport { FileRowType } from \"@rp/common/utils\"\nimport { filesCustomerIo } from \"@rp/react/common/customer-io\"\nimport { QueryClient } from \"@tanstack/react-query\"\nimport { getMetadata } from \"../services\"\nimport { filesQueryKeys } from \"./filesQueryKeys\"\n\nconst updateFilesCustomerIo = (files: Array<FileRowType>, user: UserResource | null | undefined) =>\n  files.forEach(file => {\n    filesCustomerIo.filesApi.deleted({\n      fileId: file.id,\n      ownerId: file.owner,\n      updatedById: user?.id ?? \"\",\n      origin: adapters.platform.name,\n      timestamp: Date.now() * 1000,\n    })\n  })\n\nconst handleDeleteFilesSuccess = async (\n  fileIds: Array<string>,\n  user: UserResource | null | undefined,\n  queryClient: QueryClient,\n) => {\n  Promise.all(fileIds.map(id => getMetadata(id, queryClient))).then(files =>\n    updateFilesCustomerIo(files, user),\n  )\n  await queryClient.refetchQueries({ queryKey: filesQueryKeys.file, exact: true })\n  await queryClient.refetchQueries({ queryKey: filesQueryKeys.paginated() })\n}\n\nexport { handleDeleteFilesSuccess, updateFilesCustomerIo }\n"],"names":["handleDeleteFilesSuccess","updateFilesCustomerIo","files","user","forEach","file","filesCustomerIo","filesApi","deleted","fileId","id","ownerId","owner","updatedById","origin","adapters","platform","name","timestamp","Date","now","fileIds","queryClient","Promise","all","map","getMetadata","then","refetchQueries","queryKey","filesQueryKeys","exact","paginated"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IA+BSA,wBAAwB;eAAxBA;;IAA0BC,qBAAqB;eAArBA;;;0BA9BV;4BAEO;0BAEJ;gCACG;AAE/B,MAAMA,wBAAwB,CAACC,OAA2BC,OACxDD,MAAME,OAAO,CAACC,CAAAA;YAIGF;QAHfG,2BAAe,CAACC,QAAQ,CAACC,OAAO,CAAC;YAC/BC,QAAQJ,KAAKK,EAAE;YACfC,SAASN,KAAKO,KAAK;YACnBC,aAAaV,CAAAA,WAAAA,iBAAAA,2BAAAA,KAAMO,EAAE,cAARP,sBAAAA,WAAY;YACzBW,QAAQC,kBAAQ,CAACC,QAAQ,CAACC,IAAI;YAC9BC,WAAWC,KAAKC,GAAG,KAAK;QAC1B;IACF;AAEF,MAAMpB,2BAA2B,OAC/BqB,SACAlB,MACAmB;IAEAC,QAAQC,GAAG,CAACH,QAAQI,GAAG,CAACf,CAAAA,KAAMgB,IAAAA,qBAAW,EAAChB,IAAIY,eAAeK,IAAI,CAACzB,CAAAA,QAChED,sBAAsBC,OAAOC;IAE/B,MAAMmB,YAAYM,cAAc,CAAC;QAAEC,UAAUC,8BAAc,CAACzB,IAAI;QAAE0B,OAAO;IAAK;IAC9E,MAAMT,YAAYM,cAAc,CAAC;QAAEC,UAAUC,8BAAc,CAACE,SAAS;IAAG;AAC1E"}