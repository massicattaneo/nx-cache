{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/tanstack-api/watchlist/src/useWatchlistEntities.ts"],"sourcesContent":["import { useEffect, useMemo } from \"react\"\nimport { isDefined } from \"@rp/common/utils\"\nimport { useCqsByIdsContext } from \"@rp/react/tanstack-api/cqs-by-ids\"\nimport { useWatchlist } from \"./useWatchlist\"\n\nconst useWatchlistEntities = (id?: string) => {\n  const { data: watchlist, isLoading, isError } = useWatchlist(id)\n  const { ids, addByIds } = useCqsByIdsContext()\n\n  useEffect(() => {\n    if (isLoading || !watchlist) return\n    addByIds(\n      watchlist.items.map(key => ({ key, queryType: key.length === 6 ? \"entity\" : \"rp_topic\" })),\n    )\n  }, [addByIds, isLoading, watchlist])\n\n  const entities = useMemo(() => {\n    if (!watchlist?.items.length) return []\n    return watchlist.items.map(key => ids[key]?.data).filter(isDefined)\n  }, [ids, watchlist])\n\n  return {\n    isError,\n    isLoadingWatchlist: isLoading,\n    isLoadingEntities:\n      !!id &&\n      (isLoading ||\n        Object.values(ids)\n          .filter(item => watchlist?.items.includes(item.data.key))\n          .some(id => id.isLoading) ||\n        entities.length !== watchlist?.items.length),\n    watchlist,\n    entities,\n  }\n}\n\nexport { useWatchlistEntities }\n"],"names":["useWatchlistEntities","id","data","watchlist","isLoading","isError","useWatchlist","ids","addByIds","useCqsByIdsContext","useEffect","items","map","key","queryType","length","entities","useMemo","filter","isDefined","isLoadingWatchlist","isLoadingEntities","Object","values","item","includes","some"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAoCSA;;;eAAAA;;;uBApC0B;uBACT;0BACS;8BACN;AAE7B,MAAMA,uBAAuB,CAACC;IAC5B,MAAM,EAAEC,MAAMC,SAAS,EAAEC,SAAS,EAAEC,OAAO,EAAE,GAAGC,IAAAA,0BAAY,EAACL;IAC7D,MAAM,EAAEM,GAAG,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,4BAAkB;IAE5CC,IAAAA,gBAAS,EAAC;QACR,IAAIN,aAAa,CAACD,WAAW;QAC7BK,SACEL,UAAUQ,KAAK,CAACC,GAAG,CAACC,CAAAA,MAAQ,CAAA;gBAAEA;gBAAKC,WAAWD,IAAIE,MAAM,KAAK,IAAI,WAAW;YAAW,CAAA;IAE3F,GAAG;QAACP;QAAUJ;QAAWD;KAAU;IAEnC,MAAMa,WAAWC,IAAAA,cAAO,EAAC;QACvB,IAAI,EAACd,sBAAAA,gCAAAA,UAAWQ,KAAK,CAACI,MAAM,GAAE,OAAO,EAAE;QACvC,OAAOZ,UAAUQ,KAAK,CAACC,GAAG,CAACC,CAAAA;gBAAON;oBAAAA,WAAAA,GAAG,CAACM,IAAI,cAARN,+BAAAA,SAAUL,IAAI;WAAEgB,MAAM,CAACC,gBAAS;IACpE,GAAG;QAACZ;QAAKJ;KAAU;IAEnB,OAAO;QACLE;QACAe,oBAAoBhB;QACpBiB,mBACE,CAAC,CAACpB,MACDG,CAAAA,aACCkB,OAAOC,MAAM,CAAChB,KACXW,MAAM,CAACM,CAAAA,OAAQrB,sBAAAA,gCAAAA,UAAWQ,KAAK,CAACc,QAAQ,CAACD,KAAKtB,IAAI,CAACW,GAAG,GACtDa,IAAI,CAACzB,CAAAA,KAAMA,GAAGG,SAAS,KAC1BY,SAASD,MAAM,MAAKZ,sBAAAA,gCAAAA,UAAWQ,KAAK,CAACI,MAAM,CAAD;QAC9CZ;QACAa;IACF;AACF"}