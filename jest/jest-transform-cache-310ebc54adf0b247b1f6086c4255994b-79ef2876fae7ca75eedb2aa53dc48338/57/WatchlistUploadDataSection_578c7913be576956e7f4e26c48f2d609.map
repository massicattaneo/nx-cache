{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/watchlists/src/lib/WatchlistUploadModal/WatchlistUploadDataSection.tsx"],"sourcesContent":["import { Dispatch, SetStateAction, useCallback } from \"react\"\nimport { Watchlist } from \"@rp/common/api-types\"\nimport { useListSorter } from \"@rp/react/common/hooks\"\nimport { StickedChild, StickedWrapper } from \"@rp/react/web/common/base-components\"\nimport { HubSortableHeadCell, HubTableRow } from \"@rp/react/web/common/composite-components\"\nimport { Box, Typography } from \"@rp/react/web/mui/core\"\nimport { RowItem, WatchlistUploadColumns } from \"./WatchlistUploadColumns\"\nimport { extendItems } from \"./WatchlistUploadData\"\n\ntype Props = {\n  data: Array<RowItem[\"data\"]>\n  setData: Dispatch<SetStateAction<Array<RowItem[\"data\"]>>>\n  onSortChange: () => void\n  watchlist: Watchlist\n  labelClassName?: string\n  labels: [string, string]\n  excludeIds?: Array<string>\n}\n\nconst COLUMNS_WIDTH = WatchlistUploadColumns.map(col => col.width)\nconst SORT_OPTIONS = WatchlistUploadColumns.filter(col => col.sortable).map(col => ({\n  label: col.label,\n  value: col.value,\n}))\nexport const WatchlistUploadDataSection = ({\n  data,\n  setData,\n  onSortChange,\n  labels,\n  watchlist,\n  labelClassName,\n  excludeIds,\n}: Props) => {\n  const { sortBy, direction, onChange, sorterFn } = useListSorter({\n    direction: \"asc\",\n    sortBy: \"label\",\n    onChange: onSortChange,\n  })\n  const onEdit = useCallback(\n    (item: RowItem) => {\n      setData(prev =>\n        prev\n          .filter(data => data.id !== item.data.id)\n          .concat(\n            ...extendItems(\n              [\n                {\n                  ...item.data,\n                  isModified: true,\n                  isConflict: false,\n                },\n              ],\n              watchlist,\n            ),\n          ),\n      )\n    },\n    [setData, watchlist],\n  )\n\n  const onDelete = useCallback(\n    (item: RowItem) => {\n      setData(prev =>\n        prev\n          .filter(data => data.id !== item.data.id)\n          .concat(\n            ...extendItems(\n              [\n                {\n                  ...item.data,\n                  isDeleted: true,\n                },\n              ],\n              watchlist,\n            ),\n          ),\n      )\n    },\n    [setData, watchlist],\n  )\n\n  const already = data.filter(i => i.isInWatchlist && !i.isDeleted).length\n  const length = data.filter(data => !data.isDeleted).length\n  return (\n    <StickedWrapper>\n      <Box sx={{ display: \"flex\", gap: 1 }}>\n        <Typography className={labelClassName} sx={{ fontSize: 18, mb: 1 }}>\n          {length} {labels[length === 1 ? 0 : 1]}{\" \"}\n          {already > 0 && (\n            <Typography component=\"span\" sx={{ fontSize: 12, color: \"grey.300\" }}>\n              ({already} already in your Watchlist)\n            </Typography>\n          )}\n        </Typography>\n      </Box>\n      <StickedChild sx={{ top: 0, maxWidth: \"100%\" }}>\n        <HubTableRow\n          sx={{\n            backgroundColor: \"elevation.dp24\",\n            zIndex: 1,\n            gap: 1,\n            top: 0,\n          }}\n          columnsWidth={COLUMNS_WIDTH}\n          columns={WatchlistUploadColumns.map(col => ({\n            node: col.sortable ? (\n              <Box key={col.value} sx={{ \"& p\": { color: \"grey.300\", fontSize: \"12px\" } }}>\n                <HubSortableHeadCell\n                  label={col.label}\n                  value={col.value}\n                  onChange={onChange}\n                  sortBy={sortBy}\n                  direction={direction}\n                  sortOptions={SORT_OPTIONS}\n                />\n              </Box>\n            ) : (\n              <Typography key={col.value} sx={{ color: \"grey.300\", fontSize: \"12px\" }}>\n                {col.label || <>&nbsp;</>}\n              </Typography>\n            ),\n          }))}\n        />\n      </StickedChild>\n      {data\n        .filter(data => !data.isDeleted)\n        .sort((first, second) => {\n          return sorterFn(\n            { label: first.label, ...first.data },\n            { label: second.label, ...second.data },\n          )\n        })\n        .map(data => {\n          return (\n            <HubTableRow\n              key={data.id}\n              sx={{ gap: 1, py: 2, height: \"auto\" }}\n              columnsWidth={COLUMNS_WIDTH}\n              columns={WatchlistUploadColumns.map(column => ({\n                node: column.render({ data, column, onEdit, onDelete, excludeIds }),\n              }))}\n            />\n          )\n        })}\n    </StickedWrapper>\n  )\n}\n"],"names":["WatchlistUploadDataSection","COLUMNS_WIDTH","WatchlistUploadColumns","map","col","width","SORT_OPTIONS","filter","sortable","label","value","data","setData","onSortChange","labels","watchlist","labelClassName","excludeIds","sortBy","direction","onChange","sorterFn","useListSorter","onEdit","useCallback","item","prev","id","concat","extendItems","isModified","isConflict","onDelete","isDeleted","already","i","isInWatchlist","length","StickedWrapper","Box","sx","display","gap","Typography","className","fontSize","mb","component","color","StickedChild","top","maxWidth","HubTableRow","backgroundColor","zIndex","columnsWidth","columns","node","HubSortableHeadCell","sortOptions","sort","first","second","py","height","column","render"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}