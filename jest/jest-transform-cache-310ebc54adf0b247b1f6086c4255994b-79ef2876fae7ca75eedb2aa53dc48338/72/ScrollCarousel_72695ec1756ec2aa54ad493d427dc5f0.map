{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/composite-components/src/ScrollCarousel/ScrollCarousel.tsx"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { Box, SxProps } from \"@rp/react/web/mui/core\"\nimport { ScrollCarouselArrow } from \"./ScrollCarouselArrow\"\n\ntype Props = {\n  children: React.ReactNode | Array<React.ReactNode>\n  bgColor: string\n  onArrowMouseDown?: (event: React.MouseEvent) => void\n  sx?: SxProps\n}\n\nconst SAFE_AREA = 16\n\nconst ScrollCarousel = ({ children, bgColor, onArrowMouseDown, sx }: Props) => {\n  const { isMobile } = useDeviceInfo()\n  const [visibleArrows, setVisibleArrows] = useState({ left: false, right: false })\n  const container = useRef<HTMLDivElement>(null)\n\n  const showLeftArrow = visibleArrows.left\n  const showRightArrow = visibleArrows.right\n\n  const displayArrows = ({\n    amountScrolled,\n    scrollWidth,\n    elementWidth,\n  }: {\n    amountScrolled: number\n    scrollWidth: number\n    elementWidth: number\n  }) => {\n    const shouldShowLeft = amountScrolled >= SAFE_AREA\n    const shouldShowRight = amountScrolled <= scrollWidth - elementWidth - SAFE_AREA\n    setVisibleArrows({ left: shouldShowLeft, right: shouldShowRight })\n  }\n\n  const onArrowClick = (direction: \"left\" | \"right\") => {\n    if (!container.current) {\n      return\n    }\n\n    const constant = direction === \"left\" ? -0.9 : 0.9\n    container.current.scrollBy({\n      left: constant * container.current.offsetWidth,\n      behavior: \"smooth\",\n    })\n  }\n\n  const handleScroll = useCallback((event: React.UIEvent<HTMLDivElement>) => {\n    const amountScrolled = event.currentTarget.scrollLeft\n    const elementWidth = event.currentTarget.offsetWidth\n    const scrollWidth = event.currentTarget.scrollWidth\n\n    displayArrows({ amountScrolled, elementWidth, scrollWidth })\n  }, [])\n\n  useEffect(() => {\n    if (container.current !== null) {\n      displayArrows({\n        amountScrolled: container.current.scrollLeft,\n        elementWidth: container.current.offsetWidth,\n        scrollWidth: container.current.scrollWidth,\n      })\n    }\n  }, [isMobile, children])\n\n  const isDragging = useRef(false)\n  const lastDragPosition = useRef(0)\n\n  const handleMouseDown = (event: React.MouseEvent<HTMLDivElement>) => {\n    isDragging.current = true\n    lastDragPosition.current = event.clientX\n  }\n\n  const handleMouseMove = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (!isDragging.current) {\n      return\n    }\n\n    const scrollAmount = -1 * (event.clientX - lastDragPosition.current)\n    event.currentTarget.scrollBy({ left: scrollAmount })\n    lastDragPosition.current = event.clientX\n  }\n\n  const handleMouseUp = () => {\n    isDragging.current = false\n  }\n\n  return (\n    <Box sx={{ position: \"relative\", ...sx }}>\n      {showLeftArrow ? (\n        <ScrollCarouselArrow\n          direction=\"left\"\n          onClick={() => onArrowClick(\"left\")}\n          bgColor={bgColor}\n          onMouseDown={onArrowMouseDown}\n        />\n      ) : null}\n      <Box\n        sx={{\n          display: \"flex\",\n          overflowX: \"auto\",\n          alignItems: \"center\",\n          backgroundColor: \"transparent\",\n          \"&::-webkit-scrollbar\": {\n            height: 0,\n            display: \"none\",\n          },\n        }}\n        ref={container}\n        onScroll={handleScroll}\n        onMouseDown={isMobile ? undefined : handleMouseDown}\n        onMouseMove={isMobile ? undefined : handleMouseMove}\n        onMouseUp={isMobile ? undefined : handleMouseUp}\n        onMouseLeave={isMobile ? undefined : handleMouseUp}\n      >\n        {children}\n      </Box>\n      {showRightArrow ? (\n        <ScrollCarouselArrow\n          direction=\"right\"\n          bgColor={bgColor}\n          onClick={() => onArrowClick(\"right\")}\n          onMouseDown={onArrowMouseDown}\n        />\n      ) : null}\n    </Box>\n  )\n}\nexport { ScrollCarousel }\n"],"names":["ScrollCarousel","SAFE_AREA","children","bgColor","onArrowMouseDown","sx","isMobile","useDeviceInfo","visibleArrows","setVisibleArrows","useState","left","right","container","useRef","showLeftArrow","showRightArrow","displayArrows","amountScrolled","scrollWidth","elementWidth","shouldShowLeft","shouldShowRight","onArrowClick","direction","current","constant","scrollBy","offsetWidth","behavior","handleScroll","useCallback","event","currentTarget","scrollLeft","useEffect","isDragging","lastDragPosition","handleMouseDown","clientX","handleMouseMove","scrollAmount","handleMouseUp","Box","position","ScrollCarouselArrow","onClick","onMouseDown","display","overflowX","alignItems","backgroundColor","height","ref","onScroll","undefined","onMouseMove","onMouseUp","onMouseLeave"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}