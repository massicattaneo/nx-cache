{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/providers/src/useSlackConnectOnRedirect.ts"],"sourcesContent":["import { useEffect, useRef } from \"react\"\nimport { getSlackStatelessRedirectUri, useSlackConnect } from \"@rp/react/tanstack-api/notifications\"\nimport { useQueryParams, useReplaceSearchParam } from \"@rp/react/web/common/hooks\"\nimport { useSnackbar } from \"./Snackbar\"\n\nexport const useSlackConnectOnRedirect = () => {\n  const { enqueueError } = useSnackbar()\n  const replace = useReplaceSearchParam(\"slackTemporaryCode\")\n  const params = useQueryParams()\n  const temporaryCode = params.get(\"slackTemporaryCode\")\n  const { mutateAsync, isPending, isError } = useSlackConnect({ enqueueError })\n  const connecting = useRef(false)\n\n  useEffect(() => {\n    if (temporaryCode && !connecting.current) {\n      connecting.current = true\n      mutateAsync({\n        temporaryCode,\n        redirectUri: getSlackStatelessRedirectUri(),\n      }).finally(() => {\n        replace()\n        connecting.current = false\n      })\n    }\n  }, [temporaryCode, mutateAsync, replace, enqueueError])\n  return { isPending, isError }\n}\n"],"names":["useSlackConnectOnRedirect","enqueueError","useSnackbar","replace","useReplaceSearchParam","params","useQueryParams","temporaryCode","get","mutateAsync","isPending","isError","useSlackConnect","connecting","useRef","useEffect","current","redirectUri","getSlackStatelessRedirectUri","finally"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAKaA;;;eAAAA;;;uBALqB;+BAC4B;uBACR;0BAC1B;AAErB,MAAMA,4BAA4B;IACvC,MAAM,EAAEC,YAAY,EAAE,GAAGC,IAAAA,qBAAW;IACpC,MAAMC,UAAUC,IAAAA,4BAAqB,EAAC;IACtC,MAAMC,SAASC,IAAAA,qBAAc;IAC7B,MAAMC,gBAAgBF,OAAOG,GAAG,CAAC;IACjC,MAAM,EAAEC,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAE,GAAGC,IAAAA,8BAAe,EAAC;QAAEX;IAAa;IAC3E,MAAMY,aAAaC,IAAAA,aAAM,EAAC;IAE1BC,IAAAA,gBAAS,EAAC;QACR,IAAIR,iBAAiB,CAACM,WAAWG,OAAO,EAAE;YACxCH,WAAWG,OAAO,GAAG;YACrBP,YAAY;gBACVF;gBACAU,aAAaC,IAAAA,2CAA4B;YAC3C,GAAGC,OAAO,CAAC;gBACThB;gBACAU,WAAWG,OAAO,GAAG;YACvB;QACF;IACF,GAAG;QAACT;QAAeE;QAAaN;QAASF;KAAa;IACtD,OAAO;QAAES;QAAWC;IAAQ;AAC9B"}