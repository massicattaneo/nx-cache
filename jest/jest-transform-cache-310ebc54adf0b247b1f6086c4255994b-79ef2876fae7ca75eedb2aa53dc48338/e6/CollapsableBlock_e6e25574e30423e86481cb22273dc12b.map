{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/Chat/ChatResponse/ChatResponseBlocks/CollapsableBlock.tsx"],"sourcesContent":["import { useCallback, useState } from \"react\"\nimport ReactMarkdown from \"react-markdown\"\nimport { createChunkMap } from \"@rp/react/common/hooks\"\nimport { Box, CircularProgress, Typography } from \"@rp/react/web/mui/core\"\nimport { KeyboardArrowDown } from \"@rp/react/web/mui/icons\"\nimport { remarkGfmNoAutoLink } from \"@rp/web/utils\"\nimport { ChatResponseText } from \"../../Chat.styles\"\nimport { OnUserInteractionProps } from \"../ChatResponse\"\nimport { inlineAttributionRenderer } from \"../InlineAttribution/inlineAttributionRenderer\"\n\ntype ChunkMap = ReturnType<typeof createChunkMap>[\"chunkMap\"]\ntype ExternalMap = ReturnType<typeof createChunkMap>[\"externalMap\"]\n\ntype Props = {\n  title: string\n  contents: string\n  isReady: boolean\n  inlineAttributionProps: {\n    chunkMap: ChunkMap\n    externalMap: ExternalMap\n    onUserInteraction: (props: OnUserInteractionProps) => void\n  }\n}\n\nconst CollapsableBlock = ({ title, contents, isReady, inlineAttributionProps }: Props) => {\n  const [isOpen, setIsOpen] = useState(isReady)\n\n  const toggleDropdown = useCallback(() => {\n    setIsOpen(prev => !prev)\n  }, [])\n\n  return (\n    <Box>\n      <Box\n        sx={{\n          display: \"flex\",\n          width: 1,\n          justifyContent: isReady ? \"left\" : \"space-between\",\n          py: 1,\n          px: 0,\n          bgcolor: \"transparent\",\n          border: 0,\n          alignItems: \"center\",\n          cursor: \"pointer\",\n          gap: 1,\n          color: isReady ? \"text.primary\" : \"text.secondary\",\n\n          \"& svg\": {\n            color: \"text.secondary\",\n            opacity: isReady ? 0 : 1,\n            transition: \"opacity 0.2\",\n          },\n\n          \"&:hover svg\": {\n            opacity: 1,\n          },\n        }}\n        component=\"button\"\n        onClick={toggleDropdown}\n      >\n        <Typography sx={{ fontSize: 18, fontWeight: 700 }}>{title}</Typography>\n        {isReady ? (\n          <KeyboardArrowDown sx={{ transform: isOpen ? \"rotateZ(180deg)\" : undefined }} />\n        ) : (\n          <CircularProgress size={16} />\n        )}\n      </Box>\n\n      {isOpen ? (\n        <ChatResponseText>\n          <ReactMarkdown\n            remarkPlugins={[remarkGfmNoAutoLink]}\n            components={{\n              code: inlineAttributionRenderer({\n                chunkMap: inlineAttributionProps.chunkMap,\n                externalMap: inlineAttributionProps.externalMap,\n                disabled: !isReady,\n                onUserInteraction: inlineAttributionProps.onUserInteraction,\n              }),\n            }}\n          >\n            {contents}\n          </ReactMarkdown>\n        </ChatResponseText>\n      ) : null}\n    </Box>\n  )\n}\n\nexport { CollapsableBlock }\n"],"names":["CollapsableBlock","title","contents","isReady","inlineAttributionProps","isOpen","setIsOpen","useState","toggleDropdown","useCallback","prev","Box","sx","display","width","justifyContent","py","px","bgcolor","border","alignItems","cursor","gap","color","opacity","transition","component","onClick","Typography","fontSize","fontWeight","KeyboardArrowDown","transform","undefined","CircularProgress","size","ChatResponseText","ReactMarkdown","remarkPlugins","remarkGfmNoAutoLink","components","code","inlineAttributionRenderer","chunkMap","externalMap","disabled","onUserInteraction"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAyFSA;;;eAAAA;;;;uBAzF6B;sEACZ;sBAEwB;uBAChB;uBACE;4BACH;2CAES;;;;;;AAgB1C,MAAMA,mBAAmB,CAAC,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,sBAAsB,EAAS;IACnF,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAACJ;IAErC,MAAMK,iBAAiBC,IAAAA,kBAAW,EAAC;QACjCH,UAAUI,CAAAA,OAAQ,CAACA;IACrB,GAAG,EAAE;IAEL,qBACE,sBAACC,SAAG;;0BACF,sBAACA,SAAG;gBACFC,IAAI;oBACFC,SAAS;oBACTC,OAAO;oBACPC,gBAAgBZ,UAAU,SAAS;oBACnCa,IAAI;oBACJC,IAAI;oBACJC,SAAS;oBACTC,QAAQ;oBACRC,YAAY;oBACZC,QAAQ;oBACRC,KAAK;oBACLC,OAAOpB,UAAU,iBAAiB;oBAElC,SAAS;wBACPoB,OAAO;wBACPC,SAASrB,UAAU,IAAI;wBACvBsB,YAAY;oBACd;oBAEA,eAAe;wBACbD,SAAS;oBACX;gBACF;gBACAE,WAAU;gBACVC,SAASnB;;kCAET,qBAACoB,gBAAU;wBAAChB,IAAI;4BAAEiB,UAAU;4BAAIC,YAAY;wBAAI;kCAAI7B;;oBACnDE,wBACC,qBAAC4B,wBAAiB;wBAACnB,IAAI;4BAAEoB,WAAW3B,SAAS,oBAAoB4B;wBAAU;uCAE3E,qBAACC,sBAAgB;wBAACC,MAAM;;;;YAI3B9B,uBACC,qBAAC+B,4BAAgB;0BACf,cAAA,qBAACC,sBAAa;oBACZC,eAAe;wBAACC,0BAAmB;qBAAC;oBACpCC,YAAY;wBACVC,MAAMC,IAAAA,oDAAyB,EAAC;4BAC9BC,UAAUvC,uBAAuBuC,QAAQ;4BACzCC,aAAaxC,uBAAuBwC,WAAW;4BAC/CC,UAAU,CAAC1C;4BACX2C,mBAAmB1C,uBAAuB0C,iBAAiB;wBAC7D;oBACF;8BAEC5C;;iBAGH;;;AAGV"}