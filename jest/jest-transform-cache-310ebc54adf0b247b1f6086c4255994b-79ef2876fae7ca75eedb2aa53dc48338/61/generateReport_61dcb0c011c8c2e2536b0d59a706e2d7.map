{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/development/src/lib/database/generators/generateReport.ts"],"sourcesContent":["import { z } from \"zod\"\nimport { bigdataSchemas } from \"@rp/common/contracts\"\nimport { DbBrief, DbCqs, DbWatchlist } from \"../db.types\"\nimport { generateDate } from \"./generateDate\"\nimport { generateId } from \"./generateId\"\n\ntype Ret = z.infer<typeof bigdataSchemas.st_briefs_LatestBriefReportResponse_Input>\ntype Params = {\n  watchlist: DbWatchlist\n  brief: DbBrief\n  entities: Array<DbCqs>\n}\n\nexport const generateReport = (params: Params): Ret => {\n  const entityReports = params.entities.map(entityInfo => {\n    return {\n      entityId: entityInfo.key,\n      entityInfo: {\n        ...entityInfo,\n        description: entityInfo.description ?? \"\",\n        country: entityInfo.country ?? \"\",\n      },\n      cleanFinalReport: `* ${entityInfo.name} report`,\n    }\n  })\n  return {\n    report: {\n      watchlistId: params.watchlist.id,\n      watchlistName: params.watchlist.name,\n      reportTitle: `Report for ${params.watchlist.name}`,\n      reportDate: generateDate(),\n      introduction: \"Introduction to the report\",\n      entityReports,\n      reportId: generateId(),\n      briefId: params.brief.id,\n      isEmpty: false,\n    },\n    nextReportDate: generateDate(new Date(Date.now() + 24 * 60 * 60 * 1000)),\n  }\n}\n"],"names":["generateReport","params","entityReports","entities","map","entityInfo","entityId","key","description","country","cleanFinalReport","name","report","watchlistId","watchlist","id","watchlistName","reportTitle","reportDate","generateDate","introduction","reportId","generateId","briefId","brief","isEmpty","nextReportDate","Date","now"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAaaA;;;eAAAA;;;8BAVgB;4BACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASpB,MAAMA,iBAAiB,CAACC;IAC7B,MAAMC,gBAAgBD,OAAOE,QAAQ,CAACC,GAAG,CAACC,CAAAA;YAKvBA,yBACJA;QALb,OAAO;YACLC,UAAUD,WAAWE,GAAG;YACxBF,YAAY,wCACPA;gBACHG,aAAaH,CAAAA,0BAAAA,WAAWG,WAAW,cAAtBH,qCAAAA,0BAA0B;gBACvCI,SAASJ,CAAAA,sBAAAA,WAAWI,OAAO,cAAlBJ,iCAAAA,sBAAsB;;YAEjCK,kBAAkB,CAAC,EAAE,EAAEL,WAAWM,IAAI,CAAC,OAAO,CAAC;QACjD;IACF;IACA,OAAO;QACLC,QAAQ;YACNC,aAAaZ,OAAOa,SAAS,CAACC,EAAE;YAChCC,eAAef,OAAOa,SAAS,CAACH,IAAI;YACpCM,aAAa,CAAC,WAAW,EAAEhB,OAAOa,SAAS,CAACH,IAAI,CAAC,CAAC;YAClDO,YAAYC,IAAAA,0BAAY;YACxBC,cAAc;YACdlB;YACAmB,UAAUC,IAAAA,sBAAU;YACpBC,SAAStB,OAAOuB,KAAK,CAACT,EAAE;YACxBU,SAAS;QACX;QACAC,gBAAgBP,IAAAA,0BAAY,EAAC,IAAIQ,KAAKA,KAAKC,GAAG,KAAK,KAAK,KAAK,KAAK;IACpE;AACF"}