{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/node_modules/mdast-util-to-markdown/lib/handle/image-reference.js"],"sourcesContent":["/**\n * @typedef {import('mdast').ImageReference} ImageReference\n * @typedef {import('mdast').Parents} Parents\n * @typedef {import('../types.js').Info} Info\n * @typedef {import('../types.js').State} State\n */\n\nimageReference.peek = imageReferencePeek\n\n/**\n * @param {ImageReference} node\n * @param {Parents | undefined} _\n * @param {State} state\n * @param {Info} info\n * @returns {string}\n */\nexport function imageReference(node, _, state, info) {\n  const type = node.referenceType\n  const exit = state.enter('imageReference')\n  let subexit = state.enter('label')\n  const tracker = state.createTracker(info)\n  let value = tracker.move('![')\n  const alt = state.safe(node.alt, {\n    before: value,\n    after: ']',\n    ...tracker.current()\n  })\n  value += tracker.move(alt + '][')\n\n  subexit()\n  // Hide the fact that we’re in phrasing, because escapes don’t work.\n  const stack = state.stack\n  state.stack = []\n  subexit = state.enter('reference')\n  // Note: for proper tracking, we should reset the output positions when we end\n  // up making a `shortcut` reference, because then there is no brace output.\n  // Practically, in that case, there is no content, so it doesn’t matter that\n  // we’ve tracked one too many characters.\n  const reference = state.safe(state.associationId(node), {\n    before: value,\n    after: ']',\n    ...tracker.current()\n  })\n  subexit()\n  state.stack = stack\n  exit()\n\n  if (type === 'full' || !alt || alt !== reference) {\n    value += tracker.move(reference + ']')\n  } else if (type === 'shortcut') {\n    // Remove the unwanted `[`.\n    value = value.slice(0, -1)\n  } else {\n    value += tracker.move(']')\n  }\n\n  return value\n}\n\n/**\n * @returns {string}\n */\nfunction imageReferencePeek() {\n  return '!'\n}\n"],"names":["imageReference","peek","imageReferencePeek","node","_","state","info","type","referenceType","exit","enter","subexit","tracker","createTracker","value","move","alt","safe","before","after","current","stack","reference","associationId","slice"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA;;;;;CAKC;;;;+BAWeA;;;eAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAThBA,eAAeC,IAAI,GAAGC;AASf,SAASF,eAAeG,IAAI,EAAEC,CAAC,EAAEC,KAAK,EAAEC,IAAI;IACjD,MAAMC,OAAOJ,KAAKK,aAAa;IAC/B,MAAMC,OAAOJ,MAAMK,KAAK,CAAC;IACzB,IAAIC,UAAUN,MAAMK,KAAK,CAAC;IAC1B,MAAME,UAAUP,MAAMQ,aAAa,CAACP;IACpC,IAAIQ,QAAQF,QAAQG,IAAI,CAAC;IACzB,MAAMC,MAAMX,MAAMY,IAAI,CAACd,KAAKa,GAAG,EAAE;QAC/BE,QAAQJ;QACRK,OAAO;OACJP,QAAQQ,OAAO;IAEpBN,SAASF,QAAQG,IAAI,CAACC,MAAM;IAE5BL;IACA,oEAAoE;IACpE,MAAMU,QAAQhB,MAAMgB,KAAK;IACzBhB,MAAMgB,KAAK,GAAG,EAAE;IAChBV,UAAUN,MAAMK,KAAK,CAAC;IACtB,8EAA8E;IAC9E,2EAA2E;IAC3E,4EAA4E;IAC5E,yCAAyC;IACzC,MAAMY,YAAYjB,MAAMY,IAAI,CAACZ,MAAMkB,aAAa,CAACpB,OAAO;QACtDe,QAAQJ;QACRK,OAAO;OACJP,QAAQQ,OAAO;IAEpBT;IACAN,MAAMgB,KAAK,GAAGA;IACdZ;IAEA,IAAIF,SAAS,UAAU,CAACS,OAAOA,QAAQM,WAAW;QAChDR,SAASF,QAAQG,IAAI,CAACO,YAAY;IACpC,OAAO,IAAIf,SAAS,YAAY;QAC9B,2BAA2B;QAC3BO,QAAQA,MAAMU,KAAK,CAAC,GAAG,CAAC;IAC1B,OAAO;QACLV,SAASF,QAAQG,IAAI,CAAC;IACxB;IAEA,OAAOD;AACT;AAEA;;CAEC,GACD,SAASZ;IACP,OAAO;AACT"}