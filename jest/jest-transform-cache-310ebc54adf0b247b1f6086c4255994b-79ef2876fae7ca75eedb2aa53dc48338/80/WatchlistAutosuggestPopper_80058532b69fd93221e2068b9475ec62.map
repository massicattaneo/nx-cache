{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/search-autosuggest-input/src/lib/UnifiedSearch/WatchlistAutosuggestPopper.tsx"],"sourcesContent":["import { PropsWithChildren, ReactElement } from \"react\"\nimport { groupCompanySuggestions } from \"@rp/react/tanstack-api/suggestion\"\nimport { AutoAnimateHeight } from \"@rp/react/web/common/composite-components\"\nimport { useDeviceInfo, useDeviceSize } from \"@rp/react/web/common/hooks\"\nimport { Box, CircularProgress, ClickAwayListener, Typography } from \"@rp/react/web/mui/core\"\nimport { DropdownPaper, RecentSearchTitle, StyledPopper } from \"./AutoCompleteCustoms\"\n\ntype Props = PropsWithChildren<{\n  open: boolean\n  options: ReturnType<typeof groupCompanySuggestions>\n  inputRef: HTMLElement | null\n  dropdownTitle?: string\n  backgroundColor?: string\n  renderOption: (\n    option: ReturnType<typeof groupCompanySuggestions>[0],\n    index: number,\n  ) => ReactElement | null\n  onClickAway: () => void\n  isLoading?: boolean\n  maxPopperHeight?: number\n}>\nconst MARGIN_BOTTOM = 24\n\nconst calculateMaxHeight = (input: HTMLElement) => {\n  const { bottom } = input.getBoundingClientRect()\n\n  return window.innerHeight - bottom - MARGIN_BOTTOM\n}\n\nexport const WatchlistAutosuggestPopper = ({\n  open,\n  options,\n  dropdownTitle,\n  inputRef,\n  renderOption,\n  onClickAway,\n  backgroundColor,\n  isLoading,\n  children,\n  maxPopperHeight = 1500,\n}: Props) => {\n  const { height } = useDeviceSize()\n  const { isMobile } = useDeviceInfo()\n\n  const maxHeight = isMobile\n    ? Math.min(400, height * 0.6)\n    : inputRef === null\n    ? undefined\n    : Math.min(maxPopperHeight, calculateMaxHeight(inputRef))\n\n  return (\n    <ClickAwayListener onClickAway={onClickAway}>\n      <StyledPopper\n        open={open}\n        deviceHeight={height}\n        anchorEl={inputRef}\n        style={{\n          width: inputRef?.clientWidth,\n          ...(isMobile && {\n            position: \"fixed\",\n            left: 0,\n            right: 0,\n            bottom: 0,\n          }),\n        }}\n        modifiers={[\n          {\n            name: \"computeStyles\",\n            options: {\n              roundOffsets: false,\n            },\n          },\n        ]}\n      >\n        <DropdownPaper\n          role={\"dropdown-suggestions\"}\n          sx={{\n            mt: 0.5,\n            backgroundColor,\n            border: \"none\",\n            borderRadius: \"8px\",\n          }}\n        >\n          {children}\n          {dropdownTitle ? <RecentSearchTitle>{dropdownTitle}</RecentSearchTitle> : null}\n          <Box\n            sx={theme => ({\n              maxHeight,\n              height: \"auto\",\n              overflowY: \"auto\",\n              position: \"relative\",\n              ...theme.scrollbarStyles,\n            })}\n          >\n            <AutoAnimateHeight>\n              <ul\n                className=\"MuiAutocomplete-listbox\"\n                style={{\n                  maxHeight: isMobile ? \"100%\" : undefined,\n                  overflowY: \"auto\",\n                }}\n              >\n                {options.length === 0 && !isLoading && (\n                  <Typography\n                    sx={{\n                      fontSize: 14,\n                      px: 1,\n                      py: 2,\n                      textAlign: \"center\",\n                      color: \"text.secondary\",\n                    }}\n                  >\n                    We couldn't find any results matching your search\n                  </Typography>\n                )}\n                {isLoading && (\n                  <Box sx={{ display: \"flex\", justifyContent: \"center\", p: 2 }}>\n                    <CircularProgress size={24} />\n                  </Box>\n                )}\n                {options.map(renderOption)}\n              </ul>\n            </AutoAnimateHeight>\n          </Box>\n        </DropdownPaper>\n      </StyledPopper>\n    </ClickAwayListener>\n  )\n}\n"],"names":["WatchlistAutosuggestPopper","MARGIN_BOTTOM","calculateMaxHeight","input","bottom","getBoundingClientRect","window","innerHeight","open","options","dropdownTitle","inputRef","renderOption","onClickAway","backgroundColor","isLoading","children","maxPopperHeight","height","useDeviceSize","isMobile","useDeviceInfo","maxHeight","Math","min","undefined","ClickAwayListener","StyledPopper","deviceHeight","anchorEl","style","width","clientWidth","position","left","right","modifiers","name","roundOffsets","DropdownPaper","role","sx","mt","border","borderRadius","RecentSearchTitle","Box","theme","overflowY","scrollbarStyles","AutoAnimateHeight","ul","className","length","Typography","fontSize","px","py","textAlign","color","display","justifyContent","p","CircularProgress","size","map"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BA6BaA;;;eAAAA;;;;qCA3BqB;uBACW;sBACwB;qCACN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgB/D,MAAMC,gBAAgB;AAEtB,MAAMC,qBAAqB,CAACC;IAC1B,MAAM,EAAEC,MAAM,EAAE,GAAGD,MAAME,qBAAqB;IAE9C,OAAOC,OAAOC,WAAW,GAAGH,SAASH;AACvC;AAEO,MAAMD,6BAA6B,CAAC,EACzCQ,IAAI,EACJC,OAAO,EACPC,aAAa,EACbC,QAAQ,EACRC,YAAY,EACZC,WAAW,EACXC,eAAe,EACfC,SAAS,EACTC,QAAQ,EACRC,kBAAkB,IAAI,EAChB;IACN,MAAM,EAAEC,MAAM,EAAE,GAAGC,IAAAA,oBAAa;IAChC,MAAM,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,oBAAa;IAElC,MAAMC,YAAYF,WACdG,KAAKC,GAAG,CAAC,KAAKN,SAAS,OACvBP,aAAa,OACbc,YACAF,KAAKC,GAAG,CAACP,iBAAiBf,mBAAmBS;IAEjD,qBACE,qBAACe,uBAAiB;QAACb,aAAaA;kBAC9B,cAAA,qBAACc,iCAAY;YACXnB,MAAMA;YACNoB,cAAcV;YACdW,UAAUlB;YACVmB,OAAO;gBACLC,KAAK,EAAEpB,qBAAAA,+BAAAA,SAAUqB,WAAW;eACxBZ,YAAY;gBACda,UAAU;gBACVC,MAAM;gBACNC,OAAO;gBACP/B,QAAQ;YACV;YAEFgC,WAAW;gBACT;oBACEC,MAAM;oBACN5B,SAAS;wBACP6B,cAAc;oBAChB;gBACF;aACD;sBAED,cAAA,sBAACC,kCAAa;gBACZC,MAAM;gBACNC,IAAI;oBACFC,IAAI;oBACJ5B;oBACA6B,QAAQ;oBACRC,cAAc;gBAChB;;oBAEC5B;oBACAN,8BAAgB,qBAACmC,sCAAiB;kCAAEnC;yBAAqC;kCAC1E,qBAACoC,SAAG;wBACFL,IAAIM,CAAAA,QAAU;gCACZzB;gCACAJ,QAAQ;gCACR8B,WAAW;gCACXf,UAAU;+BACPc,MAAME,eAAe;kCAG1B,cAAA,qBAACC,sCAAiB;sCAChB,cAAA,sBAACC;gCACCC,WAAU;gCACVtB,OAAO;oCACLR,WAAWF,WAAW,SAASK;oCAC/BuB,WAAW;gCACb;;oCAECvC,QAAQ4C,MAAM,KAAK,KAAK,CAACtC,2BACxB,qBAACuC,gBAAU;wCACTb,IAAI;4CACFc,UAAU;4CACVC,IAAI;4CACJC,IAAI;4CACJC,WAAW;4CACXC,OAAO;wCACT;kDACD;;oCAIF5C,2BACC,qBAAC+B,SAAG;wCAACL,IAAI;4CAAEmB,SAAS;4CAAQC,gBAAgB;4CAAUC,GAAG;wCAAE;kDACzD,cAAA,qBAACC,sBAAgB;4CAACC,MAAM;;;oCAG3BvD,QAAQwD,GAAG,CAACrD;;;;;;;;;AAQ7B"}