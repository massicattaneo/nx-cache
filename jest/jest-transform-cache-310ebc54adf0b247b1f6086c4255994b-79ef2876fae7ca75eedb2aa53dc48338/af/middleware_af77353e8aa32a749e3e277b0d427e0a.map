{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/node_modules/@trpc/server/dist/unstable-core-do-not-import/middleware.js"],"sourcesContent":["'use strict';\n\nvar TRPCError = require('./error/TRPCError.js');\nvar utils = require('./utils.js');\n\n/** @internal */ const middlewareMarker = 'middlewareMarker';\n/**\n * @internal\n */ function createMiddlewareFactory() {\n    function createMiddlewareInner(middlewares) {\n        return {\n            _middlewares: middlewares,\n            unstable_pipe (middlewareBuilderOrFn) {\n                const pipedMiddleware = '_middlewares' in middlewareBuilderOrFn ? middlewareBuilderOrFn._middlewares : [\n                    middlewareBuilderOrFn\n                ];\n                return createMiddlewareInner([\n                    ...middlewares,\n                    ...pipedMiddleware\n                ]);\n            }\n        };\n    }\n    function createMiddleware(fn) {\n        return createMiddlewareInner([\n            fn\n        ]);\n    }\n    return createMiddleware;\n}\n/**\n * Create a standalone middleware\n * @link https://trpc.io/docs/v11/server/middlewares#experimental-standalone-middlewares\n * @deprecated use `.unstable_concat()` instead\n */ const experimental_standaloneMiddleware = ()=>({\n        create: createMiddlewareFactory()\n    });\n/**\n * @internal\n * Please note, `trpc-openapi` uses this function.\n */ function createInputMiddleware(parse) {\n    const inputMiddleware = async function inputValidatorMiddleware(opts) {\n        let parsedInput;\n        const rawInput = await opts.getRawInput();\n        try {\n            parsedInput = await parse(rawInput);\n        } catch (cause) {\n            throw new TRPCError.TRPCError({\n                code: 'BAD_REQUEST',\n                cause\n            });\n        }\n        // Multiple input parsers\n        const combinedInput = utils.isObject(opts.input) && utils.isObject(parsedInput) ? {\n            ...opts.input,\n            ...parsedInput\n        } : parsedInput;\n        return opts.next({\n            input: combinedInput\n        });\n    };\n    inputMiddleware._type = 'input';\n    return inputMiddleware;\n}\n/**\n * @internal\n */ function createOutputMiddleware(parse) {\n    const outputMiddleware = async function outputValidatorMiddleware({ next  }) {\n        const result = await next();\n        if (!result.ok) {\n            // pass through failures without validating\n            return result;\n        }\n        try {\n            const data = await parse(result.data);\n            return {\n                ...result,\n                data\n            };\n        } catch (cause) {\n            throw new TRPCError.TRPCError({\n                message: 'Output validation failed',\n                code: 'INTERNAL_SERVER_ERROR',\n                cause\n            });\n        }\n    };\n    outputMiddleware._type = 'output';\n    return outputMiddleware;\n}\n\nexports.createInputMiddleware = createInputMiddleware;\nexports.createMiddlewareFactory = createMiddlewareFactory;\nexports.createOutputMiddleware = createOutputMiddleware;\nexports.experimental_standaloneMiddleware = experimental_standaloneMiddleware;\nexports.middlewareMarker = middlewareMarker;\n"],"names":["TRPCError","require","utils","middlewareMarker","createMiddlewareFactory","createMiddlewareInner","middlewares","_middlewares","unstable_pipe","middlewareBuilderOrFn","pipedMiddleware","createMiddleware","fn","experimental_standaloneMiddleware","create","createInputMiddleware","parse","inputMiddleware","inputValidatorMiddleware","opts","parsedInput","rawInput","getRawInput","cause","code","combinedInput","isObject","input","next","_type","createOutputMiddleware","outputMiddleware","outputValidatorMiddleware","result","ok","data","message","exports"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAIA,YAAYC,QAAQ;AACxB,IAAIC,QAAQD,QAAQ;AAEpB,cAAc,GAAG,MAAME,mBAAmB;AAC1C;;CAEC,GAAG,SAASC;IACT,SAASC,sBAAsBC,WAAW;QACtC,OAAO;YACHC,cAAcD;YACdE,eAAeC,qBAAqB;gBAChC,MAAMC,kBAAkB,kBAAkBD,wBAAwBA,sBAAsBF,YAAY,GAAG;oBACnGE;iBACH;gBACD,OAAOJ,sBAAsB;uBACtBC;uBACAI;iBACN;YACL;QACJ;IACJ;IACA,SAASC,iBAAiBC,EAAE;QACxB,OAAOP,sBAAsB;YACzBO;SACH;IACL;IACA,OAAOD;AACX;AACA;;;;CAIC,GAAG,MAAME,oCAAoC,IAAK,CAAA;QAC3CC,QAAQV;IACZ,CAAA;AACJ;;;CAGC,GAAG,SAASW,sBAAsBC,KAAK;IACpC,MAAMC,kBAAkB,eAAeC,yBAAyBC,IAAI;QAChE,IAAIC;QACJ,MAAMC,WAAW,MAAMF,KAAKG,WAAW;QACvC,IAAI;YACAF,cAAc,MAAMJ,MAAMK;QAC9B,EAAE,OAAOE,OAAO;YACZ,MAAM,IAAIvB,UAAUA,SAAS,CAAC;gBAC1BwB,MAAM;gBACND;YACJ;QACJ;QACA,yBAAyB;QACzB,MAAME,gBAAgBvB,MAAMwB,QAAQ,CAACP,KAAKQ,KAAK,KAAKzB,MAAMwB,QAAQ,CAACN,eAAe,mBAC3ED,KAAKQ,KAAK,EACVP,eACHA;QACJ,OAAOD,KAAKS,IAAI,CAAC;YACbD,OAAOF;QACX;IACJ;IACAR,gBAAgBY,KAAK,GAAG;IACxB,OAAOZ;AACX;AACA;;CAEC,GAAG,SAASa,uBAAuBd,KAAK;IACrC,MAAMe,mBAAmB,eAAeC,0BAA0B,EAAEJ,IAAI,EAAG;QACvE,MAAMK,SAAS,MAAML;QACrB,IAAI,CAACK,OAAOC,EAAE,EAAE;YACZ,2CAA2C;YAC3C,OAAOD;QACX;QACA,IAAI;YACA,MAAME,OAAO,MAAMnB,MAAMiB,OAAOE,IAAI;YACpC,OAAO,wCACAF;gBACHE;;QAER,EAAE,OAAOZ,OAAO;YACZ,MAAM,IAAIvB,UAAUA,SAAS,CAAC;gBAC1BoC,SAAS;gBACTZ,MAAM;gBACND;YACJ;QACJ;IACJ;IACAQ,iBAAiBF,KAAK,GAAG;IACzB,OAAOE;AACX;AAEAM,QAAQtB,qBAAqB,GAAGA;AAChCsB,QAAQjC,uBAAuB,GAAGA;AAClCiC,QAAQP,sBAAsB,GAAGA;AACjCO,QAAQxB,iCAAiC,GAAGA;AAC5CwB,QAAQlC,gBAAgB,GAAGA"}