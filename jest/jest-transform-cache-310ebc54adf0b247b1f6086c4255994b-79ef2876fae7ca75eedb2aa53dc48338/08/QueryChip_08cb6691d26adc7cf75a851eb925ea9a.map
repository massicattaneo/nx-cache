{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/Chat/ChatResponse/RealTimeAudit/QueryChip.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { CqsChunkStory } from \"@rp/common/api-types\"\nimport { StoredAuditTrace } from \"@rp/react/tanstack-api/chat\"\nimport { LlmExternalStory, LlmSummaryCqsStory } from \"@rp/react/tanstack-api/llm-summary\"\nimport { ShowMoreList } from \"@rp/react/web/common/composite-components\"\nimport { Box, Typography } from \"@rp/react/web/mui/core\"\nimport { ArrowDropDown, Search } from \"@rp/react/web/mui/icons\"\nimport { ExternalAuditCard } from \"../ExternalAuditCard\"\n\nconst ACCEPTED_TYPES = [\"CQS\", \"EXTERNAL\"]\n\ntype renderCqsCard = (story: CqsChunkStory, index: number) => React.ReactElement\n\nconst isExternalStory = (\n  story: LlmSummaryCqsStory | LlmExternalStory,\n): story is LlmExternalStory => {\n  return \"action\" in story && story.action.type === \"EXTERNAL\"\n}\n\nconst renderAuditCard = (\n  item: LlmSummaryCqsStory | LlmExternalStory,\n  index: number,\n  renderCqsCard: renderCqsCard,\n) => {\n  return isExternalStory(item) ? (\n    <ExternalAuditCard\n      key={item.action.url}\n      title={item.hd}\n      faviconUrl={item.action.faviconUrl}\n      name={item.action.name}\n      url={item.action.url}\n      body={item.text}\n    />\n  ) : (\n    renderCqsCard(item, index)\n  )\n}\n\ntype Props = {\n  query: string\n  trace?: StoredAuditTrace[\"results\"]\n  renderCard: renderCqsCard\n}\nconst QueryChip = ({ query, trace, renderCard }: Props) => {\n  const [isOpen, setIsOpen] = useState(false)\n  const acceptedResults =\n    trace\n      ?.filter(group => ACCEPTED_TYPES.includes(group.type))\n      .map(group => group.values)\n      .flat() ?? []\n\n  const shouldDisplayDropdown = trace\n    ? trace.filter(group => ACCEPTED_TYPES.includes(group.type)).length > 0\n    : false\n  return (\n    <Box sx={{ maxWidth: \"100%\", width: isOpen ? 1 : undefined }}>\n      <Box\n        key={query}\n        sx={{\n          p: 1,\n          borderRadius: 1,\n          bgcolor: isOpen ? \"elevation.dp06\" : \"overlay.surface\",\n          fontSize: 16,\n          display: \"flex\",\n          gap: 0.5,\n          cursor: \"pointer\",\n          outline: \"1px solid\",\n          outlineColor: isOpen ? \"outline.border\" : \"transparent\",\n          width: \"fit-content\",\n\n          \"&:hover\": {\n            bgcolor: \"elevation.dp06\",\n            outlineColor: \"outline.border\",\n          },\n        }}\n        onClick={() => (shouldDisplayDropdown ? setIsOpen(prev => !prev) : undefined)}\n      >\n        <Search />\n        {query}\n        {shouldDisplayDropdown ? (\n          <ArrowDropDown\n            sx={{\n              transform: isOpen ? \"rotateZ(180deg)\" : undefined,\n            }}\n          />\n        ) : null}\n      </Box>\n      {isOpen ? (\n        <Box\n          sx={{\n            overflow: \"hidden\",\n            \"& .StoryCard-storyCardRoot\": {\n              backgroundColor: \"elevation.dp01\",\n            },\n\n            \"& .StoryCard-storyCardRoot:hover\": {\n              backgroundColor: \"overlay.surface\",\n            },\n          }}\n        >\n          <Typography\n            sx={{\n              fontSize: 14,\n              color: \"text.secondary\",\n              letterSpacing: 1,\n              pt: 2,\n              pb: 2,\n            }}\n          >\n            {acceptedResults.length} matching{\" \"}\n            {acceptedResults.length === 1 ? \"document\" : \"documents\"}\n          </Typography>\n          <ShowMoreList\n            items={acceptedResults}\n            renderItem={(item, index) => renderAuditCard(item, index, renderCard)}\n            paginate={3}\n            showMoreLabel={{ more: \"Show more\", less: \"Show less\" }}\n          />\n        </Box>\n      ) : null}\n    </Box>\n  )\n}\nexport { QueryChip, isExternalStory }\n"],"names":["QueryChip","isExternalStory","ACCEPTED_TYPES","story","action","type","renderAuditCard","item","index","renderCqsCard","ExternalAuditCard","title","hd","faviconUrl","name","url","body","text","query","trace","renderCard","isOpen","setIsOpen","useState","acceptedResults","filter","group","includes","map","values","flat","shouldDisplayDropdown","length","Box","sx","maxWidth","width","undefined","p","borderRadius","bgcolor","fontSize","display","gap","cursor","outline","outlineColor","onClick","prev","Search","ArrowDropDown","transform","overflow","backgroundColor","Typography","color","letterSpacing","pt","pb","ShowMoreList","items","renderItem","paginate","showMoreLabel","more","less"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IA2HSA,SAAS;eAATA;;IAAWC,eAAe;eAAfA;;;;uBA3HK;qCAII;sBACG;uBACM;mCACJ;AAElC,MAAMC,iBAAiB;IAAC;IAAO;CAAW;AAI1C,MAAMD,kBAAkB,CACtBE;IAEA,OAAO,YAAYA,SAASA,MAAMC,MAAM,CAACC,IAAI,KAAK;AACpD;AAEA,MAAMC,kBAAkB,CACtBC,MACAC,OACAC;IAEA,OAAOR,gBAAgBM,sBACrB,qBAACG,oCAAiB;QAEhBC,OAAOJ,KAAKK,EAAE;QACdC,YAAYN,KAAKH,MAAM,CAACS,UAAU;QAClCC,MAAMP,KAAKH,MAAM,CAACU,IAAI;QACtBC,KAAKR,KAAKH,MAAM,CAACW,GAAG;QACpBC,MAAMT,KAAKU,IAAI;OALVV,KAAKH,MAAM,CAACW,GAAG,IAQtBN,cAAcF,MAAMC;AAExB;AAOA,MAAMR,YAAY,CAAC,EAAEkB,KAAK,EAAEC,KAAK,EAAEC,UAAU,EAAS;IACpD,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAC;QAEnCJ;IADF,MAAMK,kBACJL,CAAAA,yBAAAA,kBAAAA,4BAAAA,MACIM,MAAM,CAACC,CAAAA,QAASxB,eAAeyB,QAAQ,CAACD,MAAMrB,IAAI,GACnDuB,GAAG,CAACF,CAAAA,QAASA,MAAMG,MAAM,EACzBC,IAAI,gBAHPX,oCAAAA,yBAGa,EAAE;IAEjB,MAAMY,wBAAwBZ,QAC1BA,MAAMM,MAAM,CAACC,CAAAA,QAASxB,eAAeyB,QAAQ,CAACD,MAAMrB,IAAI,GAAG2B,MAAM,GAAG,IACpE;IACJ,qBACE,sBAACC,SAAG;QAACC,IAAI;YAAEC,UAAU;YAAQC,OAAOf,SAAS,IAAIgB;QAAU;;0BACzD,sBAACJ,SAAG;gBAEFC,IAAI;oBACFI,GAAG;oBACHC,cAAc;oBACdC,SAASnB,SAAS,mBAAmB;oBACrCoB,UAAU;oBACVC,SAAS;oBACTC,KAAK;oBACLC,QAAQ;oBACRC,SAAS;oBACTC,cAAczB,SAAS,mBAAmB;oBAC1Ce,OAAO;oBAEP,WAAW;wBACTI,SAAS;wBACTM,cAAc;oBAChB;gBACF;gBACAC,SAAS,IAAOhB,wBAAwBT,UAAU0B,CAAAA,OAAQ,CAACA,QAAQX;;kCAEnE,qBAACY,aAAM;oBACN/B;oBACAa,sCACC,qBAACmB,oBAAa;wBACZhB,IAAI;4BACFiB,WAAW9B,SAAS,oBAAoBgB;wBAC1C;yBAEA;;eA5BCnB;YA8BNG,uBACC,sBAACY,SAAG;gBACFC,IAAI;oBACFkB,UAAU;oBACV,8BAA8B;wBAC5BC,iBAAiB;oBACnB;oBAEA,oCAAoC;wBAClCA,iBAAiB;oBACnB;gBACF;;kCAEA,sBAACC,gBAAU;wBACTpB,IAAI;4BACFO,UAAU;4BACVc,OAAO;4BACPC,eAAe;4BACfC,IAAI;4BACJC,IAAI;wBACN;;4BAEClC,gBAAgBQ,MAAM;4BAAC;4BAAU;4BACjCR,gBAAgBQ,MAAM,KAAK,IAAI,aAAa;;;kCAE/C,qBAAC2B,iCAAY;wBACXC,OAAOpC;wBACPqC,YAAY,CAACtD,MAAMC,QAAUF,gBAAgBC,MAAMC,OAAOY;wBAC1D0C,UAAU;wBACVC,eAAe;4BAAEC,MAAM;4BAAaC,MAAM;wBAAY;;;iBAGxD;;;AAGV"}