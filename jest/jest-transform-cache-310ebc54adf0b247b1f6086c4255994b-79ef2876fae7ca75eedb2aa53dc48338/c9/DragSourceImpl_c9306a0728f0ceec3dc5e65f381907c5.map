{"version":3,"sources":["../../../src/hooks/useDrag/DragSourceImpl.ts"],"sourcesContent":["import type { DragDropMonitor, DragSource, Identifier } from 'dnd-core'\n\nimport type { Connector } from '../../internals/index.js'\nimport type { DragSourceMonitor } from '../../types/index.js'\nimport type { DragObjectFactory, DragSourceHookSpec } from '../types.js'\n\nexport class DragSourceImpl<O, R, P> implements DragSource {\n\tpublic constructor(\n\t\tpublic spec: DragSourceHookSpec<O, R, P>,\n\t\tprivate monitor: DragSourceMonitor<O, R>,\n\t\tprivate connector: Connector,\n\t) {}\n\n\tpublic beginDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\n\t\tlet result: O | null = null\n\t\tif (typeof spec.item === 'object') {\n\t\t\tresult = spec.item as O\n\t\t} else if (typeof spec.item === 'function') {\n\t\t\tresult = (spec.item as DragObjectFactory<O>)(monitor)\n\t\t} else {\n\t\t\tresult = {} as O\n\t\t}\n\t\treturn result ?? null\n\t}\n\n\tpublic canDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tif (typeof spec.canDrag === 'boolean') {\n\t\t\treturn spec.canDrag\n\t\t} else if (typeof spec.canDrag === 'function') {\n\t\t\treturn spec.canDrag(monitor)\n\t\t} else {\n\t\t\treturn true\n\t\t}\n\t}\n\n\tpublic isDragging(globalMonitor: DragDropMonitor, target: Identifier) {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tconst { isDragging } = spec\n\t\treturn isDragging\n\t\t\t? isDragging(monitor)\n\t\t\t: target === globalMonitor.getSourceId()\n\t}\n\n\tpublic endDrag() {\n\t\tconst spec = this.spec\n\t\tconst monitor = this.monitor\n\t\tconst connector = this.connector\n\t\tconst { end } = spec\n\t\tif (end) {\n\t\t\tend(monitor.getItem(), monitor)\n\t\t}\n\t\tconnector.reconnect()\n\t}\n}\n"],"names":["DragSourceImpl","beginDrag","spec","monitor","result","item","canDrag","isDragging","globalMonitor","target","getSourceId","endDrag","connector","end","getItem","reconnect","constructor"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAMaA;;;eAAAA;;;AAAN,MAAMA;IAOZC,YAAmB;QAClB,MAAMC,OAAO,IAAI,CAACA,IAAI;QACtB,MAAMC,UAAU,IAAI,CAACA,OAAO;QAE5B,IAAIC,SAAmB;QACvB,IAAI,OAAOF,KAAKG,IAAI,KAAK,UAAU;YAClCD,SAASF,KAAKG,IAAI;eACZ,IAAI,OAAOH,KAAKG,IAAI,KAAK,YAAY;YAC3CD,SAASF,KAAMG,IAAI,CAA0BF;eACvC;YACNC,SAAS,CAAA;;QAEV,OAAOA,WAAM,QAANA,WAAM,KAAA,IAANA,SAAU;;IAGlBE,UAAiB;QAChB,MAAMJ,OAAO,IAAI,CAACA,IAAI;QACtB,MAAMC,UAAU,IAAI,CAACA,OAAO;QAC5B,IAAI,OAAOD,KAAKI,OAAO,KAAK,WAAW;YACtC,OAAOJ,KAAKI,OAAO;eACb,IAAI,OAAOJ,KAAKI,OAAO,KAAK,YAAY;YAC9C,OAAOJ,KAAKI,OAAO,CAACH;eACd;YACN,OAAO;;;IAITI,WAAkBC,aAA8B,EAAEC,MAAkB,EAAE;QACrE,MAAMP,OAAO,IAAI,CAACA,IAAI;QACtB,MAAMC,UAAU,IAAI,CAACA,OAAO;QAC5B,MAAM,EAAEI,UAAU,EAAE,GAAGL;QACvB,OAAOK,aACJA,WAAWJ,WACXM,WAAWD,cAAcE,WAAW;;IAGxCC,UAAiB;QAChB,MAAMT,OAAO,IAAI,CAACA,IAAI;QACtB,MAAMC,UAAU,IAAI,CAACA,OAAO;QAC5B,MAAMS,YAAY,IAAI,CAACA,SAAS;QAChC,MAAM,EAAEC,GAAG,EAAE,GAAGX;QAChB,IAAIW,KAAK;YACRA,IAAIV,QAAQW,OAAO,IAAIX;;QAExBS,UAAUG,SAAS;;IAlDpBC,YACQd,IAAiC,EAChCC,OAAgC,EAChCS,SAAoB,CAC3B;aAHMV,IAAiC,GAAjCA;aACCC,OAAgC,GAAhCA;aACAS,SAAoB,GAApBA"}