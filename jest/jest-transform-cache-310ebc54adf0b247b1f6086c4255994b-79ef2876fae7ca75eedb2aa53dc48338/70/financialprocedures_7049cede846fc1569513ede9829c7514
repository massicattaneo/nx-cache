977188faf572472f5e52c9a76b1c834b
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "financeProcedures", {
    enumerable: true,
    get: function() {
        return financeProcedures;
    }
});
const _zod = require("zod");
const _contracts = require("@rp/common/contracts");
const _generators = require("../../../database/generators");
const _bigdataapiprocedure = require("../bigdata-api-procedure");
function _define_property(obj, key, value) {
    if (key in obj) {
        Object.defineProperty(obj, key, {
            value: value,
            enumerable: true,
            configurable: true,
            writable: true
        });
    } else {
        obj[key] = value;
    }
    return obj;
}
function _object_spread(target) {
    for(var i = 1; i < arguments.length; i++){
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
                return Object.getOwnPropertyDescriptor(source, sym).enumerable;
            }));
        }
        ownKeys.forEach(function(key) {
            _define_property(target, key, source[key]);
        });
    }
    return target;
}
function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
        var symbols = Object.getOwnPropertySymbols(object);
        if (enumerableOnly) {
            symbols = symbols.filter(function(sym) {
                return Object.getOwnPropertyDescriptor(object, sym).enumerable;
            });
        }
        keys.push.apply(keys, symbols);
    }
    return keys;
}
function _object_spread_props(target, source) {
    source = source != null ? source : {};
    if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
        ownKeys(Object(source)).forEach(function(key) {
            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
    }
    return target;
}
const financeProcedures = {
    companyAnalystRatings: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-analyst-ratings"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_AnalystDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyAnalystRatings()
                });
            }, {})
        };
    }),
    companyCurrency: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-currency"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_CurrencyDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyCurrency()
                });
            }, {})
        };
    }),
    companyLatestSurprise: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-latest-surprise"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_EarningsSurpriseDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyLatestSurprise()
                });
            }, {})
        };
    }),
    companyPriceChanges: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-price-changes"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_ChangeDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyPriceChanges()
                });
            }, {})
        };
    }),
    companyPriceTarget: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-price-target"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_PriceTargetDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyPriceTarget()
                });
            }, {})
        };
    }),
    companyQuote: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-quote"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_QuoteDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyQuote()
                });
            }, {})
        };
    }),
    companySentiment: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-sentiment"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_zod.z.object({
        result: _zod.z.record(_contracts.bigdataSchemas.st_bff_data_tools_SentimentBFFToolData)
    })).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companySentiment()
                });
            }, {})
        };
    }),
    companyIncomeStatement: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-income-statement"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_zod.z.object({
        result: _zod.z.record(_contracts.bigdataSchemas.st_bff_data_tools_IncomeStatementBFFResponse)
    })).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyIncomeStatement()
                });
            }, {})
        };
    }),
    companyCashFlowStatement: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-cash-flow-statement"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_zod.z.object({
        result: _zod.z.record(_contracts.bigdataSchemas.st_bff_data_tools_CashFlowStatementBFFResponse)
    })).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyCashFlowStatement()
                });
            }, {})
        };
    }),
    companyBalanceStatement: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-balance-statement"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_BalanceStatementBFFResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyBalanceStatement()
                });
            }, {})
        };
    }),
    companyKeyMetrics: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-key-metrics"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_KeyMetricsDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyKeyMetrics()
                });
            }, {})
        };
    }),
    companyRatios: _bigdataapiprocedure.bigdataApiProcedure.meta({
        openapi: {
            method: "POST",
            path: "/financial-data/company-ratios"
        }
    }).input(_contracts.bigdataSchemas.st_bff_data_tools_BFFRequest).output(_contracts.bigdataSchemas.st_bff_data_tools_RatiosDataToolResponse).query(async ({ input })=>{
        return {
            result: input.entityIds.reduce((acc, entityId)=>{
                return _object_spread_props(_object_spread({}, acc), {
                    [entityId]: _generators.financialDataGenerators.companyRatios()
                });
            }, {})
        };
    })
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvZGV2ZWxvcG1lbnQvc3JjL2xpYi90cnBjL2JpZ2RhdGEtYXBpL3Byb2NlZHVyZXMvZmluYW5jaWFsLXByb2NlZHVyZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIlxuaW1wb3J0IHsgYmlnZGF0YVNjaGVtYXMgfSBmcm9tIFwiQHJwL2NvbW1vbi9jb250cmFjdHNcIlxuaW1wb3J0IHsgZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMgfSBmcm9tIFwiLi4vLi4vLi4vZGF0YWJhc2UvZ2VuZXJhdG9yc1wiXG5pbXBvcnQgeyBiaWdkYXRhQXBpUHJvY2VkdXJlIH0gZnJvbSBcIi4uL2JpZ2RhdGEtYXBpLXByb2NlZHVyZVwiXG5cbmV4cG9ydCBjb25zdCBmaW5hbmNlUHJvY2VkdXJlcyA9IHtcbiAgY29tcGFueUFuYWx5c3RSYXRpbmdzOiBiaWdkYXRhQXBpUHJvY2VkdXJlXG4gICAgLm1ldGEoeyBvcGVuYXBpOiB7IG1ldGhvZDogXCJQT1NUXCIsIHBhdGg6IFwiL2ZpbmFuY2lhbC1kYXRhL2NvbXBhbnktYW5hbHlzdC1yYXRpbmdzXCIgfSB9KVxuICAgIC5pbnB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CRkZSZXF1ZXN0KVxuICAgIC5vdXRwdXQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfQW5hbHlzdERhdGFUb29sUmVzcG9uc2UpXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueUFuYWx5c3RSYXRpbmdzKCkgfVxuICAgICAgICB9LCB7fSksXG4gICAgICB9XG4gICAgfSksXG4gIGNvbXBhbnlDdXJyZW5jeTogYmlnZGF0YUFwaVByb2NlZHVyZVxuICAgIC5tZXRhKHsgb3BlbmFwaTogeyBtZXRob2Q6IFwiUE9TVFwiLCBwYXRoOiBcIi9maW5hbmNpYWwtZGF0YS9jb21wYW55LWN1cnJlbmN5XCIgfSB9KVxuICAgIC5pbnB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CRkZSZXF1ZXN0KVxuICAgIC5vdXRwdXQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfQ3VycmVuY3lEYXRhVG9vbFJlc3BvbnNlKVxuICAgIC5xdWVyeShhc3luYyAoeyBpbnB1dCB9KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQ6IGlucHV0LmVudGl0eUlkcy5yZWR1Y2UoKGFjYywgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICByZXR1cm4geyAuLi5hY2MsIFtlbnRpdHlJZF06IGZpbmFuY2lhbERhdGFHZW5lcmF0b3JzLmNvbXBhbnlDdXJyZW5jeSgpIH1cbiAgICAgICAgfSwge30pLFxuICAgICAgfVxuICAgIH0pLFxuICBjb21wYW55TGF0ZXN0U3VycHJpc2U6IGJpZ2RhdGFBcGlQcm9jZWR1cmVcbiAgICAubWV0YSh7IG9wZW5hcGk6IHsgbWV0aG9kOiBcIlBPU1RcIiwgcGF0aDogXCIvZmluYW5jaWFsLWRhdGEvY29tcGFueS1sYXRlc3Qtc3VycHJpc2VcIiB9IH0pXG4gICAgLmlucHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0JGRlJlcXVlc3QpXG4gICAgLm91dHB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19FYXJuaW5nc1N1cnByaXNlRGF0YVRvb2xSZXNwb25zZSlcbiAgICAucXVlcnkoYXN5bmMgKHsgaW5wdXQgfSkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdWx0OiBpbnB1dC5lbnRpdHlJZHMucmVkdWNlKChhY2MsIGVudGl0eUlkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHsgLi4uYWNjLCBbZW50aXR5SWRdOiBmaW5hbmNpYWxEYXRhR2VuZXJhdG9ycy5jb21wYW55TGF0ZXN0U3VycHJpc2UoKSB9XG4gICAgICAgIH0sIHt9KSxcbiAgICAgIH1cbiAgICB9KSxcblxuICBjb21wYW55UHJpY2VDaGFuZ2VzOiBiaWdkYXRhQXBpUHJvY2VkdXJlXG4gICAgLm1ldGEoeyBvcGVuYXBpOiB7IG1ldGhvZDogXCJQT1NUXCIsIHBhdGg6IFwiL2ZpbmFuY2lhbC1kYXRhL2NvbXBhbnktcHJpY2UtY2hhbmdlc1wiIH0gfSlcbiAgICAuaW5wdXQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfQkZGUmVxdWVzdClcbiAgICAub3V0cHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0NoYW5nZURhdGFUb29sUmVzcG9uc2UpXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueVByaWNlQ2hhbmdlcygpIH1cbiAgICAgICAgfSwge30pLFxuICAgICAgfVxuICAgIH0pLFxuICBjb21wYW55UHJpY2VUYXJnZXQ6IGJpZ2RhdGFBcGlQcm9jZWR1cmVcbiAgICAubWV0YSh7IG9wZW5hcGk6IHsgbWV0aG9kOiBcIlBPU1RcIiwgcGF0aDogXCIvZmluYW5jaWFsLWRhdGEvY29tcGFueS1wcmljZS10YXJnZXRcIiB9IH0pXG4gICAgLmlucHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0JGRlJlcXVlc3QpXG4gICAgLm91dHB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19QcmljZVRhcmdldERhdGFUb29sUmVzcG9uc2UpXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueVByaWNlVGFyZ2V0KCkgfVxuICAgICAgICB9LCB7fSksXG4gICAgICB9XG4gICAgfSksXG4gIGNvbXBhbnlRdW90ZTogYmlnZGF0YUFwaVByb2NlZHVyZVxuICAgIC5tZXRhKHsgb3BlbmFwaTogeyBtZXRob2Q6IFwiUE9TVFwiLCBwYXRoOiBcIi9maW5hbmNpYWwtZGF0YS9jb21wYW55LXF1b3RlXCIgfSB9KVxuICAgIC5pbnB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CRkZSZXF1ZXN0KVxuICAgIC5vdXRwdXQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfUXVvdGVEYXRhVG9vbFJlc3BvbnNlKVxuICAgIC5xdWVyeShhc3luYyAoeyBpbnB1dCB9KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQ6IGlucHV0LmVudGl0eUlkcy5yZWR1Y2UoKGFjYywgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICByZXR1cm4geyAuLi5hY2MsIFtlbnRpdHlJZF06IGZpbmFuY2lhbERhdGFHZW5lcmF0b3JzLmNvbXBhbnlRdW90ZSgpIH1cbiAgICAgICAgfSwge30pLFxuICAgICAgfVxuICAgIH0pLFxuICBjb21wYW55U2VudGltZW50OiBiaWdkYXRhQXBpUHJvY2VkdXJlXG4gICAgLm1ldGEoeyBvcGVuYXBpOiB7IG1ldGhvZDogXCJQT1NUXCIsIHBhdGg6IFwiL2ZpbmFuY2lhbC1kYXRhL2NvbXBhbnktc2VudGltZW50XCIgfSB9KVxuICAgIC5pbnB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CRkZSZXF1ZXN0KVxuICAgIC5vdXRwdXQoXG4gICAgICB6Lm9iamVjdCh7XG4gICAgICAgIHJlc3VsdDogei5yZWNvcmQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfU2VudGltZW50QkZGVG9vbERhdGEpLFxuICAgICAgfSksXG4gICAgKVxuICAgIC5xdWVyeShhc3luYyAoeyBpbnB1dCB9KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQ6IGlucHV0LmVudGl0eUlkcy5yZWR1Y2UoKGFjYywgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICByZXR1cm4geyAuLi5hY2MsIFtlbnRpdHlJZF06IGZpbmFuY2lhbERhdGFHZW5lcmF0b3JzLmNvbXBhbnlTZW50aW1lbnQoKSB9XG4gICAgICAgIH0sIHt9KSxcbiAgICAgIH1cbiAgICB9KSxcbiAgY29tcGFueUluY29tZVN0YXRlbWVudDogYmlnZGF0YUFwaVByb2NlZHVyZVxuICAgIC5tZXRhKHsgb3BlbmFwaTogeyBtZXRob2Q6IFwiUE9TVFwiLCBwYXRoOiBcIi9maW5hbmNpYWwtZGF0YS9jb21wYW55LWluY29tZS1zdGF0ZW1lbnRcIiB9IH0pXG4gICAgLmlucHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0JGRlJlcXVlc3QpXG4gICAgLm91dHB1dChcbiAgICAgIHoub2JqZWN0KHtcbiAgICAgICAgcmVzdWx0OiB6LnJlY29yZChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19JbmNvbWVTdGF0ZW1lbnRCRkZSZXNwb25zZSksXG4gICAgICB9KSxcbiAgICApXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueUluY29tZVN0YXRlbWVudCgpIH1cbiAgICAgICAgfSwge30pLFxuICAgICAgfVxuICAgIH0pLFxuICBjb21wYW55Q2FzaEZsb3dTdGF0ZW1lbnQ6IGJpZ2RhdGFBcGlQcm9jZWR1cmVcbiAgICAubWV0YSh7IG9wZW5hcGk6IHsgbWV0aG9kOiBcIlBPU1RcIiwgcGF0aDogXCIvZmluYW5jaWFsLWRhdGEvY29tcGFueS1jYXNoLWZsb3ctc3RhdGVtZW50XCIgfSB9KVxuICAgIC5pbnB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CRkZSZXF1ZXN0KVxuICAgIC5vdXRwdXQoXG4gICAgICB6Lm9iamVjdCh7XG4gICAgICAgIHJlc3VsdDogei5yZWNvcmQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfQ2FzaEZsb3dTdGF0ZW1lbnRCRkZSZXNwb25zZSksXG4gICAgICB9KSxcbiAgICApXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueUNhc2hGbG93U3RhdGVtZW50KCkgfVxuICAgICAgICB9LCB7fSksXG4gICAgICB9XG4gICAgfSksXG4gIGNvbXBhbnlCYWxhbmNlU3RhdGVtZW50OiBiaWdkYXRhQXBpUHJvY2VkdXJlXG4gICAgLm1ldGEoeyBvcGVuYXBpOiB7IG1ldGhvZDogXCJQT1NUXCIsIHBhdGg6IFwiL2ZpbmFuY2lhbC1kYXRhL2NvbXBhbnktYmFsYW5jZS1zdGF0ZW1lbnRcIiB9IH0pXG4gICAgLmlucHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0JGRlJlcXVlc3QpXG4gICAgLm91dHB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19CYWxhbmNlU3RhdGVtZW50QkZGUmVzcG9uc2UpXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGlucHV0IH0pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdDogaW5wdXQuZW50aXR5SWRzLnJlZHVjZSgoYWNjLCBlbnRpdHlJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7IC4uLmFjYywgW2VudGl0eUlkXTogZmluYW5jaWFsRGF0YUdlbmVyYXRvcnMuY29tcGFueUJhbGFuY2VTdGF0ZW1lbnQoKSB9XG4gICAgICAgIH0sIHt9KSxcbiAgICAgIH1cbiAgICB9KSxcbiAgY29tcGFueUtleU1ldHJpY3M6IGJpZ2RhdGFBcGlQcm9jZWR1cmVcbiAgICAubWV0YSh7IG9wZW5hcGk6IHsgbWV0aG9kOiBcIlBPU1RcIiwgcGF0aDogXCIvZmluYW5jaWFsLWRhdGEvY29tcGFueS1rZXktbWV0cmljc1wiIH0gfSlcbiAgICAuaW5wdXQoYmlnZGF0YVNjaGVtYXMuc3RfYmZmX2RhdGFfdG9vbHNfQkZGUmVxdWVzdClcbiAgICAub3V0cHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0tleU1ldHJpY3NEYXRhVG9vbFJlc3BvbnNlKVxuICAgIC5xdWVyeShhc3luYyAoeyBpbnB1dCB9KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQ6IGlucHV0LmVudGl0eUlkcy5yZWR1Y2UoKGFjYywgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICByZXR1cm4geyAuLi5hY2MsIFtlbnRpdHlJZF06IGZpbmFuY2lhbERhdGFHZW5lcmF0b3JzLmNvbXBhbnlLZXlNZXRyaWNzKCkgfVxuICAgICAgICB9LCB7fSksXG4gICAgICB9XG4gICAgfSksXG4gIGNvbXBhbnlSYXRpb3M6IGJpZ2RhdGFBcGlQcm9jZWR1cmVcbiAgICAubWV0YSh7IG9wZW5hcGk6IHsgbWV0aG9kOiBcIlBPU1RcIiwgcGF0aDogXCIvZmluYW5jaWFsLWRhdGEvY29tcGFueS1yYXRpb3NcIiB9IH0pXG4gICAgLmlucHV0KGJpZ2RhdGFTY2hlbWFzLnN0X2JmZl9kYXRhX3Rvb2xzX0JGRlJlcXVlc3QpXG4gICAgLm91dHB1dChiaWdkYXRhU2NoZW1hcy5zdF9iZmZfZGF0YV90b29sc19SYXRpb3NEYXRhVG9vbFJlc3BvbnNlKVxuICAgIC5xdWVyeShhc3luYyAoeyBpbnB1dCB9KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHQ6IGlucHV0LmVudGl0eUlkcy5yZWR1Y2UoKGFjYywgZW50aXR5SWQpID0+IHtcbiAgICAgICAgICByZXR1cm4geyAuLi5hY2MsIFtlbnRpdHlJZF06IGZpbmFuY2lhbERhdGFHZW5lcmF0b3JzLmNvbXBhbnlSYXRpb3MoKSB9XG4gICAgICAgIH0sIHt9KSxcbiAgICAgIH1cbiAgICB9KSxcbn1cbiJdLCJuYW1lcyI6WyJmaW5hbmNlUHJvY2VkdXJlcyIsImNvbXBhbnlBbmFseXN0UmF0aW5ncyIsImJpZ2RhdGFBcGlQcm9jZWR1cmUiLCJtZXRhIiwib3BlbmFwaSIsIm1ldGhvZCIsInBhdGgiLCJpbnB1dCIsImJpZ2RhdGFTY2hlbWFzIiwic3RfYmZmX2RhdGFfdG9vbHNfQkZGUmVxdWVzdCIsIm91dHB1dCIsInN0X2JmZl9kYXRhX3Rvb2xzX0FuYWx5c3REYXRhVG9vbFJlc3BvbnNlIiwicXVlcnkiLCJyZXN1bHQiLCJlbnRpdHlJZHMiLCJyZWR1Y2UiLCJhY2MiLCJlbnRpdHlJZCIsImZpbmFuY2lhbERhdGFHZW5lcmF0b3JzIiwiY29tcGFueUN1cnJlbmN5Iiwic3RfYmZmX2RhdGFfdG9vbHNfQ3VycmVuY3lEYXRhVG9vbFJlc3BvbnNlIiwiY29tcGFueUxhdGVzdFN1cnByaXNlIiwic3RfYmZmX2RhdGFfdG9vbHNfRWFybmluZ3NTdXJwcmlzZURhdGFUb29sUmVzcG9uc2UiLCJjb21wYW55UHJpY2VDaGFuZ2VzIiwic3RfYmZmX2RhdGFfdG9vbHNfQ2hhbmdlRGF0YVRvb2xSZXNwb25zZSIsImNvbXBhbnlQcmljZVRhcmdldCIsInN0X2JmZl9kYXRhX3Rvb2xzX1ByaWNlVGFyZ2V0RGF0YVRvb2xSZXNwb25zZSIsImNvbXBhbnlRdW90ZSIsInN0X2JmZl9kYXRhX3Rvb2xzX1F1b3RlRGF0YVRvb2xSZXNwb25zZSIsImNvbXBhbnlTZW50aW1lbnQiLCJ6Iiwib2JqZWN0IiwicmVjb3JkIiwic3RfYmZmX2RhdGFfdG9vbHNfU2VudGltZW50QkZGVG9vbERhdGEiLCJjb21wYW55SW5jb21lU3RhdGVtZW50Iiwic3RfYmZmX2RhdGFfdG9vbHNfSW5jb21lU3RhdGVtZW50QkZGUmVzcG9uc2UiLCJjb21wYW55Q2FzaEZsb3dTdGF0ZW1lbnQiLCJzdF9iZmZfZGF0YV90b29sc19DYXNoRmxvd1N0YXRlbWVudEJGRlJlc3BvbnNlIiwiY29tcGFueUJhbGFuY2VTdGF0ZW1lbnQiLCJzdF9iZmZfZGF0YV90b29sc19CYWxhbmNlU3RhdGVtZW50QkZGUmVzcG9uc2UiLCJjb21wYW55S2V5TWV0cmljcyIsInN0X2JmZl9kYXRhX3Rvb2xzX0tleU1ldHJpY3NEYXRhVG9vbFJlc3BvbnNlIiwiY29tcGFueVJhdGlvcyIsInN0X2JmZl9kYXRhX3Rvb2xzX1JhdGlvc0RhdGFUb29sUmVzcG9uc2UiXSwicmFuZ2VNYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsiLCJtYXBwaW5ncyI6Ijs7OzsrQkFLYUE7OztlQUFBQTs7O3FCQUxLOzJCQUNhOzRCQUNTO3FDQUNKOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUU3QixNQUFNQSxvQkFBb0I7SUFDL0JDLHVC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