{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/useChatActions.tsx"],"sourcesContent":["import { generatePath, useNavigate } from \"react-router-dom\"\nimport { getShareObject } from \"@rp/common/utils\"\nimport { useCopyShareLink } from \"@rp/react/common/hooks\"\nimport { ChatListObject, usePatchChat } from \"@rp/react/tanstack-api/chat\"\nimport { useModal, useSnackbar } from \"@rp/react/web/common/providers\"\nimport { Actions } from \"@rp/react/web/common/types\"\nimport { Delete, Edit, Link, OpenInNew } from \"@rp/react/web/mui/icons\"\nimport { CHAT_ID_ROUTE, WATCHLIST_ID_ROUTE } from \"@rp/react/web/router\"\n\ntype ChatListObjectWithPublic = ChatListObject\ntype ChatActions = Record<\n  \"remove\" | \"rename\" | \"open\" | \"copy\",\n  Actions<ChatListObjectWithPublic>[number]\n>\n\nconst getPath = (chat: ChatListObject) =>\n  chat.scopeWatchlistId !== undefined\n    ? WATCHLIST_ID_ROUTE.replace(\":id\", chat.scopeWatchlistId) + `?chatId=${chat.id}`\n    : CHAT_ID_ROUTE.replace(\":id\", chat.id)\n\nconst useChatActions = () => {\n  const navigate = useNavigate()\n  const { copy } = useCopyShareLink()\n  const {\n    editChatNameModal: { handleOpen: handleOpenEditText },\n    deleteChatModal: { handleOpen: handleOpenDeleteChat },\n  } = useModal()\n  const { enqueueSuccess } = useSnackbar()\n\n  const onEdit = ({ name, id }: ChatListObject) => {\n    handleOpenEditText({\n      value: name,\n      description: \"Choose a name for this chat\",\n      id: id,\n      editHook: usePatchChat,\n    })\n  }\n\n  const actions = {\n    remove: {\n      id: \"remove\",\n      label: \"Delete\",\n      icon: <Delete />,\n      onClick: chat => {\n        return new Promise<void>(resolve => {\n          handleOpenDeleteChat({\n            id: chat.id,\n            name: chat.name,\n            onSuccess: () => resolve(),\n          })\n        })\n      },\n    },\n    rename: {\n      id: \"rename\",\n      label: \"Rename\",\n      icon: <Edit />,\n      onClick: chat => onEdit(chat),\n    },\n    open: {\n      id: \"open\",\n      label: \"Open\",\n      icon: <OpenInNew />,\n      onClick: chat => {\n        navigate(getPath(chat))\n      },\n    },\n    copy: {\n      id: \"copy\",\n      icon: <Link />,\n      label: \"Copy Link\",\n      onClick: chat => {\n        const obj = getShareObject({\n          shareObjectId: chat.id,\n          shareObjectType: \"chat\",\n          path: generatePath(CHAT_ID_ROUTE, { id: chat.id }),\n          name: chat.name,\n        })\n        copy(obj).then(() => {\n          enqueueSuccess(\"Link copied successfully\")\n        })\n      },\n      allowedAction: chat => chat.isPublic !== true, // This is reversed for some reason\n    },\n  } satisfies ChatActions\n\n  return { actions }\n}\n\nexport { useChatActions }\n"],"names":["useChatActions","getPath","chat","scopeWatchlistId","undefined","WATCHLIST_ID_ROUTE","replace","id","CHAT_ID_ROUTE","navigate","useNavigate","copy","useCopyShareLink","editChatNameModal","handleOpen","handleOpenEditText","deleteChatModal","handleOpenDeleteChat","useModal","enqueueSuccess","useSnackbar","onEdit","name","value","description","editHook","usePatchChat","actions","remove","label","icon","Delete","onClick","Promise","resolve","onSuccess","rename","Edit","open","OpenInNew","Link","obj","getShareObject","shareObjectId","shareObjectType","path","generatePath","then","allowedAction","isPublic"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAyFSA;;;eAAAA;;;;gCAzFiC;uBACX;uBACE;sBACY;2BACP;uBAEQ;wBACI;AAQlD,MAAMC,UAAU,CAACC,OACfA,KAAKC,gBAAgB,KAAKC,YACtBC,0BAAkB,CAACC,OAAO,CAAC,OAAOJ,KAAKC,gBAAgB,IAAI,CAAC,QAAQ,EAAED,KAAKK,EAAE,CAAC,CAAC,GAC/EC,qBAAa,CAACF,OAAO,CAAC,OAAOJ,KAAKK,EAAE;AAE1C,MAAMP,iBAAiB;IACrB,MAAMS,WAAWC,IAAAA,2BAAW;IAC5B,MAAM,EAAEC,IAAI,EAAE,GAAGC,IAAAA,uBAAgB;IACjC,MAAM,EACJC,mBAAmB,EAAEC,YAAYC,kBAAkB,EAAE,EACrDC,iBAAiB,EAAEF,YAAYG,oBAAoB,EAAE,EACtD,GAAGC,IAAAA,mBAAQ;IACZ,MAAM,EAAEC,cAAc,EAAE,GAAGC,IAAAA,sBAAW;IAEtC,MAAMC,SAAS,CAAC,EAAEC,IAAI,EAAEf,EAAE,EAAkB;QAC1CQ,mBAAmB;YACjBQ,OAAOD;YACPE,aAAa;YACbjB,IAAIA;YACJkB,UAAUC,kBAAY;QACxB;IACF;IAEA,MAAMC,UAAU;QACdC,QAAQ;YACNrB,IAAI;YACJsB,OAAO;YACPC,oBAAM,qBAACC,aAAM;YACbC,SAAS9B,CAAAA;gBACP,OAAO,IAAI+B,QAAcC,CAAAA;oBACvBjB,qBAAqB;wBACnBV,IAAIL,KAAKK,EAAE;wBACXe,MAAMpB,KAAKoB,IAAI;wBACfa,WAAW,IAAMD;oBACnB;gBACF;YACF;QACF;QACAE,QAAQ;YACN7B,IAAI;YACJsB,OAAO;YACPC,oBAAM,qBAACO,WAAI;YACXL,SAAS9B,CAAAA,OAAQmB,OAAOnB;QAC1B;QACAoC,MAAM;YACJ/B,IAAI;YACJsB,OAAO;YACPC,oBAAM,qBAACS,gBAAS;YAChBP,SAAS9B,CAAAA;gBACPO,SAASR,QAAQC;YACnB;QACF;QACAS,MAAM;YACJJ,IAAI;YACJuB,oBAAM,qBAACU,WAAI;YACXX,OAAO;YACPG,SAAS9B,CAAAA;gBACP,MAAMuC,MAAMC,IAAAA,qBAAc,EAAC;oBACzBC,eAAezC,KAAKK,EAAE;oBACtBqC,iBAAiB;oBACjBC,MAAMC,IAAAA,4BAAY,EAACtC,qBAAa,EAAE;wBAAED,IAAIL,KAAKK,EAAE;oBAAC;oBAChDe,MAAMpB,KAAKoB,IAAI;gBACjB;gBACAX,KAAK8B,KAAKM,IAAI,CAAC;oBACb5B,eAAe;gBACjB;YACF;YACA6B,eAAe9C,CAAAA,OAAQA,KAAK+C,QAAQ,KAAK;QAC3C;IACF;IAEA,OAAO;QAAEtB;IAAQ;AACnB"}