{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/common/watchlists/src/lib/usePerformanceIndicator.ts"],"sourcesContent":["import { useMemo } from \"react\"\nimport { isDefined, isNotNull } from \"@rp/common/utils\"\nimport { useFinancialData } from \"@rp/react/tanstack-api/financial-data\"\nimport { useWatchlistEntities } from \"@rp/react/tanstack-api/watchlist\"\n\nexport const usePerformanceIndicator = (id?: string) => {\n  const { entities, isLoadingEntities, isLoadingWatchlist } = useWatchlistEntities(id)\n  const input = useMemo(() => {\n    return {\n      companyQuote: { entityIds: entities.map(item => item.key) },\n    }\n  }, [entities])\n  const data = useFinancialData(input)\n\n  const memo = useMemo(() => {\n    const filtered = entities\n      .filter(item => item.queryType === \"entity\")\n      .filter(entity => !data[entity.key].companyQuote?.isError)\n      .map(entity => data[entity.key].companyQuote?.data?.changePercentage)\n      .filter(isDefined)\n      .filter(isNotNull)\n    const average: number = filtered.reduce((avg, value) => avg + value, 0)\n    return {\n      average: average === 0 ? null : average / filtered.length,\n      isLoading: Object.values(data).some(item => item.companyQuote?.isLoading),\n    }\n  }, [data, entities])\n\n  return {\n    average: memo.average,\n    isLoading: isLoadingEntities || isLoadingWatchlist || memo.isLoading,\n  }\n}\n"],"names":["usePerformanceIndicator","id","entities","isLoadingEntities","isLoadingWatchlist","useWatchlistEntities","input","useMemo","companyQuote","entityIds","map","item","key","data","useFinancialData","memo","filtered","filter","queryType","entity","isError","changePercentage","isDefined","isNotNull","average","reduce","avg","value","length","isLoading","Object","values","some"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAKaA;;;eAAAA;;;uBALW;uBACa;+BACJ;2BACI;AAE9B,MAAMA,0BAA0B,CAACC;IACtC,MAAM,EAAEC,QAAQ,EAAEC,iBAAiB,EAAEC,kBAAkB,EAAE,GAAGC,IAAAA,+BAAoB,EAACJ;IACjF,MAAMK,QAAQC,IAAAA,cAAO,EAAC;QACpB,OAAO;YACLC,cAAc;gBAAEC,WAAWP,SAASQ,GAAG,CAACC,CAAAA,OAAQA,KAAKC,GAAG;YAAE;QAC5D;IACF,GAAG;QAACV;KAAS;IACb,MAAMW,OAAOC,IAAAA,+BAAgB,EAACR;IAE9B,MAAMS,OAAOR,IAAAA,cAAO,EAAC;QACnB,MAAMS,WAAWd,SACde,MAAM,CAACN,CAAAA,OAAQA,KAAKO,SAAS,KAAK,UAClCD,MAAM,CAACE,CAAAA;gBAAWN;mBAAD,GAACA,gCAAAA,IAAI,CAACM,OAAOP,GAAG,CAAC,CAACJ,YAAY,cAA7BK,oDAAAA,8BAA+BO,OAAO;WACxDV,GAAG,CAACS,CAAAA;gBAAUN,oCAAAA;oBAAAA,gCAAAA,IAAI,CAACM,OAAOP,GAAG,CAAC,CAACJ,YAAY,cAA7BK,qDAAAA,qCAAAA,8BAA+BA,IAAI,cAAnCA,yDAAAA,mCAAqCQ,gBAAgB;WACnEJ,MAAM,CAACK,gBAAS,EAChBL,MAAM,CAACM,gBAAS;QACnB,MAAMC,UAAkBR,SAASS,MAAM,CAAC,CAACC,KAAKC,QAAUD,MAAMC,OAAO;QACrE,OAAO;YACLH,SAASA,YAAY,IAAI,OAAOA,UAAUR,SAASY,MAAM;YACzDC,WAAWC,OAAOC,MAAM,CAAClB,MAAMmB,IAAI,CAACrB,CAAAA;oBAAQA;wBAAAA,qBAAAA,KAAKH,YAAY,cAAjBG,yCAAAA,mBAAmBkB,SAAS;;QAC1E;IACF,GAAG;QAAChB;QAAMX;KAAS;IAEnB,OAAO;QACLsB,SAAST,KAAKS,OAAO;QACrBK,WAAW1B,qBAAqBC,sBAAsBW,KAAKc,SAAS;IACtE;AACF"}