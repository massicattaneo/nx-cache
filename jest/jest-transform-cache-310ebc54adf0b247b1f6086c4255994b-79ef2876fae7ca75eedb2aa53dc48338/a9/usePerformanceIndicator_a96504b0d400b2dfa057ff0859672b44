30512c955010e89f9e44ac93e9a69779
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "usePerformanceIndicator", {
    enumerable: true,
    get: function() {
        return usePerformanceIndicator;
    }
});
const _react = require("react");
const _utils = require("@rp/common/utils");
const _financialdata = require("@rp/react/tanstack-api/financial-data");
const _watchlist = require("@rp/react/tanstack-api/watchlist");
const usePerformanceIndicator = (id)=>{
    const { entities, isLoadingEntities, isLoadingWatchlist } = (0, _watchlist.useWatchlistEntities)(id);
    const input = (0, _react.useMemo)(()=>{
        return {
            companyQuote: {
                entityIds: entities.map((item)=>item.key)
            }
        };
    }, [
        entities
    ]);
    const data = (0, _financialdata.useFinancialData)(input);
    const memo = (0, _react.useMemo)(()=>{
        const filtered = entities.filter((item)=>item.queryType === "entity").filter((entity)=>{
            var _data_entity_key_companyQuote;
            return !((_data_entity_key_companyQuote = data[entity.key].companyQuote) === null || _data_entity_key_companyQuote === void 0 ? void 0 : _data_entity_key_companyQuote.isError);
        }).map((entity)=>{
            var _data_entity_key_companyQuote_data, _data_entity_key_companyQuote;
            return (_data_entity_key_companyQuote = data[entity.key].companyQuote) === null || _data_entity_key_companyQuote === void 0 ? void 0 : (_data_entity_key_companyQuote_data = _data_entity_key_companyQuote.data) === null || _data_entity_key_companyQuote_data === void 0 ? void 0 : _data_entity_key_companyQuote_data.changePercentage;
        }).filter(_utils.isDefined).filter(_utils.isNotNull);
        const average = filtered.reduce((avg, value)=>avg + value, 0);
        return {
            average: average === 0 ? null : average / filtered.length,
            isLoading: Object.values(data).some((item)=>{
                var _item_companyQuote;
                return (_item_companyQuote = item.companyQuote) === null || _item_companyQuote === void 0 ? void 0 : _item_companyQuote.isLoading;
            })
        };
    }, [
        data,
        entities
    ]);
    return {
        average: memo.average,
        isLoading: isLoadingEntities || isLoadingWatchlist || memo.isLoading
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvcmVhY3QvY29tbW9uL3dhdGNobGlzdHMvc3JjL2xpYi91c2VQZXJmb3JtYW5jZUluZGljYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VNZW1vIH0gZnJvbSBcInJlYWN0XCJcbmltcG9ydCB7IGlzRGVmaW5lZCwgaXNOb3ROdWxsIH0gZnJvbSBcIkBycC9jb21tb24vdXRpbHNcIlxuaW1wb3J0IHsgdXNlRmluYW5jaWFsRGF0YSB9IGZyb20gXCJAcnAvcmVhY3QvdGFuc3RhY2stYXBpL2ZpbmFuY2lhbC1kYXRhXCJcbmltcG9ydCB7IHVzZVdhdGNobGlzdEVudGl0aWVzIH0gZnJvbSBcIkBycC9yZWFjdC90YW5zdGFjay1hcGkvd2F0Y2hsaXN0XCJcblxuZXhwb3J0IGNvbnN0IHVzZVBlcmZvcm1hbmNlSW5kaWNhdG9yID0gKGlkPzogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IHsgZW50aXRpZXMsIGlzTG9hZGluZ0VudGl0aWVzLCBpc0xvYWRpbmdXYXRjaGxpc3QgfSA9IHVzZVdhdGNobGlzdEVudGl0aWVzKGlkKVxuICBjb25zdCBpbnB1dCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBjb21wYW55UXVvdGU6IHsgZW50aXR5SWRzOiBlbnRpdGllcy5tYXAoaXRlbSA9PiBpdGVtLmtleSkgfSxcbiAgICB9XG4gIH0sIFtlbnRpdGllc10pXG4gIGNvbnN0IGRhdGEgPSB1c2VGaW5hbmNpYWxEYXRhKGlucHV0KVxuXG4gIGNvbnN0IG1lbW8gPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBmaWx0ZXJlZCA9IGVudGl0aWVzXG4gICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5xdWVyeVR5cGUgPT09IFwiZW50aXR5XCIpXG4gICAgICAuZmlsdGVyKGVudGl0eSA9PiAhZGF0YVtlbnRpdHkua2V5XS5jb21wYW55UXVvdGU/LmlzRXJyb3IpXG4gICAgICAubWFwKGVudGl0eSA9PiBkYXRhW2VudGl0eS5rZXldLmNvbXBhbnlRdW90ZT8uZGF0YT8uY2hhbmdlUGVyY2VudGFnZSlcbiAgICAgIC5maWx0ZXIoaXNEZWZpbmVkKVxuICAgICAgLmZpbHRlcihpc05vdE51bGwpXG4gICAgY29uc3QgYXZlcmFnZTogbnVtYmVyID0gZmlsdGVyZWQucmVkdWNlKChhdmcsIHZhbHVlKSA9PiBhdmcgKyB2YWx1ZSwgMClcbiAgICByZXR1cm4ge1xuICAgICAgYXZlcmFnZTogYXZlcmFnZSA9PT0gMCA/IG51bGwgOiBhdmVyYWdlIC8gZmlsdGVyZWQubGVuZ3RoLFxuICAgICAgaXNMb2FkaW5nOiBPYmplY3QudmFsdWVzKGRhdGEpLnNvbWUoaXRlbSA9PiBpdGVtLmNvbXBhbnlRdW90ZT8uaXNMb2FkaW5nKSxcbiAgICB9XG4gIH0sIFtkYXRhLCBlbnRpdGllc10pXG5cbiAgcmV0dXJuIHtcbiAgICBhdmVyYWdlOiBtZW1vLmF2ZXJhZ2UsXG4gICAgaXNMb2FkaW5nOiBpc0xvYWRpbmdFbnRpdGllcyB8fCBpc0xvYWRpbmdXYXRjaGxpc3QgfHwgbWVtby5pc0xvYWRpbmcsXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJ1c2VQZXJmb3JtYW5jZUluZGljYXRvciIsImlkIiwiZW50aXRpZXMiLCJpc0xvYWRpbmdFbnRpdGllcyIsImlzTG9hZGluZ1dhdGNobGlzdCIsInVzZVdhdGNobGlzdEVudGl0aWVzIiwiaW5wdXQiLCJ1c2VNZW1vIiwiY29tcGFueVF1b3RlIiwiZW50aXR5SWRzIiwibWFwIiwiaXRlbSIsImtleSIsImRhdGEiLCJ1c2VGaW5hbmNpYWxEYXRhIiwibWVtbyIsImZpbHRlcmVkIiwiZmlsdGVyIiwicXVlcnlUeXBlIiwiZW50aXR5IiwiaXNFcnJvciIsImNoYW5nZVBlcmNlbnRhZ2UiLCJpc0RlZmluZWQiLCJpc05vdE51bGwiLCJhdmVyYWdlIiwicmVkdWNlIiwiYXZnIiwidmFsdWUiLCJsZW5ndGgiLCJpc0xvYWRpbmciLCJPYmplY3QiLCJ2YWx1ZXMiLCJzb21lIl0sInJhbmdlTWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyIsIm1hcHBpbmdzIjoiOzs7OytCQUthQTs7O2VBQUFBOzs7dUJBTFc7dUJBQ2E7K0JBQ0o7MkJBQ0k7QUFFOUIsTUFBTUEsMEJBQTBCLENBQUNDO0lBQ3RDLE1BQU0sRUFBRUMsUUFBUSxFQUFFQyxpQkFBaUIsRUFBRUMsa0JBQWtCLEVBQUUsR0FBR0MsSUFBQUEsK0JBQW9CLEVBQUNKO0lBQ2pGLE1BQU1LLFFBQVFDLElBQUFBLGNBQU8sRUFBQztRQUNwQixPQUFPO1lBQ0xDLGNBQWM7Z0JBQUVDLFdBQVdQLFNBQVNRLEdBQUcsQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBS0MsR0FBRztZQUFFO1FBQzVEO0lBQ0YsR0FBRztRQUFDVjtLQUFTO0lBQ2IsTUFBTVcsT0FBT0MsSUFBQUEsK0JBQWdCLEVBQUNSO0lBRTlCLE1BQU1TLE9BQU9SLElBQUFBLGNBQU8sRUFBQztRQUNuQixNQUFNUyxXQUFXZCxTQUNkZSxNQUFNLENBQUNOLENBQUFBLE9BQVFBLEtBQUtPLFNBQVMsS0FBSyxVQUNsQ0QsTUFBTSxDQUFDRSxDQUFBQTtnQkFBV047bUJBQUQsR0FBQ0EsZ0NBQUFBLElBQUksQ0FBQ00sT0FBT1AsR0FBRyxDQUFDLENBQUNKLFlBQVksY0FBN0JLLG9EQUFBQSw4QkFBK0JPLE9BQU87V0FDeERWLEdBQUcsQ0FBQ1MsQ0FBQUE7Z0JBQVVOLG9DQUFBQTtvQkFBQUEsZ0NBQUFBLElBQUksQ0FBQ00sT0FBT1AsR0FBRyxDQUFDLENBQUNKLFlBQVksY0FBN0JLLHFEQUFBQSxxQ0FBQUEsOEJBQStCQSxJQUFJLGNBQW5DQSx5REFBQUEsbUNBQXFDUSxnQkFBZ0I7V0FDbkVKLE1BQU0sQ0FBQ0ssZ0JBQVMsRUFDaEJMLE1BQU0sQ0FBQ00sZ0JBQVM7UUFDbkIsTUFBTUMsVUFBa0JSLFNBQVNTLE1BQU0sQ0FBQyxDQUFDQyxLQUFLQyxRQUFVRCxNQUFNQyxPQUFPO1FBQ3JFLE9BQU87WUFDTEgsU0FBU0EsWUFBWSxJQUFJLE9BQU9BLFVBQVVSLFNBQVNZLE1BQU07WUFDekRDLFdBQVdDLE9BQU9DLE1BQU0sQ0FBQ2xCLE1BQU1tQixJQUFJLENBQUNyQixDQUFBQTtvQkFBUUE7d0JBQUFBLHFCQUFBQSxLQUFLSCxZQUFZLGNBQWpCRyx5Q0FBQUEsbUJBQW1Ca0IsU0FBUzs7UUFDMUU7SUFDRixHQUFHO1FBQUNoQjtRQUFNWDtLQUFTO0lBRW5CLE9BQU87UUFDTHNCLFNBQVNULEtBQUtTLE9BQU87UUFDckJLLFdBQVcxQixxQkFBcUJDLHNCQUFzQlcsS0FBS2MsU0FBUztJQUN0RTtBQUNGIn0=