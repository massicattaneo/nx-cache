{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/base-components/src/LazyImage/LazyImage.tsx"],"sourcesContent":["import { ReactElement, useState } from \"react\"\nimport { Fade } from \"@rp/react/web/mui/core\"\nimport { useQuery } from \"@tanstack/react-query\"\n\ntype Props = {\n  fallback?: ReactElement\n  loadingFallback?: ReactElement\n  src?: string\n  alt?: string\n  width?: number | string\n  height?: number | string\n  loading?: boolean\n  addRoundedBorderTop?: boolean\n}\n\nconst loadImage = (src: string) => {\n  return new Promise<string>((resolve, reject) => {\n    const img = new Image()\n    img.src = src\n    img.onload = () => resolve(src)\n    img.onerror = reject\n  })\n}\n\nexport const LazyImage = ({\n  loadingFallback,\n  fallback,\n  src = \"\",\n  alt,\n  width,\n  height,\n  loading,\n  addRoundedBorderTop,\n}: Props) => {\n  const { isLoading, data: srcResolved } = useQuery({\n    queryKey: [\"image\", src],\n    queryFn: () => loadImage(src),\n    enabled: !!src,\n    retry: 0,\n  })\n  const [hadCache] = useState(srcResolved === src)\n\n  if (isLoading || loading) return loadingFallback\n  if (!srcResolved && fallback) return fallback\n  return (\n    <Fade in timeout={hadCache ? 0 : 500}>\n      <img\n        style={\n          addRoundedBorderTop ? { borderTopRightRadius: \"12px\", borderTopLeftRadius: \"12px\" } : {}\n        }\n        src={srcResolved}\n        alt={alt}\n        width={width}\n        height={height}\n      />\n    </Fade>\n  )\n}\n"],"names":["LazyImage","loadImage","src","Promise","resolve","reject","img","Image","onload","onerror","loadingFallback","fallback","alt","width","height","loading","addRoundedBorderTop","isLoading","data","srcResolved","useQuery","queryKey","queryFn","enabled","retry","hadCache","useState","Fade","in","timeout","style","borderTopRightRadius","borderTopLeftRadius"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAwBaA;;;eAAAA;;;;uBAxB0B;sBAClB;4BACI;AAazB,MAAMC,YAAY,CAACC;IACjB,OAAO,IAAIC,QAAgB,CAACC,SAASC;QACnC,MAAMC,MAAM,IAAIC;QAChBD,IAAIJ,GAAG,GAAGA;QACVI,IAAIE,MAAM,GAAG,IAAMJ,QAAQF;QAC3BI,IAAIG,OAAO,GAAGJ;IAChB;AACF;AAEO,MAAML,YAAY,CAAC,EACxBU,eAAe,EACfC,QAAQ,EACRT,MAAM,EAAE,EACRU,GAAG,EACHC,KAAK,EACLC,MAAM,EACNC,OAAO,EACPC,mBAAmB,EACb;IACN,MAAM,EAAEC,SAAS,EAAEC,MAAMC,WAAW,EAAE,GAAGC,IAAAA,oBAAQ,EAAC;QAChDC,UAAU;YAAC;YAASnB;SAAI;QACxBoB,SAAS,IAAMrB,UAAUC;QACzBqB,SAAS,CAAC,CAACrB;QACXsB,OAAO;IACT;IACA,MAAM,CAACC,SAAS,GAAGC,IAAAA,eAAQ,EAACP,gBAAgBjB;IAE5C,IAAIe,aAAaF,SAAS,OAAOL;IACjC,IAAI,CAACS,eAAeR,UAAU,OAAOA;IACrC,qBACE,qBAACgB,UAAI;QAACC,EAAE;QAACC,SAASJ,WAAW,IAAI;kBAC/B,cAAA,qBAACnB;YACCwB,OACEd,sBAAsB;gBAAEe,sBAAsB;gBAAQC,qBAAqB;YAAO,IAAI,CAAC;YAEzF9B,KAAKiB;YACLP,KAAKA;YACLC,OAAOA;YACPC,QAAQA;;;AAIhB"}