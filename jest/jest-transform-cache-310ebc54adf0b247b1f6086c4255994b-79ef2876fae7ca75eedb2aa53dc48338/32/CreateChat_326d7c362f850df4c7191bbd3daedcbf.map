{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/CreateChat/CreateChat.tsx"],"sourcesContent":["import { useEffect } from \"react\"\nimport { Link, useNavigate } from \"react-router-dom\"\nimport { DatasetScope } from \"@rp/common/api-types\"\nimport { SCOPES_QUERY_PARAM } from \"@rp/common/settings\"\nimport { BigdataIconBlack, BigdataLogoWhite } from \"@rp/react/common/assets\"\nimport { chatDatasets } from \"@rp/react/common/chat\"\nimport { ChatFileContext } from \"@rp/react/common/hooks\"\nimport { useWorkflowList } from \"@rp/react/tanstack-api/workflow\"\nimport { theme } from \"@rp/react/theme\"\nimport { FlowCard, ScrollCarousel } from \"@rp/react/web/common/composite-components\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { Box, Typography } from \"@rp/react/web/mui/core\"\nimport { ArrowForwardIos } from \"@rp/react/web/mui/icons\"\nimport { CHAT_ROUTE, SUGGESTED_PROMPTS_ROUTE, WORKFLOW_ID_ROUTE } from \"@rp/react/web/router\"\nimport { ChatFileContextDisplay } from \"../Chat/ChatContext/ChatFileContextDisplay\"\nimport { ChatWatchlistContextDisplay } from \"../Chat/ChatContext/ChatWatchlistContextDisplay\"\nimport { UserInput } from \"../Chat/UserInput/UserInput\"\nimport { LoadingResponseSkeleton } from \"./LoadingResponseSkeleton\"\nimport { MobileArrowForwardButton } from \"./MobileArrowForwardButton\"\nimport { MobileRecentChats } from \"./MobileRecentChats\"\n\ntype Props = {\n  fileContext?: ChatFileContext\n  currentInteraction?: {\n    userInput: string\n    error: boolean\n    stopped: boolean\n    edit: boolean\n    displayedMessage?: string\n  }\n  userInitials: string\n  scope: DatasetScope | undefined\n  watchlistId?: string\n}\nconst CreateChat = ({\n  fileContext,\n  currentInteraction,\n  userInitials,\n  scope,\n  watchlistId,\n}: Props) => {\n  const { isMobile } = useDeviceInfo()\n  const { data: workflows } = useWorkflowList()\n  const navigate = useNavigate()\n\n  useEffect(() => {\n    if (currentInteraction !== undefined) {\n      window.scroll({ top: 0 })\n    }\n  }, [currentInteraction])\n\n  if (fileContext || currentInteraction) {\n    return (\n      <Box\n        sx={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          justifyContent: isMobile ? \"top\" : \"center\",\n          mt: 3,\n        }}\n      >\n        {fileContext?.filesIds ? (\n          <ChatFileContextDisplay filesIds={fileContext.filesIds} isChatEmpty={true} />\n        ) : null}\n        {fileContext?.watchlistIds ? (\n          <ChatWatchlistContextDisplay\n            watchlistId={fileContext.watchlistIds[0]}\n            isChatEmpty={true}\n          />\n        ) : null}\n        {currentInteraction ? (\n          <Box\n            sx={{\n              width: \"100%\",\n              maxWidth: 700,\n              mx: \"auto\",\n              minHeight: \"calc(100dvh - 80px)\",\n            }}\n          >\n            <UserInput\n              variant={isMobile ? \"mobile\" : \"desktop\"}\n              userInitials={userInitials}\n              disableScroll\n            >\n              {currentInteraction.displayedMessage ?? currentInteraction.userInput}\n            </UserInput>\n            <LoadingResponseSkeleton />\n          </Box>\n        ) : null}\n      </Box>\n    )\n  }\n\n  const handleLabel = () => {\n    if (workflows) {\n      return \"Workflows\"\n    }\n    if (isPromptFilter) {\n      return `Prompts for ${chatDatasets[scope].label}`\n    }\n    if (!scope && watchlistId) {\n      return \"Prompts for Watchlists\"\n    }\n    return \"Suggested Prompts\"\n  }\n\n  const handleRoute = () => {\n    if (workflows) {\n      return CHAT_ROUTE\n    }\n    return `${SUGGESTED_PROMPTS_ROUTE}${isPromptFilter ? `?${SCOPES_QUERY_PARAM}=${scope}` : \"\"}`\n  }\n\n  const isPromptFilter = scope && chatDatasets[scope].isPromptFilter\n\n  const label = handleLabel()\n  const promptRoute = handleRoute()\n\n  return (\n    <Box\n      sx={{\n        minHeight: \"100dvh\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        position: \"relative\",\n        pb: isMobile ? 20 : 10,\n        pt: isMobile ? 4 : 0,\n      }}\n    >\n      {isMobile ? (\n        <BigdataLogoWhite width={160} data-testid=\"create-chat-logo\" />\n      ) : (\n        <Box sx={{ pb: 8 }}>\n          <BigdataIconBlack width={60} height={60} data-testid=\"create-chat-logo\" />\n        </Box>\n      )}\n\n      {isMobile && (\n        <MobileArrowForwardButton label={label} to={promptRoute} sx={{ mt: 4, mb: 1.5 }} />\n      )}\n      {!isMobile && (\n        <Box sx={{ width: \"100%\" }}>\n          <Box\n            component={Link}\n            to={promptRoute}\n            sx={{\n              width: \"auto\",\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: 0.5,\n              textDecoration: \"none\",\n              mb: 1.5,\n              \"& p\": {\n                color: \"text.primary\",\n                fontSize: 20,\n                fontWeight: 700,\n              },\n              \"& svg\": {\n                color: \"text.primary\",\n                fontSize: 16,\n                fontWeight: 700,\n              },\n              \"&:hover p, &:hover svg\": {\n                color: \"text.secondary\",\n              },\n            }}\n          >\n            <Typography>{label}</Typography>\n            <ArrowForwardIos sx={{ fontSize: 18 }} />\n          </Box>\n        </Box>\n      )}\n\n      {workflows && (\n        <Box\n          sx={{\n            width: \"100%\",\n            backgroundColor: \"inherit\",\n            ml: isMobile ? 0 : -8,\n          }}\n        >\n          <Box\n            sx={{\n              position: \"relative\",\n              flexGrow: 1,\n              overflow: \"hidden\",\n              pr: isMobile ? 0 : 1,\n              width: \"100%\",\n            }}\n          >\n            <ScrollCarousel\n              bgColor={theme.palette.elevation.dp03}\n              onArrowMouseDown={event => event.preventDefault()}\n              sx={{\n                borderRadius: 5,\n                px: isMobile ? 2 : 4,\n                mb: 4,\n                \"& > div\": {\n                  paddingRight: isMobile ? 4 : 0,\n                  gap: 2,\n                },\n              }}\n            >\n              {workflows?.map(workflow => (\n                <FlowCard\n                  key={workflow.id}\n                  index={0}\n                  isFeatured={false}\n                  isMobile={false}\n                  title={workflow.flowName}\n                  type={workflow.typeLabel}\n                  desc={workflow.description}\n                  onClick={() => navigate(WORKFLOW_ID_ROUTE.replace(\":id\", workflow.id))}\n                />\n              ))}\n            </ScrollCarousel>\n          </Box>\n        </Box>\n      )}\n      {isMobile && (\n        <Box sx={{ width: \"100%\" }}>\n          <MobileRecentChats />\n        </Box>\n      )}\n    </Box>\n  )\n}\n\nexport { CreateChat }\n"],"names":["CreateChat","fileContext","currentInteraction","userInitials","scope","watchlistId","isMobile","useDeviceInfo","data","workflows","useWorkflowList","navigate","useNavigate","useEffect","undefined","window","scroll","top","Box","sx","display","flexDirection","justifyContent","mt","filesIds","ChatFileContextDisplay","isChatEmpty","watchlistIds","ChatWatchlistContextDisplay","width","maxWidth","mx","minHeight","UserInput","variant","disableScroll","displayedMessage","userInput","LoadingResponseSkeleton","handleLabel","isPromptFilter","chatDatasets","label","handleRoute","CHAT_ROUTE","SUGGESTED_PROMPTS_ROUTE","SCOPES_QUERY_PARAM","promptRoute","alignItems","position","pb","pt","BigdataLogoWhite","data-testid","BigdataIconBlack","height","MobileArrowForwardButton","to","mb","component","Link","gap","textDecoration","color","fontSize","fontWeight","Typography","ArrowForwardIos","backgroundColor","ml","flexGrow","overflow","pr","ScrollCarousel","bgColor","theme","palette","elevation","dp03","onArrowMouseDown","event","preventDefault","borderRadius","px","paddingRight","map","workflow","FlowCard","index","isFeatured","title","flowName","type","typeLabel","desc","description","onClick","WORKFLOW_ID_ROUTE","replace","id","MobileRecentChats"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAsOSA;;;eAAAA;;;;uBAtOiB;gCACQ;0BAEC;wBACgB;sBACtB;0BAEG;uBACV;qCACmB;uBACX;sBACE;uBACA;wBACuC;wCAChC;6CACK;2BAClB;yCACc;0CACC;mCACP;AAelC,MAAMA,aAAa,CAAC,EAClBC,WAAW,EACXC,kBAAkB,EAClBC,YAAY,EACZC,KAAK,EACLC,WAAW,EACL;IACN,MAAM,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,oBAAa;IAClC,MAAM,EAAEC,MAAMC,SAAS,EAAE,GAAGC,IAAAA,yBAAe;IAC3C,MAAMC,WAAWC,IAAAA,2BAAW;IAE5BC,IAAAA,gBAAS,EAAC;QACR,IAAIX,uBAAuBY,WAAW;YACpCC,OAAOC,MAAM,CAAC;gBAAEC,KAAK;YAAE;QACzB;IACF,GAAG;QAACf;KAAmB;IAEvB,IAAID,eAAeC,oBAAoB;YAiC1BA;QAhCX,qBACE,sBAACgB,SAAG;YACFC,IAAI;gBACFC,SAAS;gBACTC,eAAe;gBACfC,gBAAgBhB,WAAW,QAAQ;gBACnCiB,IAAI;YACN;;gBAECtB,CAAAA,wBAAAA,kCAAAA,YAAauB,QAAQ,kBACpB,qBAACC,8CAAsB;oBAACD,UAAUvB,YAAYuB,QAAQ;oBAAEE,aAAa;qBACnE;gBACHzB,CAAAA,wBAAAA,kCAAAA,YAAa0B,YAAY,kBACxB,qBAACC,wDAA2B;oBAC1BvB,aAAaJ,YAAY0B,YAAY,CAAC,EAAE;oBACxCD,aAAa;qBAEb;gBACHxB,mCACC,sBAACgB,SAAG;oBACFC,IAAI;wBACFU,OAAO;wBACPC,UAAU;wBACVC,IAAI;wBACJC,WAAW;oBACb;;sCAEA,qBAACC,oBAAS;4BACRC,SAAS5B,WAAW,WAAW;4BAC/BH,cAAcA;4BACdgC,aAAa;sCAEZjC,CAAAA,uCAAAA,mBAAmBkC,gBAAgB,cAAnClC,kDAAAA,uCAAuCA,mBAAmBmC,SAAS;;sCAEtE,qBAACC,gDAAuB;;qBAExB;;;IAGV;IAEA,MAAMC,cAAc;QAClB,IAAI9B,WAAW;YACb,OAAO;QACT;QACA,IAAI+B,gBAAgB;YAClB,OAAO,CAAC,YAAY,EAAEC,kBAAY,CAACrC,MAAM,CAACsC,KAAK,CAAC,CAAC;QACnD;QACA,IAAI,CAACtC,SAASC,aAAa;YACzB,OAAO;QACT;QACA,OAAO;IACT;IAEA,MAAMsC,cAAc;QAClB,IAAIlC,WAAW;YACb,OAAOmC,kBAAU;QACnB;QACA,OAAO,CAAC,EAAEC,+BAAuB,CAAC,EAAEL,iBAAiB,CAAC,CAAC,EAAEM,4BAAkB,CAAC,CAAC,EAAE1C,MAAM,CAAC,GAAG,GAAG,CAAC;IAC/F;IAEA,MAAMoC,iBAAiBpC,SAASqC,kBAAY,CAACrC,MAAM,CAACoC,cAAc;IAElE,MAAME,QAAQH;IACd,MAAMQ,cAAcJ;IAEpB,qBACE,sBAACzB,SAAG;QACFC,IAAI;YACFa,WAAW;YACXZ,SAAS;YACTC,eAAe;YACfC,gBAAgB;YAChB0B,YAAY;YACZC,UAAU;YACVC,IAAI5C,WAAW,KAAK;YACpB6C,IAAI7C,WAAW,IAAI;QACrB;;YAECA,yBACC,qBAAC8C,wBAAgB;gBAACvB,OAAO;gBAAKwB,eAAY;+BAE1C,qBAACnC,SAAG;gBAACC,IAAI;oBAAE+B,IAAI;gBAAE;0BACf,cAAA,qBAACI,wBAAgB;oBAACzB,OAAO;oBAAI0B,QAAQ;oBAAIF,eAAY;;;YAIxD/C,0BACC,qBAACkD,kDAAwB;gBAACd,OAAOA;gBAAOe,IAAIV;gBAAa5B,IAAI;oBAAEI,IAAI;oBAAGmC,IAAI;gBAAI;;YAE/E,CAACpD,0BACA,qBAACY,SAAG;gBAACC,IAAI;oBAAEU,OAAO;gBAAO;0BACvB,cAAA,sBAACX,SAAG;oBACFyC,WAAWC,oBAAI;oBACfH,IAAIV;oBACJ5B,IAAI;wBACFU,OAAO;wBACPT,SAAS;wBACT4B,YAAY;wBACZa,KAAK;wBACLC,gBAAgB;wBAChBJ,IAAI;wBACJ,OAAO;4BACLK,OAAO;4BACPC,UAAU;4BACVC,YAAY;wBACd;wBACA,SAAS;4BACPF,OAAO;4BACPC,UAAU;4BACVC,YAAY;wBACd;wBACA,0BAA0B;4BACxBF,OAAO;wBACT;oBACF;;sCAEA,qBAACG,gBAAU;sCAAExB;;sCACb,qBAACyB,sBAAe;4BAAChD,IAAI;gCAAE6C,UAAU;4BAAG;;;;;YAKzCvD,2BACC,qBAACS,SAAG;gBACFC,IAAI;oBACFU,OAAO;oBACPuC,iBAAiB;oBACjBC,IAAI/D,WAAW,IAAI,CAAC;gBACtB;0BAEA,cAAA,qBAACY,SAAG;oBACFC,IAAI;wBACF8B,UAAU;wBACVqB,UAAU;wBACVC,UAAU;wBACVC,IAAIlE,WAAW,IAAI;wBACnBuB,OAAO;oBACT;8BAEA,cAAA,qBAAC4C,mCAAc;wBACbC,SAASC,YAAK,CAACC,OAAO,CAACC,SAAS,CAACC,IAAI;wBACrCC,kBAAkBC,CAAAA,QAASA,MAAMC,cAAc;wBAC/C9D,IAAI;4BACF+D,cAAc;4BACdC,IAAI7E,WAAW,IAAI;4BACnBoD,IAAI;4BACJ,WAAW;gCACT0B,cAAc9E,WAAW,IAAI;gCAC7BuD,KAAK;4BACP;wBACF;kCAECpD,sBAAAA,gCAAAA,UAAW4E,GAAG,CAACC,CAAAA,yBACd,qBAACC,6BAAQ;gCAEPC,OAAO;gCACPC,YAAY;gCACZnF,UAAU;gCACVoF,OAAOJ,SAASK,QAAQ;gCACxBC,MAAMN,SAASO,SAAS;gCACxBC,MAAMR,SAASS,WAAW;gCAC1BC,SAAS,IAAMrF,SAASsF,yBAAiB,CAACC,OAAO,CAAC,OAAOZ,SAASa,EAAE;+BAP/Db,SAASa,EAAE;;;;YAc3B7F,0BACC,qBAACY,SAAG;gBAACC,IAAI;oBAAEU,OAAO;gBAAO;0BACvB,cAAA,qBAACuE,oCAAiB;;;;AAK5B"}