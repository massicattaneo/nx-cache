{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/common/providers/src/lib/UploadFilesProvider/fileUploadQueue.ts"],"sourcesContent":["type Props = {\n  batch: number\n}\n\nexport const fileUploadQueue = ({ batch }: Props) => {\n  const stack: Array<() => Promise<void>> = []\n  let running = 0\n\n  const check = async () => {\n    if (running < batch) {\n      const task = stack.shift()\n      if (task) {\n        running++\n        try {\n          await task()\n        } catch (e) {\n          // error\n        } finally {\n          running--\n          check()\n        }\n      }\n    }\n  }\n\n  return {\n    addTask: async (task: () => Promise<void>) => {\n      stack.push(task)\n      check()\n    },\n  }\n}\n"],"names":["fileUploadQueue","batch","stack","running","check","task","shift","e","addTask","push"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAIaA;;;eAAAA;;;AAAN,MAAMA,kBAAkB,CAAC,EAAEC,KAAK,EAAS;IAC9C,MAAMC,QAAoC,EAAE;IAC5C,IAAIC,UAAU;IAEd,MAAMC,QAAQ;QACZ,IAAID,UAAUF,OAAO;YACnB,MAAMI,OAAOH,MAAMI,KAAK;YACxB,IAAID,MAAM;gBACRF;gBACA,IAAI;oBACF,MAAME;gBACR,EAAE,OAAOE,GAAG;gBACV,QAAQ;gBACV,SAAU;oBACRJ;oBACAC;gBACF;YACF;QACF;IACF;IAEA,OAAO;QACLI,SAAS,OAAOH;YACdH,MAAMO,IAAI,CAACJ;YACXD;QACF;IACF;AACF"}