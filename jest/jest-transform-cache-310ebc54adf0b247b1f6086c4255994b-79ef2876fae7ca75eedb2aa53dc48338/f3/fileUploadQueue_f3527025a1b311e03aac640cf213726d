26f4825a1599b458371bbb1cdcd00209
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "fileUploadQueue", {
    enumerable: true,
    get: function() {
        return fileUploadQueue;
    }
});
const fileUploadQueue = ({ batch })=>{
    const stack = [];
    let running = 0;
    const check = async ()=>{
        if (running < batch) {
            const task = stack.shift();
            if (task) {
                running++;
                try {
                    await task();
                } catch (e) {
                // error
                } finally{
                    running--;
                    check();
                }
            }
        }
    };
    return {
        addTask: async (task)=>{
            stack.push(task);
            check();
        }
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvcmVhY3QvY29tbW9uL3Byb3ZpZGVycy9zcmMvbGliL1VwbG9hZEZpbGVzUHJvdmlkZXIvZmlsZVVwbG9hZFF1ZXVlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGUgUHJvcHMgPSB7XG4gIGJhdGNoOiBudW1iZXJcbn1cblxuZXhwb3J0IGNvbnN0IGZpbGVVcGxvYWRRdWV1ZSA9ICh7IGJhdGNoIH06IFByb3BzKSA9PiB7XG4gIGNvbnN0IHN0YWNrOiBBcnJheTwoKSA9PiBQcm9taXNlPHZvaWQ+PiA9IFtdXG4gIGxldCBydW5uaW5nID0gMFxuXG4gIGNvbnN0IGNoZWNrID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmIChydW5uaW5nIDwgYmF0Y2gpIHtcbiAgICAgIGNvbnN0IHRhc2sgPSBzdGFjay5zaGlmdCgpXG4gICAgICBpZiAodGFzaykge1xuICAgICAgICBydW5uaW5nKytcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0YXNrKClcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIGVycm9yXG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgcnVubmluZy0tXG4gICAgICAgICAgY2hlY2soKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGRUYXNrOiBhc3luYyAodGFzazogKCkgPT4gUHJvbWlzZTx2b2lkPikgPT4ge1xuICAgICAgc3RhY2sucHVzaCh0YXNrKVxuICAgICAgY2hlY2soKVxuICAgIH0sXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmaWxlVXBsb2FkUXVldWUiLCJiYXRjaCIsInN0YWNrIiwicnVubmluZyIsImNoZWNrIiwidGFzayIsInNoaWZ0IiwiZSIsImFkZFRhc2siLCJwdXNoIl0sInJhbmdlTWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OyIsIm1hcHBpbmdzIjoiOzs7OytCQUlhQTs7O2VBQUFBOzs7QUFBTixNQUFNQSxrQkFBa0IsQ0FBQyxFQUFFQyxLQUFLLEVBQVM7SUFDOUMsTUFBTUMsUUFBb0MsRUFBRTtJQUM1QyxJQUFJQyxVQUFVO0lBRWQsTUFBTUMsUUFBUTtRQUNaLElBQUlELFVBQVVGLE9BQU87WUFDbkIsTUFBTUksT0FBT0gsTUFBTUksS0FBSztZQUN4QixJQUFJRCxNQUFNO2dCQUNSRjtnQkFDQSxJQUFJO29CQUNGLE1BQU1FO2dCQUNSLEVBQUUsT0FBT0UsR0FBRztnQkFDVixRQUFRO2dCQUNWLFNBQVU7b0JBQ1JKO29CQUNBQztnQkFDRjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLE9BQU87UUFDTEksU0FBUyxPQUFPSDtZQUNkSCxNQUFNTyxJQUFJLENBQUNKO1lBQ1hEO1FBQ0Y7SUFDRjtBQUNGIn0=