{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/watchlists/src/lib/WatchlistDataTabs/utils/columnMapping.ts"],"sourcesContent":["import { ApiCustomColumn } from \"@rp/react/tanstack-api/watchlist\"\nimport { FinanceDataTabs } from \"../../hooks/useWatchlistsFinanceDataTabNavigation\"\nimport { UICustomColumn } from \"../CustomDataView/types\"\nimport { watchlistDataTables } from \"../tables\"\n\n/**\n * Converts API column format to UI column format by looking up display information\n * from the table definitions\n */\nexport function apiColumnToUIColumn(apiColumn: ApiCustomColumn): UICustomColumn | null {\n  try {\n    // Find which table/tab contains this endpoint+columnKey combination\n    for (const [tableName, table] of Object.entries(watchlistDataTables)) {\n      if (tableName === \"custom\" || tableName === \"smartGrid\") continue\n\n      // Check if this table has a column with matching endpoint and primary columnKey\n      const matchingColumn = table.columns.find(columnDef => {\n        if (columnDef.meta?.endpoint !== apiColumn.endpoint) return false\n\n        const columnKeys = columnDef.meta?.columnKeys\n        if (!columnKeys) return false\n\n        // Match using the primary key (first key in the array)\n        const primaryKey = columnKeys[0]?.toString()\n        return primaryKey === apiColumn.columnKey\n      })\n\n      if (matchingColumn) {\n        return {\n          endpoint: apiColumn.endpoint,\n          columnKey: apiColumn.columnKey,\n          displayName: matchingColumn.meta?.menuLabel || apiColumn.columnKey,\n          sourceTab: tableName as FinanceDataTabs,\n        }\n      }\n    }\n\n    // Fallback if no matching column found\n    return {\n      endpoint: apiColumn.endpoint,\n      columnKey: apiColumn.columnKey,\n      displayName: apiColumn.columnKey,\n      sourceTab: \"pricing\" as FinanceDataTabs, // Default fallback\n    }\n  } catch (error) {\n    // Return null if conversion fails\n    return null\n  }\n}\n\n/**\n * Converts UI column format back to API column format\n */\nexport function uiColumnToApiColumn(uiColumn: UICustomColumn): ApiCustomColumn {\n  return {\n    endpoint: uiColumn.endpoint,\n    columnKey: uiColumn.columnKey,\n  } as ApiCustomColumn\n}\n\n/**\n * Converts array of API columns to UI columns, filtering out any that fail conversion\n */\nexport function apiColumnsToUIColumns(apiColumns: Array<ApiCustomColumn>): Array<UICustomColumn> {\n  return apiColumns\n    .map(apiColumnToUIColumn)\n    .filter((column): column is UICustomColumn => column !== null)\n}\n\n/**\n * Converts array of UI columns to API columns\n */\nexport function uiColumnsToApiColumns(uiColumns: Array<UICustomColumn>): Array<ApiCustomColumn> {\n  return uiColumns.map(uiColumnToApiColumn)\n}\n"],"names":["apiColumnToUIColumn","apiColumnsToUIColumns","uiColumnToApiColumn","uiColumnsToApiColumns","apiColumn","tableName","table","Object","entries","watchlistDataTables","matchingColumn","columns","find","columnDef","columnKeys","meta","endpoint","primaryKey","toString","columnKey","displayName","menuLabel","sourceTab","error","uiColumn","apiColumns","map","filter","column","uiColumns"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IASgBA,mBAAmB;eAAnBA;;IAsDAC,qBAAqB;eAArBA;;IAVAC,mBAAmB;eAAnBA;;IAmBAC,qBAAqB;eAArBA;;;wBArEoB;AAM7B,SAASH,oBAAoBI,SAA0B;IAC5D,IAAI;QACF,oEAAoE;QACpE,KAAK,MAAM,CAACC,WAAWC,MAAM,IAAIC,OAAOC,OAAO,CAACC,2BAAmB,EAAG;YACpE,IAAIJ,cAAc,YAAYA,cAAc,aAAa;YAEzD,gFAAgF;YAChF,MAAMK,iBAAiBJ,MAAMK,OAAO,CAACC,IAAI,CAACC,CAAAA;oBACpCA,iBAEeA,kBAIAC;gBANnB,IAAID,EAAAA,kBAAAA,UAAUE,IAAI,cAAdF,sCAAAA,gBAAgBG,QAAQ,MAAKZ,UAAUY,QAAQ,EAAE,OAAO;gBAE5D,MAAMF,cAAaD,mBAAAA,UAAUE,IAAI,cAAdF,uCAAAA,iBAAgBC,UAAU;gBAC7C,IAAI,CAACA,YAAY,OAAO;gBAExB,uDAAuD;gBACvD,MAAMG,cAAaH,eAAAA,UAAU,CAAC,EAAE,cAAbA,mCAAAA,aAAeI,QAAQ;gBAC1C,OAAOD,eAAeb,UAAUe,SAAS;YAC3C;YAEA,IAAIT,gBAAgB;oBAIHA;gBAHf,OAAO;oBACLM,UAAUZ,UAAUY,QAAQ;oBAC5BG,WAAWf,UAAUe,SAAS;oBAC9BC,aAAaV,EAAAA,uBAAAA,eAAeK,IAAI,cAAnBL,2CAAAA,qBAAqBW,SAAS,KAAIjB,UAAUe,SAAS;oBAClEG,WAAWjB;gBACb;YACF;QACF;QAEA,uCAAuC;QACvC,OAAO;YACLW,UAAUZ,UAAUY,QAAQ;YAC5BG,WAAWf,UAAUe,SAAS;YAC9BC,aAAahB,UAAUe,SAAS;YAChCG,WAAW;QACb;IACF,EAAE,OAAOC,OAAO;QACd,kCAAkC;QAClC,OAAO;IACT;AACF;AAKO,SAASrB,oBAAoBsB,QAAwB;IAC1D,OAAO;QACLR,UAAUQ,SAASR,QAAQ;QAC3BG,WAAWK,SAASL,SAAS;IAC/B;AACF;AAKO,SAASlB,sBAAsBwB,UAAkC;IACtE,OAAOA,WACJC,GAAG,CAAC1B,qBACJ2B,MAAM,CAAC,CAACC,SAAqCA,WAAW;AAC7D;AAKO,SAASzB,sBAAsB0B,SAAgC;IACpE,OAAOA,UAAUH,GAAG,CAACxB;AACvB"}