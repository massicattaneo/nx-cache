{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/common/utils/src/lib/design-patterns/Stack.ts"],"sourcesContent":["type Next<T extends Array<unknown>> = (...arg: T) => void\ntype Callback<T extends Array<unknown>, C> = (this: C, next: Next<T>, ...arg: T) => void\ntype Context = Record<string, unknown>\n\nclass Stack<T extends Array<unknown>, C extends Context> {\n  private ctx: C\n  private isRunning: boolean\n  private memo: T\n  private stack: Array<Callback<T, C>>\n\n  constructor(context: C) {\n    this.ctx = context\n    this.isRunning = false\n    this.stack = []\n    this.memo = [] as Array<unknown> as T\n  }\n\n  add(callback: Callback<T, C>) {\n    this.stack.push(callback)\n  }\n\n  run(callback?: Callback<T, C>) {\n    if (callback) this.add(callback)\n    if (!this.isRunning) {\n      return this.execute(...this.memo)\n    }\n    return undefined\n  }\n\n  private execute(...args: T) {\n    const shifted = this.stack.shift()\n    if (shifted) {\n      this.isRunning = true\n      return shifted.call(\n        this.ctx,\n        (...nextArg: T) => {\n          this.isRunning = false\n          this.memo = nextArg\n          this.execute(...nextArg)\n          return nextArg[0]\n        },\n        ...args,\n      )\n    }\n  }\n}\n\nexport { Stack }\nexport type { Next, Callback, Context }\n"],"names":["Stack","add","callback","stack","push","run","isRunning","execute","memo","undefined","args","shifted","shift","call","ctx","nextArg","constructor","context"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BA+CSA;;;eAAAA;;;;;;;;;;;;;;;;AA3CT,MAAMA;IAaJC,IAAIC,QAAwB,EAAE;QAC5B,IAAI,CAACC,KAAK,CAACC,IAAI,CAACF;IAClB;IAEAG,IAAIH,QAAyB,EAAE;QAC7B,IAAIA,UAAU,IAAI,CAACD,GAAG,CAACC;QACvB,IAAI,CAAC,IAAI,CAACI,SAAS,EAAE;YACnB,OAAO,IAAI,CAACC,OAAO,IAAI,IAAI,CAACC,IAAI;QAClC;QACA,OAAOC;IACT;IAEQF,QAAQ,GAAGG,IAAO,EAAE;QAC1B,MAAMC,UAAU,IAAI,CAACR,KAAK,CAACS,KAAK;QAChC,IAAID,SAAS;YACX,IAAI,CAACL,SAAS,GAAG;YACjB,OAAOK,QAAQE,IAAI,CACjB,IAAI,CAACC,GAAG,EACR,CAAC,GAAGC;gBACF,IAAI,CAACT,SAAS,GAAG;gBACjB,IAAI,CAACE,IAAI,GAAGO;gBACZ,IAAI,CAACR,OAAO,IAAIQ;gBAChB,OAAOA,OAAO,CAAC,EAAE;YACnB,MACGL;QAEP;IACF;IAlCAM,YAAYC,OAAU,CAAE;QALxB,uBAAQH,OAAR,KAAA;QACA,uBAAQR,aAAR,KAAA;QACA,uBAAQE,QAAR,KAAA;QACA,uBAAQL,SAAR,KAAA;QAGE,IAAI,CAACW,GAAG,GAAGG;QACX,IAAI,CAACX,SAAS,GAAG;QACjB,IAAI,CAACH,KAAK,GAAG,EAAE;QACf,IAAI,CAACK,IAAI,GAAG,EAAE;IAChB;AA8BF"}