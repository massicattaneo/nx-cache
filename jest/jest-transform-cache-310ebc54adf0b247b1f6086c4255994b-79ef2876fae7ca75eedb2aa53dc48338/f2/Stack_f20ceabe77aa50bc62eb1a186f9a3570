22a6f708194c7187af3ae3eb50fe1230
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "Stack", {
    enumerable: true,
    get: function() {
        return Stack;
    }
});
function _define_property(obj, key, value) {
    if (key in obj) {
        Object.defineProperty(obj, key, {
            value: value,
            enumerable: true,
            configurable: true,
            writable: true
        });
    } else {
        obj[key] = value;
    }
    return obj;
}
class Stack {
    add(callback) {
        this.stack.push(callback);
    }
    run(callback) {
        if (callback) this.add(callback);
        if (!this.isRunning) {
            return this.execute(...this.memo);
        }
        return undefined;
    }
    execute(...args) {
        const shifted = this.stack.shift();
        if (shifted) {
            this.isRunning = true;
            return shifted.call(this.ctx, (...nextArg)=>{
                this.isRunning = false;
                this.memo = nextArg;
                this.execute(...nextArg);
                return nextArg[0];
            }, ...args);
        }
    }
    constructor(context){
        _define_property(this, "ctx", void 0);
        _define_property(this, "isRunning", void 0);
        _define_property(this, "memo", void 0);
        _define_property(this, "stack", void 0);
        this.ctx = context;
        this.isRunning = false;
        this.stack = [];
        this.memo = [];
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvY29tbW9uL3V0aWxzL3NyYy9saWIvZGVzaWduLXBhdHRlcm5zL1N0YWNrLnRzIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGUgTmV4dDxUIGV4dGVuZHMgQXJyYXk8dW5rbm93bj4+ID0gKC4uLmFyZzogVCkgPT4gdm9pZFxudHlwZSBDYWxsYmFjazxUIGV4dGVuZHMgQXJyYXk8dW5rbm93bj4sIEM+ID0gKHRoaXM6IEMsIG5leHQ6IE5leHQ8VD4sIC4uLmFyZzogVCkgPT4gdm9pZFxudHlwZSBDb250ZXh0ID0gUmVjb3JkPHN0cmluZywgdW5rbm93bj5cblxuY2xhc3MgU3RhY2s8VCBleHRlbmRzIEFycmF5PHVua25vd24+LCBDIGV4dGVuZHMgQ29udGV4dD4ge1xuICBwcml2YXRlIGN0eDogQ1xuICBwcml2YXRlIGlzUnVubmluZzogYm9vbGVhblxuICBwcml2YXRlIG1lbW86IFRcbiAgcHJpdmF0ZSBzdGFjazogQXJyYXk8Q2FsbGJhY2s8VCwgQz4+XG5cbiAgY29uc3RydWN0b3IoY29udGV4dDogQykge1xuICAgIHRoaXMuY3R4ID0gY29udGV4dFxuICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2VcbiAgICB0aGlzLnN0YWNrID0gW11cbiAgICB0aGlzLm1lbW8gPSBbXSBhcyBBcnJheTx1bmtub3duPiBhcyBUXG4gIH1cblxuICBhZGQoY2FsbGJhY2s6IENhbGxiYWNrPFQsIEM+KSB7XG4gICAgdGhpcy5zdGFjay5wdXNoKGNhbGxiYWNrKVxuICB9XG5cbiAgcnVuKGNhbGxiYWNrPzogQ2FsbGJhY2s8VCwgQz4pIHtcbiAgICBpZiAoY2FsbGJhY2spIHRoaXMuYWRkKGNhbGxiYWNrKVxuICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgIHJldHVybiB0aGlzLmV4ZWN1dGUoLi4udGhpcy5tZW1vKVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH1cblxuICBwcml2YXRlIGV4ZWN1dGUoLi4uYXJnczogVCkge1xuICAgIGNvbnN0IHNoaWZ0ZWQgPSB0aGlzLnN0YWNrLnNoaWZ0KClcbiAgICBpZiAoc2hpZnRlZCkge1xuICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlXG4gICAgICByZXR1cm4gc2hpZnRlZC5jYWxsKFxuICAgICAgICB0aGlzLmN0eCxcbiAgICAgICAgKC4uLm5leHRBcmc6IFQpID0+IHtcbiAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlXG4gICAgICAgICAgdGhpcy5tZW1vID0gbmV4dEFyZ1xuICAgICAgICAgIHRoaXMuZXhlY3V0ZSguLi5uZXh0QXJnKVxuICAgICAgICAgIHJldHVybiBuZXh0QXJnWzBdXG4gICAgICAgIH0sXG4gICAgICAgIC4uLmFyZ3MsXG4gICAgICApXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB7IFN0YWNrIH1cbmV4cG9ydCB0eXBlIHsgTmV4dCwgQ2FsbGJhY2ssIENvbnRleHQgfVxuIl0sIm5hbWVzIjpbIlN0YWNrIiwiYWRkIiwiY2FsbGJhY2siLCJzdGFjayIsInB1c2giLCJydW4iLCJpc1J1bm5pbmciLCJleGVjdXRlIiwibWVtbyIsInVuZGVmaW5lZCIsImFyZ3MiLCJzaGlmdGVkIiwic2hpZnQiLCJjYWxsIiwiY3R4IiwibmV4dEFyZyIsImNvbnN0cnVjdG9yIiwiY29udGV4dCJdLCJyYW5nZU1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsiLCJtYXBwaW5ncyI6Ijs7OzsrQkErQ1NBOzs7ZUFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUEzQ1QsTUFBTUE7SUFhSkMsSUFBSUMsUUFBd0IsRUFBRTtRQUM1QixJQUFJLENBQUNDLEtBQUssQ0FBQ0MsSUFBSSxDQUFDRjtJQUNsQjtJQUVBRyxJQUFJSCxRQUF5QixFQUFFO1FBQzdCLElBQUlBLFVBQVUsSUFBSSxDQUFDRCxHQUFHLENBQUNDO1FBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUNJLFNBQVMsRUFBRTtZQUNuQixPQUFPLElBQUksQ0FBQ0MsT0FBTyxJQUFJLElBQUksQ0FBQ0MsSUFBSTtRQUNsQztRQUNBLE9BQU9DO0lBQ1Q7SUFFUUYsUUFBUSxHQUFHRyxJQUFPLEVBQUU7UUFDMUIsTUFBTUMsVUFBVSxJQUFJLENBQUNSLEtBQUssQ0FBQ1MsS0FBSztRQUNoQyxJQUFJRCxTQUFTO1lBQ1gsSUFBSSxDQUFDTCxTQUFTLEdBQUc7WUFDakIsT0FBT0ssUUFBUUUsSUFBSSxDQUNqQixJQUFJLENBQUNDLEdBQUcsRUFDUixDQUFDLEdBQUdDO2dCQUNGLElBQUksQ0FBQ1QsU0FBUyxHQUFHO2dCQUNqQixJQUFJLENBQUNFLElBQUksR0FBR087Z0JBQ1osSUFBSSxDQUFDUixPQUFPLElBQUlRO2dCQUNoQixPQUFPQSxPQUFPLENBQUMsRUFBRTtZQUNuQixNQUNHTDtRQUVQO0lBQ0Y7SUFsQ0FNLFlBQVlDLE9BQVUsQ0FBRTtRQUx4Qix1QkFBUUgsT0FBUixLQUFBO1FBQ0EsdUJBQVFSLGFBQVIsS0FBQTtRQUNBLHVCQUFRRSxRQUFSLEtBQUE7UUFDQSx1QkFBUUwsU0FBUixLQUFBO1FBR0UsSUFBSSxDQUFDVyxHQUFHLEdBQUdHO1FBQ1gsSUFBSSxDQUFDWCxTQUFTLEdBQUc7UUFDakIsSUFBSSxDQUFDSCxLQUFLLEdBQUcsRUFBRTtRQUNmLElBQUksQ0FBQ0ssSUFBSSxHQUFHLEVBQUU7SUFDaEI7QUE4QkYifQ==