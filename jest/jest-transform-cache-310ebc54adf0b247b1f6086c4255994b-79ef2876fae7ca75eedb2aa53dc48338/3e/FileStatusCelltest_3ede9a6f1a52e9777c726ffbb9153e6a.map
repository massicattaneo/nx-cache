{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/components/Hub/Files/FileStatusCell/FileStatusCell.test.tsx"],"sourcesContent":["import { FileRowType } from \"@rp/common/utils\"\nimport { renderWithProviders } from \"@rp/react/web/common/tools\"\nimport { Actions } from \"@rp/react/web/common/types\"\nimport { fireEvent, waitFor } from \"@testing-library/react\"\nimport { FileStatusCellProps } from \"./FileRowComponents.types\"\nimport { FileStatusCell } from \"./FileStatusCell\"\n\nconst handleDownload = jest.fn()\nconst handleEdit = jest.fn()\nconst handleDelete = jest.fn()\nconst actions: Actions = [\n  {\n    id: \"download\",\n    label: \"Download\",\n    icon: null,\n    onClick: () => {},\n    nestedActions: [\n      { id: \"original\", label: \"Original\", onClick: () => handleDownload(1), icon: null },\n      { id: \"csv-analytics\", label: \"CSV Analytics\", onClick: () => handleDownload(2), icon: null },\n      {\n        id: \"json-analytics\",\n        label: \"JSON Analytics\",\n        onClick: () => handleDownload(3),\n        icon: null,\n      },\n      { id: \"annotations\", label: \"Annotations\", onClick: () => handleDownload(4), icon: null },\n      { id: \"text-extract\", label: \"Text Extract\", onClick: () => handleDownload(5), icon: null },\n    ],\n  },\n  { id: \"rename\", label: \"Rename\", icon: null, onClick: handleEdit },\n  {\n    id: \"delete\",\n    label: \"Delete\",\n    icon: null,\n    onClick: handleDelete,\n  },\n]\n\nconst Table = (props: FileStatusCellProps) => (\n  <div>\n    <FileStatusCell {...props} />\n  </div>\n)\n\nconst getItem = (props: Partial<FileRowType> = {}): FileRowType => ({\n  id: \"1\",\n  name: \"\",\n  type: \"\",\n  status: \"completed\",\n  size: 0,\n  date: \"\",\n  sharedWith: null,\n  owner: \"\",\n  ...props,\n})\n\ndescribe(\"FileStatusCell\", () => {\n  test(\"check action menu appears and calls the function\", () => {\n    const handleOpenMenu = jest.fn()\n\n    const { getByRole } = renderWithProviders(\n      <Table\n        item={getItem()}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={handleOpenMenu}\n        onDelete={handleDelete}\n      />,\n    )\n    const menu = getByRole(\"button\", { name: \"More actions\" })\n    expect(menu).toBeInTheDocument()\n\n    fireEvent.click(menu)\n    expect(handleOpenMenu).toBeCalledWith(true)\n  })\n\n  test(\"check buttons in COMPLETE cell hovered\", () => {\n    const testID = \"testId\"\n    // for some reason the test logs a console.error message\n    jest.spyOn(console, \"error\").mockImplementation()\n\n    const { getByRole } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={true}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n\n    const downloadOption = getByRole(\"menuitem\", { name: \"Download\" })\n    const rename = getByRole(\"menuitem\", { name: \"Rename\" })\n    const deleteOption = getByRole(\"menuitem\", { name: \"Delete\" })\n\n    fireEvent.click(rename)\n    expect(handleEdit).toHaveBeenCalledWith(getItem({ id: testID }))\n    fireEvent.click(deleteOption)\n    expect(handleDelete).toHaveBeenCalledTimes(1)\n    fireEvent.mouseOver(downloadOption)\n    waitFor(() => {\n      expect(getByRole(\"menuitem\", { name: \"Original\" })).toBeInTheDocument()\n    })\n\n    fireEvent.click(getByRole(\"menuitem\", { name: \"Original\" }))\n    fireEvent.click(getByRole(\"menuitem\", { name: \"CSV Analytics\" }))\n    fireEvent.click(getByRole(\"menuitem\", { name: \"JSON Analytics\" }))\n    fireEvent.click(getByRole(\"menuitem\", { name: \"Annotations\" }))\n    fireEvent.click(getByRole(\"menuitem\", { name: \"Text Extract\" }))\n\n    expect(handleDownload).toHaveBeenCalledTimes(5)\n    expect(handleDownload).toHaveBeenCalledWith(1)\n    expect(handleDownload).toHaveBeenCalledWith(2)\n    expect(handleDownload).toHaveBeenCalledWith(3)\n    expect(handleDownload).toHaveBeenCalledWith(4)\n    expect(handleDownload).toHaveBeenCalledWith(5)\n  })\n\n  test(\"check progress bar\", () => {\n    const progressTest = 50\n    const testID = \"testId\"\n    const { getByText } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID, status: \"progress\", progress: progressTest })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n    const progressBar = getByText(`${progressTest}%`)\n    expect(progressBar).toBeDefined()\n  })\n  test(\"check pending state\", () => {\n    const testID = \"testId\"\n    const { getByText } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID, status: \"pending\" })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n    const pendingCell = getByText(/pending/i)\n    expect(pendingCell).toBeDefined()\n  })\n  test(\"check done state\", () => {\n    const testID = \"testId\"\n    const { getByText } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID, status: \"done\" })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n    const doneCell = getByText(/done/i)\n    expect(doneCell).toBeDefined()\n  })\n  test(\"check analyzing state\", () => {\n    const testID = \"testId\"\n    const { getByText } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID, status: \"analyzing\" })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n    const analyzingCell = getByText(/analyzing/i)\n    expect(analyzingCell).toBeDefined()\n  })\n  test(\"check error state\", () => {\n    const testID = \"testId\"\n    const { getByTestId } = renderWithProviders(\n      <Table\n        item={getItem({ id: testID, status: \"error\" })}\n        actions={actions}\n        rowIsHovered={false}\n        isOpenMenu={false}\n        setIsOpenMenu={jest.fn()}\n        onDelete={handleDelete}\n      />,\n    )\n    const errorIcon = getByTestId(\"ReportProblemIcon\")\n    expect(errorIcon).toBeDefined()\n  })\n})\n"],"names":["handleDownload","jest","fn","handleEdit","handleDelete","actions","id","label","icon","onClick","nestedActions","Table","props","div","FileStatusCell","getItem","name","type","status","size","date","sharedWith","owner","describe","test","handleOpenMenu","getByRole","renderWithProviders","item","rowIsHovered","isOpenMenu","setIsOpenMenu","onDelete","menu","expect","toBeInTheDocument","fireEvent","click","toBeCalledWith","testID","spyOn","console","mockImplementation","downloadOption","rename","deleteOption","toHaveBeenCalledWith","toHaveBeenCalledTimes","mouseOver","waitFor","progressTest","getByText","progress","progressBar","toBeDefined","pendingCell","doneCell","analyzingCell","getByTestId","errorIcon"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}