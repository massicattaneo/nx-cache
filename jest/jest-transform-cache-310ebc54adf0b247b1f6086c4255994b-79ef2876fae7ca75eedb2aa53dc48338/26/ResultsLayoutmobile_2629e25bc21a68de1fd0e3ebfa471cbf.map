{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/pages/Results/ResultsLayout.mobile.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { CqsItem, CqsSavedStatus } from \"@rp/common/api-types\"\nimport { Watchlist } from \"@rp/common/api-types\"\nimport { RpqlFilter } from \"@rp/common/api-types\"\nimport { getExpressionIds } from \"@rp/react/tanstack-api/user-data-queries\"\nimport { HideOnScroll } from \"@rp/react/web/common/base-components\"\nimport {\n  HandleOpenModalProps,\n  MOBILE_PAGE_B_PADDING,\n} from \"@rp/react/web/common/composite-components\"\nimport { useHashParams } from \"@rp/react/web/common/hooks\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { FollowMobileHeader } from \"@rp/react/web/common/layout\"\nimport { useQueryContext } from \"@rp/react/web/common/providers\"\nimport { StoryCardResults } from \"@rp/react/web/common/results-story-card\"\nimport { AutoCompleteMobile } from \"@rp/react/web/common/search-autosuggest-input\"\nimport { CqsQueryBar } from \"@rp/react/web/cqs-query-bar\"\nimport { DocumentViewerPage } from \"@rp/react/web/document-viewer\"\nimport { Grid } from \"@rp/react/web/mui/core\"\nimport { useHandleCqsChange } from \"../../hooks/useHandleCqsChange\"\nimport { HomeHeaderMobile } from \"../Home/HomeHeader.mobile\"\n\ntype Props = {\n  handleOnChange: (item: CqsItem) => void\n  handleOnExclude: (item: CqsItem) => void\n  expression: RpqlFilter | undefined\n  name?: string\n  saveStatus?: CqsSavedStatus\n  onAddToWatchlist?: (watchlist: Watchlist) => void\n  onHandleOpenModal: HandleOpenModalProps\n  editable: boolean | undefined\n  isPublic?: boolean\n}\n\nconst ResultsLayoutMobile = ({\n  handleOnChange,\n  handleOnExclude,\n  expression,\n  name,\n  saveStatus,\n  onAddToWatchlist,\n  isPublic,\n  onHandleOpenModal,\n  editable = false,\n}: Props) => {\n  const [{ document }] = useHashParams()\n  const handleChangeQuery = useHandleCqsChange()\n  const { queryBar, savedQuery } = useQueryContext()\n  const [isOpen, setIsOpen] = useState(false)\n  const { isIOS } = useDeviceInfo()\n\n  const isSaved = saveStatus === \"saved\"\n  const title = isSaved ? name : \"Untitled Search\"\n  const selectedItems: Array<string> = expression\n    ? getExpressionIds(expression, { format: \"suggestionId\", includeMacros: true })\n    : []\n\n  return (\n    <>\n      {document ? (\n        <HomeHeaderMobile showSuggestionBar isOpenDocument />\n      ) : (\n        <HideOnScroll>\n          <FollowMobileHeader\n            name={title}\n            isPublic={isPublic}\n            savedQuery={savedQuery}\n            editable={editable}\n          />\n          <CqsQueryBar\n            searchActions={{ setIsOpen }}\n            query={queryBar}\n            onHandleOpenModal={onHandleOpenModal}\n          />\n        </HideOnScroll>\n      )}\n\n      <DocumentViewerPage\n        backTitle=\"Back to Results\"\n        expression={expression}\n        onChange={handleOnChange}\n        onExclude={handleOnExclude}\n        rpjsonHeaderOffset={0}\n        contentContainerProps={{\n          disableGutters: true,\n        }}\n      >\n        <Grid container pb={MOBILE_PAGE_B_PADDING}>\n          <Grid item xs={12}>\n            <StoryCardResults key={savedQuery.query.scope} onAddToWatchlist={onAddToWatchlist} />\n          </Grid>\n        </Grid>\n      </DocumentViewerPage>\n      <AutoCompleteMobile\n        onClose={() => {\n          /**\n           * HACK for IOS browser\n           * we should find a proper way of fixing this defect\n           * https://ravenpack.atlassian.net/browse/RPX-2159\n           */\n          if (isIOS) {\n            setTimeout(() => window.scrollTo({ top: 0 }))\n          }\n        }}\n        excludeQueryTypes={[\"savedSearch\"]}\n        selectedItems={selectedItems}\n        onChange={handleChangeQuery}\n        searchActions={{ isOpen, setIsOpen }}\n      />\n    </>\n  )\n}\n\nexport { ResultsLayoutMobile }\n"],"names":["ResultsLayoutMobile","handleOnChange","handleOnExclude","expression","name","saveStatus","onAddToWatchlist","isPublic","onHandleOpenModal","editable","document","useHashParams","handleChangeQuery","useHandleCqsChange","queryBar","savedQuery","useQueryContext","isOpen","setIsOpen","useState","isIOS","useDeviceInfo","isSaved","title","selectedItems","getExpressionIds","format","includeMacros","HomeHeaderMobile","showSuggestionBar","isOpenDocument","HideOnScroll","FollowMobileHeader","CqsQueryBar","searchActions","query","DocumentViewerPage","backTitle","onChange","onExclude","rpjsonHeaderOffset","contentContainerProps","disableGutters","Grid","container","pb","MOBILE_PAGE_B_PADDING","item","xs","StoryCardResults","scope","AutoCompleteMobile","onClose","setTimeout","window","scrollTo","top","excludeQueryTypes"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAiHSA;;;eAAAA;;;;uBAjHgB;iCAIQ;gCACJ;qCAItB;uBACuB;wBAEK;2BACH;kCACC;wCACE;6BACP;gCACO;sBACd;oCACc;kCACF;AAcjC,MAAMA,sBAAsB,CAAC,EAC3BC,cAAc,EACdC,eAAe,EACfC,UAAU,EACVC,IAAI,EACJC,UAAU,EACVC,gBAAgB,EAChBC,QAAQ,EACRC,iBAAiB,EACjBC,WAAW,KAAK,EACV;IACN,MAAM,CAAC,EAAEC,QAAQ,EAAE,CAAC,GAAGC,IAAAA,oBAAa;IACpC,MAAMC,oBAAoBC,IAAAA,sCAAkB;IAC5C,MAAM,EAAEC,QAAQ,EAAEC,UAAU,EAAE,GAAGC,IAAAA,0BAAe;IAChD,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAC;IACrC,MAAM,EAAEC,KAAK,EAAE,GAAGC,IAAAA,oBAAa;IAE/B,MAAMC,UAAUjB,eAAe;IAC/B,MAAMkB,QAAQD,UAAUlB,OAAO;IAC/B,MAAMoB,gBAA+BrB,aACjCsB,IAAAA,iCAAgB,EAACtB,YAAY;QAAEuB,QAAQ;QAAgBC,eAAe;IAAK,KAC3E,EAAE;IAEN,qBACE;;YACGjB,yBACC,qBAACkB,kCAAgB;gBAACC,iBAAiB;gBAACC,cAAc;+BAElD,sBAACC,4BAAY;;kCACX,qBAACC,0BAAkB;wBACjB5B,MAAMmB;wBACNhB,UAAUA;wBACVQ,YAAYA;wBACZN,UAAUA;;kCAEZ,qBAACwB,wBAAW;wBACVC,eAAe;4BAAEhB;wBAAU;wBAC3BiB,OAAOrB;wBACPN,mBAAmBA;;;;0BAKzB,qBAAC4B,kCAAkB;gBACjBC,WAAU;gBACVlC,YAAYA;gBACZmC,UAAUrC;gBACVsC,WAAWrC;gBACXsC,oBAAoB;gBACpBC,uBAAuB;oBACrBC,gBAAgB;gBAClB;0BAEA,cAAA,qBAACC,UAAI;oBAACC,SAAS;oBAACC,IAAIC,0CAAqB;8BACvC,cAAA,qBAACH,UAAI;wBAACI,IAAI;wBAACC,IAAI;kCACb,cAAA,qBAACC,kCAAgB;4BAA8B3C,kBAAkBA;2BAA1CS,WAAWoB,KAAK,CAACe,KAAK;;;;0BAInD,qBAACC,0CAAkB;gBACjBC,SAAS;oBACP;;;;WAIC,GACD,IAAIhC,OAAO;wBACTiC,WAAW,IAAMC,OAAOC,QAAQ,CAAC;gCAAEC,KAAK;4BAAE;oBAC5C;gBACF;gBACAC,mBAAmB;oBAAC;iBAAc;gBAClCjC,eAAeA;gBACfc,UAAU1B;gBACVsB,eAAe;oBAAEjB;oBAAQC;gBAAU;;;;AAI3C"}