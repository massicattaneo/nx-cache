{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/document-viewer/src/lib/DocumentImage.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\nimport { useDocumentsImages } from \"@rp/react/tanstack-api/document-images\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { Box, Link, Skeleton } from \"@rp/react/web/mui/core\"\n\ntype Props = {\n  documentId: string\n  externalContentUrl?: string\n  onClick?: () => void\n}\n\nconst DocumentImage = ({ documentId, externalContentUrl, onClick }: Props) => {\n  const { isMobile } = useDeviceInfo()\n  const { data, isLoading } = useDocumentsImages([documentId])\n  const imgRef = useRef<HTMLImageElement | null>(null)\n  const [isLoaded, setIsLoaded] = useState<boolean>(false)\n  const [hasImage, setHasImage] = useState<boolean>(false)\n\n  const imageUrl = data[documentId]?.[0]?.replace(\"http://\", \"https://\") ?? undefined\n\n  useEffect(() => {\n    if (!isLoading && imageUrl && imgRef.current) {\n      imgRef.current.onload = () => {\n        setHasImage(true)\n        setIsLoaded(true)\n      }\n      imgRef.current.onerror = () => setIsLoaded(true)\n      imgRef.current.src = imageUrl\n    } else if (!isLoading && !imageUrl) {\n      setIsLoaded(true)\n      setHasImage(false)\n    }\n  }, [imageUrl, isLoading])\n\n  const height = isMobile ? \"200px\" : \"350px\"\n\n  return !isLoaded || hasImage ? (\n    <Box\n      sx={{\n        overflow: \"hidden\",\n        width: \"100%\",\n        height,\n        mb: 2,\n        \"& img\": {\n          borderRadius: \"6px\",\n          width: \"100%\",\n          height,\n          objectFit: \"cover\",\n        },\n      }}\n    >\n      {!hasImage ? <Skeleton height={height} sx={{ transform: \"initial\" }} /> : null}\n      {externalContentUrl ? (\n        <Link\n          sx={{ display: hasImage ? \"initial\" : \"none\" }}\n          href={externalContentUrl}\n          color=\"primary\"\n          target=\"_blank\"\n          underline=\"hover\"\n          rel=\"noopener\"\n          onClick={onClick}\n        >\n          <img ref={imgRef} src={imageUrl} alt={\"\"} />\n        </Link>\n      ) : (\n        <img\n          ref={imgRef}\n          src={imageUrl}\n          alt={\"\"}\n          style={{ display: hasImage ? \"initial\" : \"none\" }}\n        />\n      )}\n    </Box>\n  ) : null\n}\n\nexport { DocumentImage }\n"],"names":["DocumentImage","documentId","externalContentUrl","onClick","data","isMobile","useDeviceInfo","isLoading","useDocumentsImages","imgRef","useRef","isLoaded","setIsLoaded","useState","hasImage","setHasImage","imageUrl","replace","undefined","useEffect","current","onload","onerror","src","height","Box","sx","overflow","width","mb","borderRadius","objectFit","Skeleton","transform","Link","display","href","color","target","underline","rel","img","ref","alt","style"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BA4ESA;;;eAAAA;;;;uBA5EmC;gCACT;uBACL;sBACM;AAQpC,MAAMA,gBAAgB,CAAC,EAAEC,UAAU,EAAEC,kBAAkB,EAAEC,OAAO,EAAS;QAOtDC,mBAAAA;IANjB,MAAM,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,oBAAa;IAClC,MAAM,EAAEF,IAAI,EAAEG,SAAS,EAAE,GAAGC,IAAAA,kCAAkB,EAAC;QAACP;KAAW;IAC3D,MAAMQ,SAASC,IAAAA,aAAM,EAA0B;IAC/C,MAAM,CAACC,UAAUC,YAAY,GAAGC,IAAAA,eAAQ,EAAU;IAClD,MAAM,CAACC,UAAUC,YAAY,GAAGF,IAAAA,eAAQ,EAAU;QAEjCT;IAAjB,MAAMY,WAAWZ,CAAAA,6BAAAA,mBAAAA,IAAI,CAACH,WAAW,cAAhBG,wCAAAA,oBAAAA,gBAAkB,CAAC,EAAE,cAArBA,wCAAAA,kBAAuBa,OAAO,CAAC,WAAW,yBAA1Cb,uCAAAA,4BAAyDc;IAE1EC,IAAAA,gBAAS,EAAC;QACR,IAAI,CAACZ,aAAaS,YAAYP,OAAOW,OAAO,EAAE;YAC5CX,OAAOW,OAAO,CAACC,MAAM,GAAG;gBACtBN,YAAY;gBACZH,YAAY;YACd;YACAH,OAAOW,OAAO,CAACE,OAAO,GAAG,IAAMV,YAAY;YAC3CH,OAAOW,OAAO,CAACG,GAAG,GAAGP;QACvB,OAAO,IAAI,CAACT,aAAa,CAACS,UAAU;YAClCJ,YAAY;YACZG,YAAY;QACd;IACF,GAAG;QAACC;QAAUT;KAAU;IAExB,MAAMiB,SAASnB,WAAW,UAAU;IAEpC,OAAO,CAACM,YAAYG,yBAClB,sBAACW,SAAG;QACFC,IAAI;YACFC,UAAU;YACVC,OAAO;YACPJ;YACAK,IAAI;YACJ,SAAS;gBACPC,cAAc;gBACdF,OAAO;gBACPJ;gBACAO,WAAW;YACb;QACF;;YAEC,CAACjB,yBAAW,qBAACkB,cAAQ;gBAACR,QAAQA;gBAAQE,IAAI;oBAAEO,WAAW;gBAAU;iBAAQ;YACzE/B,mCACC,qBAACgC,UAAI;gBACHR,IAAI;oBAAES,SAASrB,WAAW,YAAY;gBAAO;gBAC7CsB,MAAMlC;gBACNmC,OAAM;gBACNC,QAAO;gBACPC,WAAU;gBACVC,KAAI;gBACJrC,SAASA;0BAET,cAAA,qBAACsC;oBAAIC,KAAKjC;oBAAQc,KAAKP;oBAAU2B,KAAK;;+BAGxC,qBAACF;gBACCC,KAAKjC;gBACLc,KAAKP;gBACL2B,KAAK;gBACLC,OAAO;oBAAET,SAASrB,WAAW,YAAY;gBAAO;;;SAIpD;AACN"}