{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/atoms/feature-flags.ts"],"sourcesContent":["import { useAtom } from \"jotai\"\nimport { atomFamily, atomWithStorage } from \"jotai/utils\"\nimport { useUser } from \"@clerk/clerk-react\"\nimport { environment } from \"@rp/common/environment\"\nimport { FeaturesFlags } from \"@rp/common/environment/types\"\n\nconst featureFlagsFamily = atomFamily((name: FeaturesFlags) =>\n  atomWithStorage<boolean>(name, environment.flags[name]),\n)\n\nconst useFeatureAtom = (name: FeaturesFlags) => {\n  // This allows us to give users early access to features\n  // without having to deploy a new version of the app\n  const user = useUser()\n  const earlyAccess = user.user?.publicMetadata?.earlyAccess ?? []\n  const atomResult = useAtom(featureFlagsFamily(name))\n  const overRideValue = earlyAccess.includes(name)\n  if (overRideValue) {\n    const isSet = localStorage.getItem(name)\n    if (isSet === null) localStorage.setItem(name, \"true\")\n  }\n\n  return overRideValue ? ([overRideValue, atomResult[1]] as const) : atomResult\n}\n\nexport { useFeatureAtom }\n"],"names":["useFeatureAtom","featureFlagsFamily","atomFamily","name","atomWithStorage","environment","flags","user","useUser","earlyAccess","publicMetadata","atomResult","useAtom","overRideValue","includes","isSet","localStorage","getItem","setItem"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAyBSA;;;eAAAA;;;uBAzBe;uBACoB;4BACpB;6BACI;AAG5B,MAAMC,qBAAqBC,IAAAA,iBAAU,EAAC,CAACC,OACrCC,IAAAA,sBAAe,EAAUD,MAAME,wBAAW,CAACC,KAAK,CAACH,KAAK;AAGxD,MAAMH,iBAAiB,CAACG;QAIFI,2BAAAA;IAHpB,wDAAwD;IACxD,oDAAoD;IACpD,MAAMA,OAAOC,IAAAA,mBAAO;QACAD;IAApB,MAAME,cAAcF,CAAAA,yCAAAA,aAAAA,KAAKA,IAAI,cAATA,kCAAAA,4BAAAA,WAAWG,cAAc,cAAzBH,gDAAAA,0BAA2BE,WAAW,cAAtCF,mDAAAA,wCAA0C,EAAE;IAChE,MAAMI,aAAaC,IAAAA,cAAO,EAACX,mBAAmBE;IAC9C,MAAMU,gBAAgBJ,YAAYK,QAAQ,CAACX;IAC3C,IAAIU,eAAe;QACjB,MAAME,QAAQC,aAAaC,OAAO,CAACd;QACnC,IAAIY,UAAU,MAAMC,aAAaE,OAAO,CAACf,MAAM;IACjD;IAEA,OAAOU,gBAAiB;QAACA;QAAeF,UAAU,CAAC,EAAE;KAAC,GAAaA;AACrE"}