{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/common/hooks/src/lib/useChatFeedbackData/useChatFeedbackData.helpers.ts"],"sourcesContent":["import { ChatFeedbackData } from \"../useChat/useChat.types\"\nimport { chatFeedbackDataMaster } from \"./useChatFeedbackData.data\"\nimport { ChatFeedbackSubtagData } from \"./useChatFeedbackData.types\"\n\ntype GenerateChatFeedbackTagsReturn = {\n  subtags: Array<ChatFeedbackSubtagData>\n  tags: Array<string>\n}\n\nexport const structuredDataAgents = [\n  \"job-analytics\",\n  \"sentiment-attention\",\n  \"price\",\n  \"estimates\",\n  \"crunchbase\",\n  \"knowledge-graph\",\n  \"etf-holdings\",\n]\n\nconst positiveTagsList = chatFeedbackDataMaster.positive.reduce<Array<string>>((acc, tagData) => {\n  acc.push(tagData.title)\n  return acc\n}, [])\n\nconst negativeTagsList = chatFeedbackDataMaster.negative.reduce<Array<string>>((acc, tagData) => {\n  acc.push(tagData.title)\n  return acc\n}, [])\n\nconst getIsFromStructuredDataAgent = (chatFeedbackData: ChatFeedbackData | undefined): boolean => {\n  if (!chatFeedbackData) return false\n\n  const { interaction } = chatFeedbackData\n\n  if (!interaction) return false\n\n  if (!(\"scope\" in interaction && interaction.scope)) return false\n\n  return structuredDataAgents.includes(interaction.scope)\n}\n\nconst generateChatFeedbackTags = (\n  chatFeedbackData: ChatFeedbackData | undefined,\n  feedbackTags: Array<string>,\n): GenerateChatFeedbackTagsReturn => {\n  const emptySubtagsData: Array<ChatFeedbackSubtagData> = []\n  const isPositive = (chatFeedbackData?.feedbackSentiment ?? 0) >= 0\n\n  const isFromStructuredDataAgent = getIsFromStructuredDataAgent(chatFeedbackData)\n\n  if (isPositive) {\n    return { tags: positiveTagsList, subtags: emptySubtagsData }\n  }\n\n  if (!isFromStructuredDataAgent) {\n    return { tags: negativeTagsList, subtags: emptySubtagsData }\n  }\n\n  const localSubtagsData: Array<ChatFeedbackSubtagData> = chatFeedbackDataMaster.negative.reduce(\n    (acc, chatFeedbackDatum) => {\n      if (feedbackTags.includes(chatFeedbackDatum.title) && chatFeedbackDatum.subtagsData) {\n        acc.push(chatFeedbackDatum.subtagsData)\n      }\n\n      return acc\n    },\n    emptySubtagsData,\n  )\n\n  return { tags: negativeTagsList, subtags: localSubtagsData }\n}\n\nconst getChatFeedbackSubmitTags = (feedbackTags: Array<string>): Array<string> => {\n  const subtagsDenyList: Array<string> = []\n\n  chatFeedbackDataMaster.negative.forEach(chatFeedbackDatum => {\n    if (!feedbackTags.includes(chatFeedbackDatum.title) && chatFeedbackDatum.subtagsData) {\n      subtagsDenyList.push(...chatFeedbackDatum.subtagsData.subtags)\n    }\n  })\n\n  const scrubbedSubtags = feedbackTags.filter(tag => !subtagsDenyList.includes(tag))\n\n  return scrubbedSubtags\n}\n\nexport { generateChatFeedbackTags, getChatFeedbackSubmitTags, getIsFromStructuredDataAgent }\n"],"names":["generateChatFeedbackTags","getChatFeedbackSubmitTags","getIsFromStructuredDataAgent","structuredDataAgents","positiveTagsList","chatFeedbackDataMaster","positive","reduce","acc","tagData","push","title","negativeTagsList","negative","chatFeedbackData","interaction","scope","includes","feedbackTags","emptySubtagsData","isPositive","feedbackSentiment","isFromStructuredDataAgent","tags","subtags","localSubtagsData","chatFeedbackDatum","subtagsData","subtagsDenyList","forEach","scrubbedSubtags","filter","tag"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IAsFSA,wBAAwB;eAAxBA;;IAA0BC,yBAAyB;eAAzBA;;IAA2BC,4BAA4B;eAA5BA;;IA7EjDC,oBAAoB;eAApBA;;;yCAR0B;AAQhC,MAAMA,uBAAuB;IAClC;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAMC,mBAAmBC,+CAAsB,CAACC,QAAQ,CAACC,MAAM,CAAgB,CAACC,KAAKC;IACnFD,IAAIE,IAAI,CAACD,QAAQE,KAAK;IACtB,OAAOH;AACT,GAAG,EAAE;AAEL,MAAMI,mBAAmBP,+CAAsB,CAACQ,QAAQ,CAACN,MAAM,CAAgB,CAACC,KAAKC;IACnFD,IAAIE,IAAI,CAACD,QAAQE,KAAK;IACtB,OAAOH;AACT,GAAG,EAAE;AAEL,MAAMN,+BAA+B,CAACY;IACpC,IAAI,CAACA,kBAAkB,OAAO;IAE9B,MAAM,EAAEC,WAAW,EAAE,GAAGD;IAExB,IAAI,CAACC,aAAa,OAAO;IAEzB,IAAI,CAAE,CAAA,WAAWA,eAAeA,YAAYC,KAAK,AAAD,GAAI,OAAO;IAE3D,OAAOb,qBAAqBc,QAAQ,CAACF,YAAYC,KAAK;AACxD;AAEA,MAAMhB,2BAA2B,CAC/Bc,kBACAI;IAEA,MAAMC,mBAAkD,EAAE;QACtCL;IAApB,MAAMM,aAAa,AAACN,CAAAA,CAAAA,sCAAAA,6BAAAA,uCAAAA,iBAAkBO,iBAAiB,cAAnCP,iDAAAA,sCAAuC,CAAA,KAAM;IAEjE,MAAMQ,4BAA4BpB,6BAA6BY;IAE/D,IAAIM,YAAY;QACd,OAAO;YAAEG,MAAMnB;YAAkBoB,SAASL;QAAiB;IAC7D;IAEA,IAAI,CAACG,2BAA2B;QAC9B,OAAO;YAAEC,MAAMX;YAAkBY,SAASL;QAAiB;IAC7D;IAEA,MAAMM,mBAAkDpB,+CAAsB,CAACQ,QAAQ,CAACN,MAAM,CAC5F,CAACC,KAAKkB;QACJ,IAAIR,aAAaD,QAAQ,CAACS,kBAAkBf,KAAK,KAAKe,kBAAkBC,WAAW,EAAE;YACnFnB,IAAIE,IAAI,CAACgB,kBAAkBC,WAAW;QACxC;QAEA,OAAOnB;IACT,GACAW;IAGF,OAAO;QAAEI,MAAMX;QAAkBY,SAASC;IAAiB;AAC7D;AAEA,MAAMxB,4BAA4B,CAACiB;IACjC,MAAMU,kBAAiC,EAAE;IAEzCvB,+CAAsB,CAACQ,QAAQ,CAACgB,OAAO,CAACH,CAAAA;QACtC,IAAI,CAACR,aAAaD,QAAQ,CAACS,kBAAkBf,KAAK,KAAKe,kBAAkBC,WAAW,EAAE;YACpFC,gBAAgBlB,IAAI,IAAIgB,kBAAkBC,WAAW,CAACH,OAAO;QAC/D;IACF;IAEA,MAAMM,kBAAkBZ,aAAaa,MAAM,CAACC,CAAAA,MAAO,CAACJ,gBAAgBX,QAAQ,CAACe;IAE7E,OAAOF;AACT"}