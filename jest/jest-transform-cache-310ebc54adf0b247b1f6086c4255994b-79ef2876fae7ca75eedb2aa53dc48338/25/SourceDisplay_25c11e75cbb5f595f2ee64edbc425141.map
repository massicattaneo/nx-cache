{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/composite-components/src/SourceDisplay/SourceDisplay.tsx"],"sourcesContent":["import { MouseEventHandler, useEffect } from \"react\"\nimport { BIG_SUMMARY_SOURCE_HEIGHT } from \"@rp/common/settings\"\nimport { getTimePassed } from \"@rp/common/utils\"\nimport { useCqsByIdsContext } from \"@rp/react/tanstack-api/cqs-by-ids\"\nimport { LlmDocumentSource } from \"@rp/react/tanstack-api/llm-summary\"\nimport { Box, Skeleton, Typography } from \"@rp/react/web/mui/core\"\nimport { DocumentIcon } from \"../DocumentIcon\"\nimport { EllipsisTooltip } from \"../EllipsisTooltip\"\nimport { SourceImageDisplay } from \"./SourceImageDisplay\"\n\ntype LlmDocumentSourceWithLinks = LlmDocumentSource & {\n  url?: string | null\n  imageUrls?: Array<string> | null\n}\n\ntype Props = {\n  isLoading?: boolean\n  source: LlmDocumentSourceWithLinks\n  onClick?: MouseEventHandler<HTMLDivElement>\n  showTooltips?: boolean\n  name: string\n  ts?: string\n}\n\nconst LoadingSourceDisplay = () => (\n  <Skeleton\n    width={302}\n    height={92}\n    variant=\"rectangular\"\n    sx={{ borderRadius: 1, transform: \"none\" }}\n  />\n)\n\nconst SourceDisplay = ({ isLoading, source, onClick, showTooltips = true, name, ts }: Props) => {\n  const { hd, srcKey } = source\n  const { ids, addByIds } = useCqsByIdsContext()\n\n  // TODO: Retrieve this info from BE\n  const documentScope = \"news\"\n  const isPrivate = srcKey === \"000000\"\n\n  useEffect(() => {\n    if (srcKey) {\n      addByIds([{ key: srcKey, queryType: \"source\" }])\n    }\n  }, [srcKey, addByIds, ids])\n\n  if (isLoading || ids[srcKey]?.isLoading) {\n    return <LoadingSourceDisplay />\n  }\n\n  const height = BIG_SUMMARY_SOURCE_HEIGHT - 2\n  const [ext = \"\"] = hd.match(/\\.[0-9a-z]+$/i) ?? []\n\n  return srcKey && name ? (\n    <Box\n      onClick={onClick}\n      sx={theme => ({\n        zIndex: 0,\n        width: 276,\n        height,\n        border: `1px solid ${theme.palette.outline.border}`,\n        borderRadius: 2,\n        display: \"flex\",\n        \"&:hover\": {\n          cursor: \"pointer\",\n          backgroundColor: \"elevation.dp08\",\n        },\n      })}\n    >\n      <Box>\n        <SourceImageDisplay\n          sx={{\n            p: 0,\n            height,\n            \"& img\": {\n              maxWidth: \"130px\",\n              height,\n              objectFit: \"cover\",\n              borderRadius: \"8px 0 0 8px\",\n            },\n          }}\n          height={height}\n          sources={[source]}\n          isSummaryCompleted\n        />\n      </Box>\n      <Box sx={{ flexGrow: 0, p: \"12px\", overflow: \"hidden\" }}>\n        {showTooltips ? (\n          <EllipsisTooltip\n            vertical\n            tooltipText={hd}\n            typographyProps={{ style: { lineHeight: 1.2, minHeight: 40 } }}\n          >\n            {hd}\n          </EllipsisTooltip>\n        ) : (\n          hd\n        )}\n        <Box sx={{ pt: 1, display: \"flex\", \"& span\": { color: \"text.secondary\" } }}>\n          <DocumentIcon\n            documentScope={isPrivate ? \"files\" : documentScope}\n            srcKey={srcKey}\n            contentType={ext.replace(\".\", \"\")}\n            text={name}\n          />\n\n          {ts ? (\n            <Typography component=\"span\" sx={{ flexShrink: 0, fontSize: 12 }}>\n              Â· {getTimePassed(ts)}\n            </Typography>\n          ) : null}\n        </Box>\n      </Box>\n    </Box>\n  ) : null\n}\n\nexport { SourceDisplay, LoadingSourceDisplay }\n"],"names":["LoadingSourceDisplay","SourceDisplay","Skeleton","width","height","variant","sx","borderRadius","transform","isLoading","source","onClick","showTooltips","name","ts","ids","hd","srcKey","addByIds","useCqsByIdsContext","documentScope","isPrivate","useEffect","key","queryType","BIG_SUMMARY_SOURCE_HEIGHT","ext","match","Box","theme","zIndex","border","palette","outline","display","cursor","backgroundColor","SourceImageDisplay","p","maxWidth","objectFit","sources","isSummaryCompleted","flexGrow","overflow","EllipsisTooltip","vertical","tooltipText","typographyProps","style","lineHeight","minHeight","pt","color","DocumentIcon","contentType","replace","text","Typography","component","flexShrink","fontSize","getTimePassed"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IAsHwBA,oBAAoB;eAApBA;;IAAfC,aAAa;eAAbA;;;;uBAtHoC;0BACH;uBACZ;0BACK;sBAEO;8BACb;iCACG;oCACG;AAgBnC,MAAMD,uBAAuB,kBAC3B,qBAACE,cAAQ;QACPC,OAAO;QACPC,QAAQ;QACRC,SAAQ;QACRC,IAAI;YAAEC,cAAc;YAAGC,WAAW;QAAO;;AAI7C,MAAMP,gBAAgB,CAAC,EAAEQ,SAAS,EAAEC,MAAM,EAAEC,OAAO,EAAEC,eAAe,IAAI,EAAEC,IAAI,EAAEC,EAAE,EAAS;QAcxEC;IAbjB,MAAM,EAAEC,EAAE,EAAEC,MAAM,EAAE,GAAGP;IACvB,MAAM,EAAEK,GAAG,EAAEG,QAAQ,EAAE,GAAGC,IAAAA,4BAAkB;IAE5C,mCAAmC;IACnC,MAAMC,gBAAgB;IACtB,MAAMC,YAAYJ,WAAW;IAE7BK,IAAAA,gBAAS,EAAC;QACR,IAAIL,QAAQ;YACVC,SAAS;gBAAC;oBAAEK,KAAKN;oBAAQO,WAAW;gBAAS;aAAE;QACjD;IACF,GAAG;QAACP;QAAQC;QAAUH;KAAI;IAE1B,IAAIN,eAAaM,cAAAA,GAAG,CAACE,OAAO,cAAXF,kCAAAA,YAAaN,SAAS,GAAE;QACvC,qBAAO,qBAACT;IACV;IAEA,MAAMI,SAASqB,mCAAyB,GAAG;QACxBT;IAAnB,MAAM,CAACU,MAAM,EAAE,CAAC,GAAGV,CAAAA,YAAAA,GAAGW,KAAK,CAAC,8BAATX,uBAAAA,YAA6B,EAAE;IAElD,OAAOC,UAAUJ,qBACf,sBAACe,SAAG;QACFjB,SAASA;QACTL,IAAIuB,CAAAA,QAAU,CAAA;gBACZC,QAAQ;gBACR3B,OAAO;gBACPC;gBACA2B,QAAQ,CAAC,UAAU,EAAEF,MAAMG,OAAO,CAACC,OAAO,CAACF,MAAM,CAAC,CAAC;gBACnDxB,cAAc;gBACd2B,SAAS;gBACT,WAAW;oBACTC,QAAQ;oBACRC,iBAAiB;gBACnB;YACF,CAAA;;0BAEA,qBAACR,SAAG;0BACF,cAAA,qBAACS,sCAAkB;oBACjB/B,IAAI;wBACFgC,GAAG;wBACHlC;wBACA,SAAS;4BACPmC,UAAU;4BACVnC;4BACAoC,WAAW;4BACXjC,cAAc;wBAChB;oBACF;oBACAH,QAAQA;oBACRqC,SAAS;wBAAC/B;qBAAO;oBACjBgC,kBAAkB;;;0BAGtB,sBAACd,SAAG;gBAACtB,IAAI;oBAAEqC,UAAU;oBAAGL,GAAG;oBAAQM,UAAU;gBAAS;;oBACnDhC,6BACC,qBAACiC,gCAAe;wBACdC,QAAQ;wBACRC,aAAa/B;wBACbgC,iBAAiB;4BAAEC,OAAO;gCAAEC,YAAY;gCAAKC,WAAW;4BAAG;wBAAE;kCAE5DnC;yBAGHA;kCAEF,sBAACY,SAAG;wBAACtB,IAAI;4BAAE8C,IAAI;4BAAGlB,SAAS;4BAAQ,UAAU;gCAAEmB,OAAO;4BAAiB;wBAAE;;0CACvE,qBAACC,0BAAY;gCACXlC,eAAeC,YAAY,UAAUD;gCACrCH,QAAQA;gCACRsC,aAAa7B,IAAI8B,OAAO,CAAC,KAAK;gCAC9BC,MAAM5C;;4BAGPC,mBACC,sBAAC4C,gBAAU;gCAACC,WAAU;gCAAOrD,IAAI;oCAAEsD,YAAY;oCAAGC,UAAU;gCAAG;;oCAAG;oCAC7DC,IAAAA,oBAAa,EAAChD;;iCAEjB;;;;;;SAIR;AACN"}