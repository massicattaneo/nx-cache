{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/pages/Results/ResultsLayout.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { CqsItem, CqsSavedStatus } from \"@rp/common/api-types\"\nimport { Watchlist } from \"@rp/common/api-types\"\nimport { RpqlFilter } from \"@rp/common/api-types\"\nimport { RESULTS_FILTERS_HEIGHT } from \"@rp/common/settings\"\nimport { ShareIcon } from \"@rp/react/web/common/base-components\"\nimport { ActionsMenu } from \"@rp/react/web/common/base-components\"\nimport { HandleOpenModalProps, SearchInfo } from \"@rp/react/web/common/composite-components\"\nimport { EllipsisTooltip } from \"@rp/react/web/common/composite-components\"\nimport { HtmlPageHead } from \"@rp/react/web/common/header-components\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { Header } from \"@rp/react/web/common/layout\"\nimport { useQueryActions } from \"@rp/react/web/common/providers\"\nimport { FollowButton } from \"@rp/react/web/common/providers\"\nimport {\n  FeedbackButton,\n  FeedbackDrawer,\n  SnapshotButton,\n  useFeedbackContext,\n} from \"@rp/react/web/common/providers\"\nimport { useModal } from \"@rp/react/web/common/providers\"\nimport { useCurrentCQSPreview, useQueryContext } from \"@rp/react/web/common/providers\"\nimport { StoryCardResults } from \"@rp/react/web/common/results-story-card\"\nimport { CqsQueryBar } from \"@rp/react/web/cqs-query-bar\"\nimport { DiscoveryPanel } from \"@rp/react/web/discovery-sidebar/discovery-panel\"\nimport { DocumentViewerPage } from \"@rp/react/web/document-viewer\"\nimport { Box, Grid, Typography } from \"@rp/react/web/mui/core\"\nimport { ResultsSuggestionBar } from \"./ResultsSuggestionBar\"\n\ntype Props = {\n  handleOnChange: (item: CqsItem) => void\n  handleOnExclude: (item: CqsItem) => void\n  saveStatus: CqsSavedStatus | undefined\n  name: string | undefined\n  editable: boolean | undefined\n  expression: RpqlFilter | undefined\n  isLoading: boolean\n  isError: boolean\n  onAddToWatchlist?: (watchlist: Watchlist) => void\n  onHandleOpenModal: HandleOpenModalProps\n}\n\nconst ResultsLayout = ({\n  handleOnChange,\n  handleOnExclude,\n  name,\n  expression,\n  isLoading,\n  onAddToWatchlist,\n  onHandleOpenModal,\n  editable = false,\n}: Props) => {\n  const { isFeedbackMode } = useFeedbackContext()\n  const { isWideScreen, isMobile } = useDeviceInfo()\n  const {\n    queryBar,\n    searchQuery: query,\n    savedQuery,\n    uiState: { isSummaryLoading },\n  } = useQueryContext()\n  const {\n    saveSearchModal: { handleOpen },\n  } = useModal()\n  const showPublicIcon = savedQuery.shared && savedQuery.shared?.company.permission !== \"undefined\"\n  const { isFetching: isLoadingResults, documentCount } = useCurrentCQSPreview()\n  const isSaved = savedQuery.saveStatus === \"saved\"\n\n  const snapshotData = {\n    name,\n    queryId: queryBar.id,\n    query,\n  }\n\n  const { share, rename, copyInANewTab, remove, follow } = useQueryActions(savedQuery)\n  const [menuOpen, setMenuOpen] = useState(false)\n\n  return (\n    <>\n      <HtmlPageHead title={`${isSaved ? name : \"Untitled \"} | Search`} />\n      <Header\n        leftContent={<ResultsSuggestionBar />}\n        rightContent={\n          <>\n            {isMobile ? null : (\n              <SnapshotButton\n                snapshotData={snapshotData}\n                isSaved={isSaved}\n                notEnoughResults={documentCount < 20}\n                isLoading={isLoading || isSummaryLoading || isLoadingResults}\n              />\n            )}\n            <FeedbackButton />\n            <Box\n              sx={{\n                display: \"flex\",\n                alignItems: \"center\",\n                maxWidth: isFeedbackMode\n                  ? `calc(100% - ${390 + (showPublicIcon ? 30 : 0)}px)`\n                  : `calc(100% - ${270 + (showPublicIcon ? 30 : 0)}px)`,\n                flexGrow: 1,\n                justifyContent: \"right\",\n              }}\n            >\n              <EllipsisTooltip\n                tooltipText={isSaved ? name ?? \"\" : \"Untitled Search\"}\n                tooltipProps={{ disableInteractive: true }}\n              >\n                <Typography\n                  component=\"span\"\n                  sx={{ cursor: editable ? \"pointer\" : undefined }}\n                  onClick={() => editable && handleOpen(savedQuery)}\n                >\n                  {isSaved ? name : \"Untitled Search\"}\n                </Typography>\n              </EllipsisTooltip>\n            </Box>\n            {showPublicIcon && (\n              <SearchInfo\n                ownerName={savedQuery.ownerName ?? \"\"}\n                lastUpdated={savedQuery.lastUpdated}\n              >\n                <Box component=\"span\" sx={{ alignItems: \"center\", display: \" flex\" }}>\n                  <ShareIcon shared />\n                </Box>\n              </SearchInfo>\n            )}\n            <Box\n              sx={{\n                display: \"flex\",\n                gap: 0.5,\n                alignItems: \"center\",\n              }}\n            >\n              <ActionsMenu\n                open={menuOpen}\n                setOpen={setMenuOpen}\n                actions={[follow, share, rename, copyInANewTab, remove]}\n                item={undefined}\n                anchorOrigin={{\n                  vertical: \"bottom\",\n                  horizontal: \"right\",\n                }}\n                transformOrigin={{\n                  vertical: \"top\",\n                  horizontal: \"right\",\n                }}\n              />\n            </Box>\n            <FollowButton id={savedQuery.id} saveStatus={savedQuery.saveStatus} />\n          </>\n        }\n      />\n\n      <CqsQueryBar query={queryBar} onHandleOpenModal={onHandleOpenModal} />\n      <DocumentViewerPage\n        backTitle=\"Back to Results\"\n        expression={expression}\n        onChange={handleOnChange}\n        onExclude={handleOnExclude}\n        onAddToWatchlist={onAddToWatchlist}\n        pdfHeaderOffset={97}\n      >\n        <Grid container columnSpacing={3}>\n          <Grid item xs={8} xl={7} marginRight={isWideScreen ? \"36px\" : 0}>\n            <StoryCardResults key={savedQuery.query.scope} />\n          </Grid>\n          <Grid item xs={4} mt={`${RESULTS_FILTERS_HEIGHT}px`}>\n            <DiscoveryPanel onAddToWatchlist={onAddToWatchlist} isFeedbackMode={isFeedbackMode} />\n          </Grid>\n        </Grid>\n      </DocumentViewerPage>\n      <FeedbackDrawer />\n    </>\n  )\n}\n\nexport { ResultsLayout }\n"],"names":["ResultsLayout","handleOnChange","handleOnExclude","name","expression","isLoading","onAddToWatchlist","onHandleOpenModal","editable","savedQuery","isFeedbackMode","useFeedbackContext","isWideScreen","isMobile","useDeviceInfo","queryBar","searchQuery","query","uiState","isSummaryLoading","useQueryContext","saveSearchModal","handleOpen","useModal","showPublicIcon","shared","company","permission","isFetching","isLoadingResults","documentCount","useCurrentCQSPreview","isSaved","saveStatus","snapshotData","queryId","id","share","rename","copyInANewTab","remove","follow","useQueryActions","menuOpen","setMenuOpen","useState","HtmlPageHead","title","Header","leftContent","ResultsSuggestionBar","rightContent","SnapshotButton","notEnoughResults","FeedbackButton","Box","sx","display","alignItems","maxWidth","flexGrow","justifyContent","EllipsisTooltip","tooltipText","tooltipProps","disableInteractive","Typography","component","cursor","undefined","onClick","SearchInfo","ownerName","lastUpdated","ShareIcon","gap","ActionsMenu","open","setOpen","actions","item","anchorOrigin","vertical","horizontal","transformOrigin","FollowButton","CqsQueryBar","DocumentViewerPage","backTitle","onChange","onExclude","pdfHeaderOffset","Grid","container","columnSpacing","xs","xl","marginRight","StoryCardResults","scope","mt","RESULTS_FILTERS_HEIGHT","DiscoveryPanel","FeedbackDrawer"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}