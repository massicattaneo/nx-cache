{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/ChatInput/MobileDatasetPopper.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\nimport { DatasetScope } from \"@rp/common/api-types\"\nimport { Box, Drawer, IconButton, InputBase, Typography } from \"@rp/react/web/mui/core\"\nimport { ArrowBack, Search } from \"@rp/react/web/mui/icons\"\nimport { ScopeCollection } from \"../ScopeSelectorModal/ScopeCollection\"\nimport { useDatasets } from \"./DatasetPopper\"\n\ntype Props = {\n  open: boolean\n  onClose: () => void\n  scope?: DatasetScope\n  setScope: (scope: DatasetScope) => void\n  initialFilter?: string\n  enableFreeTier: boolean\n  sourceFilter: Partial<Record<string, boolean>>\n}\n\nconst MobileDatasetPopper = ({\n  open,\n  onClose,\n  scope,\n  setScope,\n  initialFilter = \"\",\n  // enableFreeTier,\n  sourceFilter,\n}: Props) => {\n  const [filter, setFilter] = useState(initialFilter)\n  const [isSearchOpen, setIsSearchOpen] = useState(false)\n  const [selectedScope, setSelectedScope] = useState<DatasetScope | undefined>(scope)\n\n  const datasetData = useDatasets(filter, true, sourceFilter)\n\n  useEffect(() => {\n    if (open) {\n      document.body.classList.add(\"freezeScroll\")\n    } else {\n      document.body.classList.remove(\"freezeScroll\")\n    }\n\n    return () => document.body.classList.remove(\"freezeScroll\")\n  })\n\n  if (!open) return\n\n  return (\n    <Drawer anchor=\"bottom\" open>\n      <Box\n        sx={{\n          // Trick to avoid scrolling on the chat page on iOS\n          height: \"100dvh\",\n          width: \"100dvw\",\n          overflowX: \"hidden\",\n          overflowY: \"auto\",\n          overscrollBehavior: \"contain\",\n          \"&::-webkit-scrollbar\": {\n            width: 0,\n          },\n        }}\n      >\n        <Box\n          sx={{\n            width: \"100%\",\n            height: \"100%\",\n            backgroundColor: \"surface.main\",\n          }}\n        >\n          {isSearchOpen ? (\n            <InputBase\n              sx={{\n                backgroundColor: \"elevation.dp04\",\n                py: 0.85,\n                width: \"100%\",\n                borderBottom: \"1px solid\",\n                borderColor: \"outline.border\",\n                \"& .MuiInputBase-root\": {\n                  borderRadius: 0,\n                  pl: 0,\n                },\n              }}\n              autoFocus\n              value={filter}\n              onChange={event => setFilter(event.target.value)}\n              placeholder=\"Find in Sources\"\n              startAdornment={\n                <IconButton onClick={() => setIsSearchOpen(false)} sx={{ ml: 1 }}>\n                  <ArrowBack sx={{ height: 24, width: 24 }} />\n                </IconButton>\n              }\n            />\n          ) : (\n            <Box\n              sx={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                borderBottom: \"1px solid\",\n                borderColor: \"outline.border\",\n                height: 55,\n                px: 1,\n              }}\n            >\n              <Box sx={{ display: \"flex\", alignItems: \"center\" }}>\n                <IconButton onClick={onClose}>\n                  <ArrowBack />\n                </IconButton>\n                <Typography sx={{ fontWeight: 700 }}>Sources</Typography>\n              </Box>\n              <IconButton onClick={() => setIsSearchOpen(true)}>\n                <Search sx={{ color: \"text.secondary\" }} />\n              </IconButton>\n            </Box>\n          )}\n\n          <Box sx={{ p: 2 }}>\n            <ScopeCollection\n              data={datasetData}\n              onDatasetClick={scope => {\n                setScope(scope)\n                setSelectedScope(scope)\n                onClose()\n              }}\n              selectedDataset={selectedScope}\n            />\n          </Box>\n        </Box>\n        <Box sx={{ height: \"1px\" }}></Box>\n      </Box>\n    </Drawer>\n  )\n}\n\nexport { MobileDatasetPopper }\n"],"names":["MobileDatasetPopper","open","onClose","scope","setScope","initialFilter","sourceFilter","filter","setFilter","useState","isSearchOpen","setIsSearchOpen","selectedScope","setSelectedScope","datasetData","useDatasets","useEffect","document","body","classList","add","remove","Drawer","anchor","Box","sx","height","width","overflowX","overflowY","overscrollBehavior","backgroundColor","InputBase","py","borderBottom","borderColor","borderRadius","pl","autoFocus","value","onChange","event","target","placeholder","startAdornment","IconButton","onClick","ml","ArrowBack","display","justifyContent","alignItems","px","Typography","fontWeight","Search","color","p","ScopeCollection","data","onDatasetClick","selectedDataset"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAmISA;;;eAAAA;;;;uBAnI2B;sBAE2B;uBAC7B;iCACF;+BACJ;AAY5B,MAAMA,sBAAsB,CAAC,EAC3BC,IAAI,EACJC,OAAO,EACPC,KAAK,EACLC,QAAQ,EACRC,gBAAgB,EAAE,EAClB,kBAAkB;AAClBC,YAAY,EACN;IACN,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAACJ;IACrC,MAAM,CAACK,cAAcC,gBAAgB,GAAGF,IAAAA,eAAQ,EAAC;IACjD,MAAM,CAACG,eAAeC,iBAAiB,GAAGJ,IAAAA,eAAQ,EAA2BN;IAE7E,MAAMW,cAAcC,IAAAA,0BAAW,EAACR,QAAQ,MAAMD;IAE9CU,IAAAA,gBAAS,EAAC;QACR,IAAIf,MAAM;YACRgB,SAASC,IAAI,CAACC,SAAS,CAACC,GAAG,CAAC;QAC9B,OAAO;YACLH,SAASC,IAAI,CAACC,SAAS,CAACE,MAAM,CAAC;QACjC;QAEA,OAAO,IAAMJ,SAASC,IAAI,CAACC,SAAS,CAACE,MAAM,CAAC;IAC9C;IAEA,IAAI,CAACpB,MAAM;IAEX,qBACE,qBAACqB,YAAM;QAACC,QAAO;QAAStB,IAAI;kBAC1B,cAAA,sBAACuB,SAAG;YACFC,IAAI;gBACF,mDAAmD;gBACnDC,QAAQ;gBACRC,OAAO;gBACPC,WAAW;gBACXC,WAAW;gBACXC,oBAAoB;gBACpB,wBAAwB;oBACtBH,OAAO;gBACT;YACF;;8BAEA,sBAACH,SAAG;oBACFC,IAAI;wBACFE,OAAO;wBACPD,QAAQ;wBACRK,iBAAiB;oBACnB;;wBAECrB,6BACC,qBAACsB,eAAS;4BACRP,IAAI;gCACFM,iBAAiB;gCACjBE,IAAI;gCACJN,OAAO;gCACPO,cAAc;gCACdC,aAAa;gCACb,wBAAwB;oCACtBC,cAAc;oCACdC,IAAI;gCACN;4BACF;4BACAC,SAAS;4BACTC,OAAOhC;4BACPiC,UAAUC,CAAAA,QAASjC,UAAUiC,MAAMC,MAAM,CAACH,KAAK;4BAC/CI,aAAY;4BACZC,8BACE,qBAACC,gBAAU;gCAACC,SAAS,IAAMnC,gBAAgB;gCAAQc,IAAI;oCAAEsB,IAAI;gCAAE;0CAC7D,cAAA,qBAACC,gBAAS;oCAACvB,IAAI;wCAAEC,QAAQ;wCAAIC,OAAO;oCAAG;;;2CAK7C,sBAACH,SAAG;4BACFC,IAAI;gCACFwB,SAAS;gCACTC,gBAAgB;gCAChBC,YAAY;gCACZjB,cAAc;gCACdC,aAAa;gCACbT,QAAQ;gCACR0B,IAAI;4BACN;;8CAEA,sBAAC5B,SAAG;oCAACC,IAAI;wCAAEwB,SAAS;wCAAQE,YAAY;oCAAS;;sDAC/C,qBAACN,gBAAU;4CAACC,SAAS5C;sDACnB,cAAA,qBAAC8C,gBAAS;;sDAEZ,qBAACK,gBAAU;4CAAC5B,IAAI;gDAAE6B,YAAY;4CAAI;sDAAG;;;;8CAEvC,qBAACT,gBAAU;oCAACC,SAAS,IAAMnC,gBAAgB;8CACzC,cAAA,qBAAC4C,aAAM;wCAAC9B,IAAI;4CAAE+B,OAAO;wCAAiB;;;;;sCAK5C,qBAAChC,SAAG;4BAACC,IAAI;gCAAEgC,GAAG;4BAAE;sCACd,cAAA,qBAACC,gCAAe;gCACdC,MAAM7C;gCACN8C,gBAAgBzD,CAAAA;oCACdC,SAASD;oCACTU,iBAAiBV;oCACjBD;gCACF;gCACA2D,iBAAiBjD;;;;;8BAIvB,qBAACY,SAAG;oBAACC,IAAI;wBAAEC,QAAQ;oBAAM;;;;;AAIjC"}