{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/watchlists/src/lib/WatchlistAutosuggest/AdvancedWatchlistAutosuggest.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { useDebouncedState } from \"@rp/react/common/hooks\"\nimport { usePanelConfig } from \"@rp/react/tanstack-api/discovery-panel-config\"\nimport {\n  EnhancedSuggestion,\n  WatchlistSuggestionFilters,\n  useWatchlistSuggestions,\n} from \"@rp/react/tanstack-api/suggestion\"\nimport { WatchlistAutosuggestInput } from \"@rp/react/web/common/search-autosuggest-input\"\nimport { SuggestionsFilters, WatchlistCategoryFilter } from \"@rp/react/web/common/watchlist-editor\"\nimport { Box } from \"@rp/react/web/mui/core\"\n\ntype Props = {\n  onChange: (value: EnhancedSuggestion) => void\n  selectedItems: Array<string>\n  perPage?: number\n  displayItems?: number\n}\n\nexport const AdvancedWatchlistAutosuggest = ({\n  onChange,\n  selectedItems,\n  perPage = 20,\n  displayItems = 3,\n}: Props) => {\n  const { data: panelConfig } = usePanelConfig()\n  const [popperOpen, setPopperOpen] = useState(false)\n  const [category, setCategory] = useState<string | undefined>(undefined)\n  const [query, setQuery, queryValue] = useDebouncedState(\"\", 140)\n  const [filters, setFilters] = useState<WatchlistSuggestionFilters>({})\n\n  const { data, fetchNextPage, hasNextPage, isLoading } = useWatchlistSuggestions({\n    query,\n    category: category ? [category] : undefined,\n    perPage,\n    ...filters[category ?? \"\"],\n  })\n\n  return (\n    <>\n      <WatchlistCategoryFilter\n        categories={panelConfig?.discoveryPanelCategories ?? []}\n        counts={{}}\n        onChange={category => setCategory(category)}\n      />\n      <Box sx={{ display: \"flex\", flexWrap: \"wrap\", gap: 1, height: 32 }}>\n        <SuggestionsFilters\n          hideClearFilter\n          categoryFilter={category}\n          filters={filters}\n          setFilters={setFilters}\n          facets={data?.pages[0]?.facets ?? {}}\n          suggestionQuery={{\n            query,\n            category: category ? [category] : undefined,\n            ...filters[category ?? \"\"],\n          }}\n          fields={\n            panelConfig?.discoveryPanelCategories.find(c => c.label === category)?.watchlistGroups\n              .fields ?? []\n          }\n        />\n      </Box>\n      <WatchlistAutosuggestInput\n        onChange={onChange}\n        setQuery={setQuery}\n        rawQuery={queryValue}\n        placeholder={\"Search\"}\n        open={popperOpen}\n        setOpen={setPopperOpen}\n        selectedItems={selectedItems}\n        displayItems={displayItems}\n        clearOnEnter\n        inputProps={{ sx: { input: { padding: 1 } } }}\n        data={data}\n        hasNextPage={hasNextPage}\n        fetchNextPage={fetchNextPage}\n        isLoading={isLoading}\n        showTicker={category === \"Companies\" || category === \"ETFs\"}\n      />\n    </>\n  )\n}\n"],"names":["AdvancedWatchlistAutosuggest","onChange","selectedItems","perPage","displayItems","data","panelConfig","usePanelConfig","popperOpen","setPopperOpen","useState","category","setCategory","undefined","query","setQuery","queryValue","useDebouncedState","filters","setFilters","fetchNextPage","hasNextPage","isLoading","useWatchlistSuggestions","WatchlistCategoryFilter","categories","discoveryPanelCategories","counts","Box","sx","display","flexWrap","gap","height","SuggestionsFilters","hideClearFilter","categoryFilter","facets","pages","suggestionQuery","fields","find","c","label","watchlistGroups","WatchlistAutosuggestInput","rawQuery","placeholder","open","setOpen","clearOnEnter","inputProps","input","padding","showTicker"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAmBaA;;;eAAAA;;;;uBAnBY;uBACS;sCACH;4BAKxB;wCACmC;iCACkB;sBACxC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASb,MAAMA,+BAA+B,CAAC,EAC3CC,QAAQ,EACRC,aAAa,EACbC,UAAU,EAAE,EACZC,eAAe,CAAC,EACV;QA2BUC,cAONC;IAjCV,MAAM,EAAED,MAAMC,WAAW,EAAE,GAAGC,IAAAA,oCAAc;IAC5C,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAAC;IAC7C,MAAM,CAACC,UAAUC,YAAY,GAAGF,IAAAA,eAAQ,EAAqBG;IAC7D,MAAM,CAACC,OAAOC,UAAUC,WAAW,GAAGC,IAAAA,wBAAiB,EAAC,IAAI;IAC5D,MAAM,CAACC,SAASC,WAAW,GAAGT,IAAAA,eAAQ,EAA6B,CAAC;IAEpE,MAAM,EAAEL,IAAI,EAAEe,aAAa,EAAEC,WAAW,EAAEC,SAAS,EAAE,GAAGC,IAAAA,mCAAuB,EAAC;QAC9ET;QACAH,UAAUA,WAAW;YAACA;SAAS,GAAGE;QAClCV;OACGe,OAAO,CAACP,qBAAAA,sBAAAA,WAAY,GAAG;QAMVL,uCAUFD,qBAONC;IApBV,qBACE;;0BACE,qBAACkB,wCAAuB;gBACtBC,YAAYnB,CAAAA,wCAAAA,wBAAAA,kCAAAA,YAAaoB,wBAAwB,cAArCpB,mDAAAA,wCAAyC,EAAE;gBACvDqB,QAAQ,CAAC;gBACT1B,UAAUU,CAAAA,WAAYC,YAAYD;;0BAEpC,qBAACiB,SAAG;gBAACC,IAAI;oBAAEC,SAAS;oBAAQC,UAAU;oBAAQC,KAAK;oBAAGC,QAAQ;gBAAG;0BAC/D,cAAA,qBAACC,mCAAkB;oBACjBC,eAAe;oBACfC,gBAAgBzB;oBAChBO,SAASA;oBACTC,YAAYA;oBACZkB,QAAQhC,CAAAA,sBAAAA,iBAAAA,4BAAAA,eAAAA,KAAMiC,KAAK,CAAC,EAAE,cAAdjC,mCAAAA,aAAgBgC,MAAM,cAAtBhC,iCAAAA,sBAA0B,CAAC;oBACnCkC,iBAAiB;wBACfzB;wBACAH,UAAUA,WAAW;4BAACA;yBAAS,GAAGE;uBAC/BK,OAAO,CAACP,qBAAAA,sBAAAA,WAAY,GAAG;oBAE5B6B,QACElC,CAAAA,oEAAAA,wBAAAA,mCAAAA,6CAAAA,YAAaoB,wBAAwB,CAACe,IAAI,CAACC,CAAAA,IAAKA,EAAEC,KAAK,KAAKhC,uBAA5DL,iEAAAA,2CAAuEsC,eAAe,CACnFJ,MAAM,cADTlC,+EAAAA,oEACa,EAAE;;;0BAIrB,qBAACuC,iDAAyB;gBACxB5C,UAAUA;gBACVc,UAAUA;gBACV+B,UAAU9B;gBACV+B,aAAa;gBACbC,MAAMxC;gBACNyC,SAASxC;gBACTP,eAAeA;gBACfE,cAAcA;gBACd8C,YAAY;gBACZC,YAAY;oBAAEtB,IAAI;wBAAEuB,OAAO;4BAAEC,SAAS;wBAAE;oBAAE;gBAAE;gBAC5ChD,MAAMA;gBACNgB,aAAaA;gBACbD,eAAeA;gBACfE,WAAWA;gBACXgC,YAAY3C,aAAa,eAAeA,aAAa;;;;AAI7D"}