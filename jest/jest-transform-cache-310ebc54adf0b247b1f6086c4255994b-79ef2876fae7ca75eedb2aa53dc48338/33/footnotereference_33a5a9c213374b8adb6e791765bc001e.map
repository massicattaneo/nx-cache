{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/node_modules/mdast-util-to-hast/lib/handlers/footnote-reference.js"],"sourcesContent":["/**\n * @typedef {import('hast').Element} Element\n * @typedef {import('mdast').FootnoteReference} FootnoteReference\n * @typedef {import('../state.js').State} State\n */\n\nimport {normalizeUri} from 'micromark-util-sanitize-uri'\n\n/**\n * Turn an mdast `footnoteReference` node into hast.\n *\n * @param {State} state\n *   Info passed around.\n * @param {FootnoteReference} node\n *   mdast node.\n * @returns {Element}\n *   hast node.\n */\nexport function footnoteReference(state, node) {\n  const clobberPrefix =\n    typeof state.options.clobberPrefix === 'string'\n      ? state.options.clobberPrefix\n      : 'user-content-'\n  const id = String(node.identifier).toUpperCase()\n  const safeId = normalizeUri(id.toLowerCase())\n  const index = state.footnoteOrder.indexOf(id)\n  /** @type {number} */\n  let counter\n\n  let reuseCounter = state.footnoteCounts.get(id)\n\n  if (reuseCounter === undefined) {\n    reuseCounter = 0\n    state.footnoteOrder.push(id)\n    counter = state.footnoteOrder.length\n  } else {\n    counter = index + 1\n  }\n\n  reuseCounter += 1\n  state.footnoteCounts.set(id, reuseCounter)\n\n  /** @type {Element} */\n  const link = {\n    type: 'element',\n    tagName: 'a',\n    properties: {\n      href: '#' + clobberPrefix + 'fn-' + safeId,\n      id:\n        clobberPrefix +\n        'fnref-' +\n        safeId +\n        (reuseCounter > 1 ? '-' + reuseCounter : ''),\n      dataFootnoteRef: true,\n      ariaDescribedBy: ['footnote-label']\n    },\n    children: [{type: 'text', value: String(counter)}]\n  }\n  state.patch(node, link)\n\n  /** @type {Element} */\n  const sup = {\n    type: 'element',\n    tagName: 'sup',\n    properties: {},\n    children: [link]\n  }\n  state.patch(node, sup)\n  return state.applyData(node, sup)\n}\n"],"names":["footnoteReference","state","node","clobberPrefix","options","id","String","identifier","toUpperCase","safeId","normalizeUri","toLowerCase","index","footnoteOrder","indexOf","counter","reuseCounter","footnoteCounts","get","undefined","push","length","set","link","type","tagName","properties","href","dataFootnoteRef","ariaDescribedBy","children","value","patch","sup","applyData"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA;;;;CAIC;;;;+BAceA;;;eAAAA;;;0CAZW;AAYpB,SAASA,kBAAkBC,KAAK,EAAEC,IAAI;IAC3C,MAAMC,gBACJ,OAAOF,MAAMG,OAAO,CAACD,aAAa,KAAK,WACnCF,MAAMG,OAAO,CAACD,aAAa,GAC3B;IACN,MAAME,KAAKC,OAAOJ,KAAKK,UAAU,EAAEC,WAAW;IAC9C,MAAMC,SAASC,IAAAA,sCAAY,EAACL,GAAGM,WAAW;IAC1C,MAAMC,QAAQX,MAAMY,aAAa,CAACC,OAAO,CAACT;IAC1C,mBAAmB,GACnB,IAAIU;IAEJ,IAAIC,eAAef,MAAMgB,cAAc,CAACC,GAAG,CAACb;IAE5C,IAAIW,iBAAiBG,WAAW;QAC9BH,eAAe;QACff,MAAMY,aAAa,CAACO,IAAI,CAACf;QACzBU,UAAUd,MAAMY,aAAa,CAACQ,MAAM;IACtC,OAAO;QACLN,UAAUH,QAAQ;IACpB;IAEAI,gBAAgB;IAChBf,MAAMgB,cAAc,CAACK,GAAG,CAACjB,IAAIW;IAE7B,oBAAoB,GACpB,MAAMO,OAAO;QACXC,MAAM;QACNC,SAAS;QACTC,YAAY;YACVC,MAAM,MAAMxB,gBAAgB,QAAQM;YACpCJ,IACEF,gBACA,WACAM,SACCO,CAAAA,eAAe,IAAI,MAAMA,eAAe,EAAC;YAC5CY,iBAAiB;YACjBC,iBAAiB;gBAAC;aAAiB;QACrC;QACAC,UAAU;YAAC;gBAACN,MAAM;gBAAQO,OAAOzB,OAAOS;YAAQ;SAAE;IACpD;IACAd,MAAM+B,KAAK,CAAC9B,MAAMqB;IAElB,oBAAoB,GACpB,MAAMU,MAAM;QACVT,MAAM;QACNC,SAAS;QACTC,YAAY,CAAC;QACbI,UAAU;YAACP;SAAK;IAClB;IACAtB,MAAM+B,KAAK,CAAC9B,MAAM+B;IAClB,OAAOhC,MAAMiC,SAAS,CAAChC,MAAM+B;AAC/B"}