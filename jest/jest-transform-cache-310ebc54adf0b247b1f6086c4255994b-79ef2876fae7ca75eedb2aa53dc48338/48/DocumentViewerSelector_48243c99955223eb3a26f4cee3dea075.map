{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/document-viewer/src/lib/DocumentViewerPage/DocumentViewerSelector.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { useNavigate } from \"react-router-dom\"\nimport { CqsChunkSentence, CqsItem, RpqlFilter, Watchlist } from \"@rp/common/api-types\"\nimport { RpJsonDocument, RpJsonError, isTextBlock } from \"@rp/react/rpjson/types\"\nimport { LoadingSpinner } from \"@rp/react/web/common/base-components\"\nimport { CustomDocumentHeaderProps } from \"../DocumentViewer.types\"\nimport { useDocumentViewerPageScrolling } from \"./hooks/useDocumentViewerPageScrolling\"\nimport { useDocumentViewerPageVisited } from \"./hooks/useDocumentViewerPageVisited\"\nimport PDFViewer from \"./pdf/PDFViewer\"\nimport RPJSONViewer from \"./rpJSON/RPJSONViewer\"\n\ntype DocumentViewerSelectorProps = {\n  isRpJsonLoading: boolean\n  rpjsonDocument: RpJsonDocument | undefined\n  isPrivate: boolean\n  documentId: string\n  backTitle: string\n  disableBackButton: boolean\n  disableCheckbox: boolean\n  disableDocumentDiscovery: boolean\n  expression?: RpqlFilter\n  onChange?: (item: CqsItem) => void\n  onExclude?: (item: CqsItem) => void\n  error: RpJsonError | null\n  pdfHeaderOffset?: number\n  pdfBodyOffset?: number\n  rpjsonHeaderOffset: number | undefined\n  onAddToWatchlist?: (watchlist: Watchlist) => void\n  shouldUseScrollTrigger?: boolean\n  viewerPaddingTop?: string\n  isFromChat?: boolean\n  customDocumentHeaderProps?: CustomDocumentHeaderProps\n  customBackClick?: () => void\n  customBackgroundColor?: string\n}\n\nfunction DocumentViewerSelector({\n  isRpJsonLoading,\n  rpjsonDocument,\n  isPrivate,\n  documentId,\n  backTitle,\n  disableBackButton,\n  disableCheckbox,\n  disableDocumentDiscovery,\n  expression,\n  onChange,\n  onExclude,\n  error,\n  rpjsonHeaderOffset,\n  pdfHeaderOffset,\n  pdfBodyOffset,\n  onAddToWatchlist,\n  shouldUseScrollTrigger = true,\n  viewerPaddingTop,\n  isFromChat = false,\n  customDocumentHeaderProps,\n  customBackClick,\n  customBackgroundColor,\n}: DocumentViewerSelectorProps) {\n  const navigate = useNavigate()\n  const [selectedDetection, setSelectedDetection] = useState<CqsChunkSentence | undefined>(\n    undefined,\n  )\n\n  const handleClick = () => {\n    if (customBackClick) {\n      customBackClick()\n      return\n    }\n\n    setSelectedDetection(undefined)\n    navigate(-1)\n  }\n\n  useDocumentViewerPageScrolling({ documentId })\n  useDocumentViewerPageVisited({ documentId })\n\n  if (isRpJsonLoading || !rpjsonDocument) {\n    return <LoadingSpinner />\n  }\n\n  const shouldShowPdfViewer =\n    rpjsonDocument?.document.metadata.media_type === \"application/pdf\" &&\n    (isPrivate || rpjsonDocument.document.metadata.url !== undefined)\n\n  const title =\n    rpjsonDocument && isTextBlock(rpjsonDocument.content.title)\n      ? rpjsonDocument.content.title.text\n      : \"\"\n\n  const name = rpjsonDocument.document.metadata.provider_filename || title\n\n  if (shouldShowPdfViewer) {\n    return (\n      <PDFViewer\n        disableBackButton={disableBackButton}\n        documentId={documentId}\n        backTitle={backTitle}\n        handleClick={handleClick}\n        name={name}\n        isPrivate={!!isPrivate}\n        pdfUrl={rpjsonDocument.document.metadata.url}\n        pdfBodyOffset={pdfBodyOffset}\n        pdfHeaderOffset={pdfHeaderOffset}\n        isFromChat={isFromChat}\n        customDocumentHeaderProps={customDocumentHeaderProps}\n      />\n    )\n  }\n\n  return (\n    <RPJSONViewer\n      backTitle={backTitle}\n      disableBackButton={disableBackButton}\n      disableCheckbox={disableCheckbox}\n      disableDocumentDiscovery={disableDocumentDiscovery}\n      documentId={documentId}\n      error={error}\n      expression={expression}\n      handleClick={handleClick}\n      rpjsonHeaderOffset={rpjsonHeaderOffset}\n      isPrivate={!!isPrivate}\n      isRpJsonLoading={isRpJsonLoading}\n      onAddToWatchlist={onAddToWatchlist}\n      onChange={onChange}\n      onExclude={onExclude}\n      rpjsonDocument={rpjsonDocument}\n      selectedDetection={selectedDetection}\n      setSelectedDetection={setSelectedDetection}\n      shouldUseScrollTrigger={shouldUseScrollTrigger}\n      viewerPaddingTop={viewerPaddingTop}\n      name={name}\n      customDocumentHeaderProps={customDocumentHeaderProps}\n      customBackgroundColor={customBackgroundColor}\n    />\n  )\n}\n\nexport { DocumentViewerSelector }\n"],"names":["DocumentViewerSelector","isRpJsonLoading","rpjsonDocument","isPrivate","documentId","backTitle","disableBackButton","disableCheckbox","disableDocumentDiscovery","expression","onChange","onExclude","error","rpjsonHeaderOffset","pdfHeaderOffset","pdfBodyOffset","onAddToWatchlist","shouldUseScrollTrigger","viewerPaddingTop","isFromChat","customDocumentHeaderProps","customBackClick","customBackgroundColor","navigate","useNavigate","selectedDetection","setSelectedDetection","useState","undefined","handleClick","useDocumentViewerPageScrolling","useDocumentViewerPageVisited","LoadingSpinner","shouldShowPdfViewer","document","metadata","media_type","url","title","isTextBlock","content","text","name","provider_filename","PDFViewer","pdfUrl","RPJSONViewer"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BA2ISA;;;eAAAA;;;;uBA3IgB;gCACG;uBAE6B;gCAC1B;gDAEgB;8CACF;kEACvB;qEACG;;;;;;AA2BzB,SAASA,uBAAuB,EAC9BC,eAAe,EACfC,cAAc,EACdC,SAAS,EACTC,UAAU,EACVC,SAAS,EACTC,iBAAiB,EACjBC,eAAe,EACfC,wBAAwB,EACxBC,UAAU,EACVC,QAAQ,EACRC,SAAS,EACTC,KAAK,EACLC,kBAAkB,EAClBC,eAAe,EACfC,aAAa,EACbC,gBAAgB,EAChBC,yBAAyB,IAAI,EAC7BC,gBAAgB,EAChBC,aAAa,KAAK,EAClBC,yBAAyB,EACzBC,eAAe,EACfC,qBAAqB,EACO;IAC5B,MAAMC,WAAWC,IAAAA,2BAAW;IAC5B,MAAM,CAACC,mBAAmBC,qBAAqB,GAAGC,IAAAA,eAAQ,EACxDC;IAGF,MAAMC,cAAc;QAClB,IAAIR,iBAAiB;YACnBA;YACA;QACF;QAEAK,qBAAqBE;QACrBL,SAAS,CAAC;IACZ;IAEAO,IAAAA,8DAA8B,EAAC;QAAE1B;IAAW;IAC5C2B,IAAAA,0DAA4B,EAAC;QAAE3B;IAAW;IAE1C,IAAIH,mBAAmB,CAACC,gBAAgB;QACtC,qBAAO,qBAAC8B,8BAAc;IACxB;IAEA,MAAMC,sBACJ/B,CAAAA,2BAAAA,qCAAAA,eAAgBgC,QAAQ,CAACC,QAAQ,CAACC,UAAU,MAAK,qBAChDjC,CAAAA,aAAaD,eAAegC,QAAQ,CAACC,QAAQ,CAACE,GAAG,KAAKT,SAAQ;IAEjE,MAAMU,QACJpC,kBAAkBqC,IAAAA,kBAAW,EAACrC,eAAesC,OAAO,CAACF,KAAK,IACtDpC,eAAesC,OAAO,CAACF,KAAK,CAACG,IAAI,GACjC;IAEN,MAAMC,OAAOxC,eAAegC,QAAQ,CAACC,QAAQ,CAACQ,iBAAiB,IAAIL;IAEnE,IAAIL,qBAAqB;QACvB,qBACE,qBAACW,kBAAS;YACRtC,mBAAmBA;YACnBF,YAAYA;YACZC,WAAWA;YACXwB,aAAaA;YACba,MAAMA;YACNvC,WAAW,CAAC,CAACA;YACb0C,QAAQ3C,eAAegC,QAAQ,CAACC,QAAQ,CAACE,GAAG;YAC5CtB,eAAeA;YACfD,iBAAiBA;YACjBK,YAAYA;YACZC,2BAA2BA;;IAGjC;IAEA,qBACE,qBAAC0B,qBAAY;QACXzC,WAAWA;QACXC,mBAAmBA;QACnBC,iBAAiBA;QACjBC,0BAA0BA;QAC1BJ,YAAYA;QACZQ,OAAOA;QACPH,YAAYA;QACZoB,aAAaA;QACbhB,oBAAoBA;QACpBV,WAAW,CAAC,CAACA;QACbF,iBAAiBA;QACjBe,kBAAkBA;QAClBN,UAAUA;QACVC,WAAWA;QACXT,gBAAgBA;QAChBuB,mBAAmBA;QACnBC,sBAAsBA;QACtBT,wBAAwBA;QACxBC,kBAAkBA;QAClBwB,MAAMA;QACNtB,2BAA2BA;QAC3BE,uBAAuBA;;AAG7B"}