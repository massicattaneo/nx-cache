9d88c1161fd73164da0e50c49c1e0d98
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    FeedbackProvider: function() {
        return FeedbackProvider;
    },
    useFeedbackContext: function() {
        return useFeedbackContext;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _qs = /*#__PURE__*/ _interop_require_default(require("qs"));
const _reactrouterdom = require("react-router-dom");
const _hooks = require("@rp/react/web/common/hooks");
const _feedbacktypes = require("./feedback.types");
const _useRankingTypes = require("./useRankingTypes");
function _define_property(obj, key, value) {
    if (key in obj) {
        Object.defineProperty(obj, key, {
            value: value,
            enumerable: true,
            configurable: true,
            writable: true
        });
    } else {
        obj[key] = value;
    }
    return obj;
}
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
function _object_spread(target) {
    for(var i = 1; i < arguments.length; i++){
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
                return Object.getOwnPropertyDescriptor(source, sym).enumerable;
            }));
        }
        ownKeys.forEach(function(key) {
            _define_property(target, key, source[key]);
        });
    }
    return target;
}
function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
        var symbols = Object.getOwnPropertySymbols(object);
        if (enumerableOnly) {
            symbols = symbols.filter(function(sym) {
                return Object.getOwnPropertyDescriptor(object, sym).enumerable;
            });
        }
        keys.push.apply(keys, symbols);
    }
    return keys;
}
function _object_spread_props(target, source) {
    source = source != null ? source : {};
    if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
        ownKeys(Object(source)).forEach(function(key) {
            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
    }
    return target;
}
const getSearchIntent = (value)=>{
    const isSearchIntent = _feedbacktypes.searchIntentOptions.find((option)=>option.value === value);
    if (isSearchIntent) return value;
    return _feedbacktypes.searchIntentOptions[0].value;
};
const getPersonaType = (value)=>{
    const isPersonaType = _feedbacktypes.userTypeOptions.find((option)=>option.value === value);
    if (isPersonaType) return value;
    return _feedbacktypes.userTypeOptions[0].value;
};
const getPersonaSubType = (value)=>{
    const isPersonaSubType = _feedbacktypes.subTypeOptions.find((option)=>option.value === value);
    if (isPersonaSubType) return value;
    return _feedbacktypes.subTypeOptions[0].value;
};
const SEARCH_INTENT = "fsi";
const PERSONA_TYPE = "ft";
const PERSONA_SUBTYPE = "fst";
const DESCRIPTION = "fd";
const FeedbackContext = /*#__PURE__*/ (0, _react.createContext)(undefined);
const FeedbackProvider = ({ children, queryRanking, isFeedbackMode = false, setIsFeedbackMode, savedQuery, onUpdate })=>{
    const query = (0, _hooks.useQueryParams)();
    const [searchParams] = (0, _reactrouterdom.useSearchParams)();
    const navigate = (0, _reactrouterdom.useNavigate)();
    const [open, setOpen] = (0, _react.useState)(false);
    var _query_get;
    const querySearchIntent = (_query_get = query.get(SEARCH_INTENT)) !== null && _query_get !== void 0 ? _query_get : "";
    var _query_get1;
    const queryPersonaType = (_query_get1 = query.get(PERSONA_TYPE)) !== null && _query_get1 !== void 0 ? _query_get1 : "";
    var _query_get2;
    const queryPersonaSubType = (_query_get2 = query.get(PERSONA_SUBTYPE)) !== null && _query_get2 !== void 0 ? _query_get2 : "";
    var _query_get3;
    const queryDescription = (_query_get3 = query.get(DESCRIPTION)) !== null && _query_get3 !== void 0 ? _query_get3 : "";
    const { data } = (0, _useRankingTypes.useRankingTypes)(isFeedbackMode);
    // Feedback parameters
    const [rankingProfiles, setRankingProfiles] = (0, _react.useState)([]);
    const [rankingMode, setRankingMode] = (0, _react.useState)("");
    const [searchIntent, setSearchIntent] = (0, _react.useState)(getSearchIntent(querySearchIntent));
    const [userType, setUserType] = (0, _react.useState)(getPersonaType(queryPersonaType));
    const [subType, setSubType] = (0, _react.useState)(getPersonaSubType(queryPersonaSubType));
    const [description, setDescription] = (0, _react.useState)(queryDescription);
    const updateQueryRanking = (ranking)=>{
        if (!savedQuery) return;
        onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate({
            id: savedQuery.id,
            fields: {
                query: _object_spread_props(_object_spread({}, savedQuery.query), {
                    ranking
                })
            }
        });
    };
    (0, _react.useEffect)(()=>{
        if (queryRanking) {
            setRankingMode(queryRanking);
        }
    }, [
        queryRanking
    ]);
    (0, _react.useEffect)(()=>{
        if (isFeedbackMode && searchParams.get(SEARCH_INTENT) === searchIntent && searchParams.get(PERSONA_TYPE) === userType && searchParams.get(PERSONA_SUBTYPE) === subType && searchParams.get(DESCRIPTION) === description) return;
        if (isFeedbackMode) {
            const search = _qs.default.stringify({
                [SEARCH_INTENT]: searchIntent,
                [PERSONA_TYPE]: userType,
                [PERSONA_SUBTYPE]: subType,
                [DESCRIPTION]: description
            }, {
                encodeValuesOnly: true
            });
            navigate({
                search
            }, {
                replace: true
            });
        }
    // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [
        searchIntent,
        userType,
        subType,
        description,
        isFeedbackMode,
        navigate
    ]);
    (0, _react.useEffect)(()=>{
        if (data === null || data === void 0 ? void 0 : data.results) {
            setRankingProfiles(data.results);
        }
    }, [
        data
    ]);
    // Remove the query params "feedback" and clear all
    const clear = ()=>{
        query.delete("feedback");
        navigate({
            search: query.toString()
        }, {
            replace: true
        });
        setIsFeedbackMode === null || setIsFeedbackMode === void 0 ? void 0 : setIsFeedbackMode(false);
        setOpen(false);
    };
    const feedbackMode = {
        // Parameters (to send along useUpdateStoryCardFeedback)
        rankingMode,
        setRankingMode,
        updateQueryRanking,
        searchIntent,
        setSearchIntent,
        userType,
        setUserType,
        subType,
        setSubType,
        description,
        setDescription,
        rankingProfiles,
        // Status
        isFeedbackMode,
        clear,
        // Drawer
        open,
        setOpen,
        savedQuery
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(FeedbackContext.Provider, {
        value: feedbackMode,
        children: children
    });
};
const useFeedbackContext = ()=>{
    const context = (0, _react.useContext)(FeedbackContext);
    if (!context) {
        throw new Error("useFeedbackContext must be used within a FeedbackProvider");
    }
    return context;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvcmVhY3Qvd2ViL2NvbW1vbi9wcm92aWRlcnMvc3JjL0ZlZWRiYWNrQ29udGV4dC9GZWVkYmFja0NvbnRleHQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge1xuICBEaXNwYXRjaCxcbiAgUHJvcHNXaXRoQ2hpbGRyZW4sXG4gIGNyZWF0ZUNvbnRleHQsXG4gIHVzZUNvbnRleHQsXG4gIHVzZUVmZmVjdCxcbiAgdXNlU3RhdGUsXG59IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQgeyBTZXRTdGF0ZUFjdGlvbiB9IGZyb20gXCJqb3RhaVwiXG5pbXBvcnQgcXMgZnJvbSBcInFzXCJcbmltcG9ydCB7IHVzZU5hdmlnYXRlLCB1c2VTZWFyY2hQYXJhbXMgfSBmcm9tIFwicmVhY3Qtcm91dGVyLWRvbVwiXG5pbXBvcnQgeyBDcXNTYXZlZFF1ZXJ5LCBDcXNVc2VyRGF0YVF1ZXJpZXNQb3N0UmVxdWVzdCB9IGZyb20gXCJAcnAvY29tbW9uL2FwaS10eXBlc1wiXG5pbXBvcnQgeyBDcXNTYXZlZFF1ZXJ5Q29udGV4dCB9IGZyb20gXCJAcnAvY29tbW9uL2FwaS10eXBlc1wiXG5pbXBvcnQgeyB1c2VRdWVyeVBhcmFtcyB9IGZyb20gXCJAcnAvcmVhY3Qvd2ViL2NvbW1vbi9ob29rc1wiXG5pbXBvcnQgeyBVc2VNdXRhdGVBc3luY0Z1bmN0aW9uIH0gZnJvbSBcIkB0YW5zdGFjay9yZWFjdC1xdWVyeVwiXG5pbXBvcnQge1xuICBTZWFyY2hJbnRlbnQsXG4gIFN1YlR5cGVzLFxuICBVc2VyVHlwZXMsXG4gIHNlYXJjaEludGVudE9wdGlvbnMsXG4gIHN1YlR5cGVPcHRpb25zLFxuICB1c2VyVHlwZU9wdGlvbnMsXG59IGZyb20gXCIuL2ZlZWRiYWNrLnR5cGVzXCJcbmltcG9ydCB7IHVzZVJhbmtpbmdUeXBlcyB9IGZyb20gXCIuL3VzZVJhbmtpbmdUeXBlc1wiXG5cbnR5cGUgRmVlZGJhY2tUeXBlcyA9IHtcbiAgaXNGZWVkYmFja01vZGU6IGJvb2xlYW5cbiAgcmFua2luZ01vZGU6IHN0cmluZ1xuICBzZXRSYW5raW5nTW9kZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWRcbiAgdXBkYXRlUXVlcnlSYW5raW5nOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZFxuICBzZWFyY2hJbnRlbnQ6IFNlYXJjaEludGVudFxuICBzZXRTZWFyY2hJbnRlbnQ6ICh2YWx1ZTogU2VhcmNoSW50ZW50KSA9PiB2b2lkXG4gIHVzZXJUeXBlOiBVc2VyVHlwZXNcbiAgc2V0VXNlclR5cGU6ICh2YWx1ZTogVXNlclR5cGVzKSA9PiB2b2lkXG4gIHN1YlR5cGU6IFN1YlR5cGVzXG4gIHNldFN1YlR5cGU6ICh2YWx1ZTogU3ViVHlwZXMpID0+IHZvaWRcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBzZXREZXNjcmlwdGlvbjogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWRcbiAgcmFua2luZ1Byb2ZpbGVzOiBBcnJheTxzdHJpbmc+XG4gIGNsZWFyOiAoKSA9PiB2b2lkXG4gIG9wZW46IGJvb2xlYW5cbiAgc2V0T3BlbjogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkXG4gIHNhdmVkUXVlcnk6IENxc1NhdmVkUXVlcnlDb250ZXh0XG59XG5cbnR5cGUgUXVlcnlVcGRhdGUgPSB7XG4gIGlkOiBzdHJpbmdcbiAgZmllbGRzOiBDcXNVc2VyRGF0YVF1ZXJpZXNQb3N0UmVxdWVzdFxufVxuXG5jb25zdCBnZXRTZWFyY2hJbnRlbnQgPSAodmFsdWU6IHN0cmluZyk6IFNlYXJjaEludGVudCA9PiB7XG4gIGNvbnN0IGlzU2VhcmNoSW50ZW50ID0gc2VhcmNoSW50ZW50T3B0aW9ucy5maW5kKG9wdGlvbiA9PiBvcHRpb24udmFsdWUgPT09IHZhbHVlKVxuICBpZiAoaXNTZWFyY2hJbnRlbnQpIHJldHVybiB2YWx1ZSBhcyBTZWFyY2hJbnRlbnRcbiAgcmV0dXJuIHNlYXJjaEludGVudE9wdGlvbnNbMF0udmFsdWVcbn1cbmNvbnN0IGdldFBlcnNvbmFUeXBlID0gKHZhbHVlOiBzdHJpbmcpOiBVc2VyVHlwZXMgPT4ge1xuICBjb25zdCBpc1BlcnNvbmFUeXBlID0gdXNlclR5cGVPcHRpb25zLmZpbmQob3B0aW9uID0+IG9wdGlvbi52YWx1ZSA9PT0gdmFsdWUpXG4gIGlmIChpc1BlcnNvbmFUeXBlKSByZXR1cm4gdmFsdWUgYXMgVXNlclR5cGVzXG4gIHJldHVybiB1c2VyVHlwZU9wdGlvbnNbMF0udmFsdWVcbn1cbmNvbnN0IGdldFBlcnNvbmFTdWJUeXBlID0gKHZhbHVlOiBzdHJpbmcpOiBTdWJUeXBlcyA9PiB7XG4gIGNvbnN0IGlzUGVyc29uYVN1YlR5cGUgPSBzdWJUeXBlT3B0aW9ucy5maW5kKG9wdGlvbiA9PiBvcHRpb24udmFsdWUgPT09IHZhbHVlKVxuICBpZiAoaXNQZXJzb25hU3ViVHlwZSkgcmV0dXJuIHZhbHVlIGFzIFN1YlR5cGVzXG4gIHJldHVybiBzdWJUeXBlT3B0aW9uc1swXS52YWx1ZVxufVxuY29uc3QgU0VBUkNIX0lOVEVOVCA9IFwiZnNpXCJcbmNvbnN0IFBFUlNPTkFfVFlQRSA9IFwiZnRcIlxuY29uc3QgUEVSU09OQV9TVUJUWVBFID0gXCJmc3RcIlxuY29uc3QgREVTQ1JJUFRJT04gPSBcImZkXCJcblxuY29uc3QgRmVlZGJhY2tDb250ZXh0ID0gY3JlYXRlQ29udGV4dDxGZWVkYmFja1R5cGVzIHwgdW5kZWZpbmVkPih1bmRlZmluZWQpXG5cbnR5cGUgUHJvcHMgPSBQcm9wc1dpdGhDaGlsZHJlbiAmIHtcbiAgaXNGZWVkYmFja01vZGU/OiBib29sZWFuXG4gIHF1ZXJ5UmFua2luZz86IHN0cmluZ1xuICBzYXZlZFF1ZXJ5OiBDcXNTYXZlZFF1ZXJ5Q29udGV4dFxuICBzZXRJc0ZlZWRiYWNrTW9kZT86IERpc3BhdGNoPFNldFN0YXRlQWN0aW9uPGJvb2xlYW4+PlxuICBvblVwZGF0ZT86IFVzZU11dGF0ZUFzeW5jRnVuY3Rpb248Q3FzU2F2ZWRRdWVyeSwgRXJyb3IsIFF1ZXJ5VXBkYXRlPlxufVxuXG5jb25zdCBGZWVkYmFja1Byb3ZpZGVyID0gKHtcbiAgY2hpbGRyZW4sXG4gIHF1ZXJ5UmFua2luZyxcbiAgaXNGZWVkYmFja01vZGUgPSBmYWxzZSxcbiAgc2V0SXNGZWVkYmFja01vZGUsXG4gIHNhdmVkUXVlcnksXG4gIG9uVXBkYXRlLFxufTogUHJvcHMpID0+IHtcbiAgY29uc3QgcXVlcnkgPSB1c2VRdWVyeVBhcmFtcygpXG4gIGNvbnN0IFtzZWFyY2hQYXJhbXNdID0gdXNlU2VhcmNoUGFyYW1zKClcbiAgY29uc3QgbmF2aWdhdGUgPSB1c2VOYXZpZ2F0ZSgpXG4gIGNvbnN0IFtvcGVuLCBzZXRPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBxdWVyeVNlYXJjaEludGVudCA9IHF1ZXJ5LmdldChTRUFSQ0hfSU5URU5UKSA/PyBcIlwiXG4gIGNvbnN0IHF1ZXJ5UGVyc29uYVR5cGUgPSBxdWVyeS5nZXQoUEVSU09OQV9UWVBFKSA/PyBcIlwiXG4gIGNvbnN0IHF1ZXJ5UGVyc29uYVN1YlR5cGUgPSBxdWVyeS5nZXQoUEVSU09OQV9TVUJUWVBFKSA/PyBcIlwiXG4gIGNvbnN0IHF1ZXJ5RGVzY3JpcHRpb24gPSBxdWVyeS5nZXQoREVTQ1JJUFRJT04pID8/IFwiXCJcbiAgY29uc3QgeyBkYXRhIH0gPSB1c2VSYW5raW5nVHlwZXMoaXNGZWVkYmFja01vZGUpXG5cbiAgLy8gRmVlZGJhY2sgcGFyYW1ldGVyc1xuICBjb25zdCBbcmFua2luZ1Byb2ZpbGVzLCBzZXRSYW5raW5nUHJvZmlsZXNdID0gdXNlU3RhdGU8QXJyYXk8c3RyaW5nPj4oW10pXG4gIGNvbnN0IFtyYW5raW5nTW9kZSwgc2V0UmFua2luZ01vZGVdID0gdXNlU3RhdGUoXCJcIilcbiAgY29uc3QgW3NlYXJjaEludGVudCwgc2V0U2VhcmNoSW50ZW50XSA9IHVzZVN0YXRlPFNlYXJjaEludGVudD4oZ2V0U2VhcmNoSW50ZW50KHF1ZXJ5U2VhcmNoSW50ZW50KSlcbiAgY29uc3QgW3VzZXJUeXBlLCBzZXRVc2VyVHlwZV0gPSB1c2VTdGF0ZTxVc2VyVHlwZXM+KGdldFBlcnNvbmFUeXBlKHF1ZXJ5UGVyc29uYVR5cGUpKVxuICBjb25zdCBbc3ViVHlwZSwgc2V0U3ViVHlwZV0gPSB1c2VTdGF0ZTxTdWJUeXBlcz4oZ2V0UGVyc29uYVN1YlR5cGUocXVlcnlQZXJzb25hU3ViVHlwZSkpXG4gIGNvbnN0IFtkZXNjcmlwdGlvbiwgc2V0RGVzY3JpcHRpb25dID0gdXNlU3RhdGUocXVlcnlEZXNjcmlwdGlvbilcblxuICBjb25zdCB1cGRhdGVRdWVyeVJhbmtpbmcgPSAocmFua2luZzogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCFzYXZlZFF1ZXJ5KSByZXR1cm5cbiAgICBvblVwZGF0ZT8uKHsgaWQ6IHNhdmVkUXVlcnkuaWQsIGZpZWxkczogeyBxdWVyeTogeyAuLi5zYXZlZFF1ZXJ5LnF1ZXJ5LCByYW5raW5nIH0gfSB9KVxuICB9XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocXVlcnlSYW5raW5nKSB7XG4gICAgICBzZXRSYW5raW5nTW9kZShxdWVyeVJhbmtpbmcpXG4gICAgfVxuICB9LCBbcXVlcnlSYW5raW5nXSlcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChcbiAgICAgIGlzRmVlZGJhY2tNb2RlICYmXG4gICAgICBzZWFyY2hQYXJhbXMuZ2V0KFNFQVJDSF9JTlRFTlQpID09PSBzZWFyY2hJbnRlbnQgJiZcbiAgICAgIHNlYXJjaFBhcmFtcy5nZXQoUEVSU09OQV9UWVBFKSA9PT0gdXNlclR5cGUgJiZcbiAgICAgIHNlYXJjaFBhcmFtcy5nZXQoUEVSU09OQV9TVUJUWVBFKSA9PT0gc3ViVHlwZSAmJlxuICAgICAgc2VhcmNoUGFyYW1zLmdldChERVNDUklQVElPTikgPT09IGRlc2NyaXB0aW9uXG4gICAgKVxuICAgICAgcmV0dXJuXG4gICAgaWYgKGlzRmVlZGJhY2tNb2RlKSB7XG4gICAgICBjb25zdCBzZWFyY2ggPSBxcy5zdHJpbmdpZnkoXG4gICAgICAgIHtcbiAgICAgICAgICBbU0VBUkNIX0lOVEVOVF06IHNlYXJjaEludGVudCxcbiAgICAgICAgICBbUEVSU09OQV9UWVBFXTogdXNlclR5cGUsXG4gICAgICAgICAgW1BFUlNPTkFfU1VCVFlQRV06IHN1YlR5cGUsXG4gICAgICAgICAgW0RFU0NSSVBUSU9OXTogZGVzY3JpcHRpb24sXG4gICAgICAgIH0sXG4gICAgICAgIHsgZW5jb2RlVmFsdWVzT25seTogdHJ1ZSB9LFxuICAgICAgKVxuICAgICAgbmF2aWdhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICBzZWFyY2gsXG4gICAgICAgIH0sXG4gICAgICAgIHsgcmVwbGFjZTogdHJ1ZSB9LFxuICAgICAgKVxuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtzZWFyY2hJbnRlbnQsIHVzZXJUeXBlLCBzdWJUeXBlLCBkZXNjcmlwdGlvbiwgaXNGZWVkYmFja01vZGUsIG5hdmlnYXRlXSlcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChkYXRhPy5yZXN1bHRzKSB7XG4gICAgICBzZXRSYW5raW5nUHJvZmlsZXMoZGF0YS5yZXN1bHRzKVxuICAgIH1cbiAgfSwgW2RhdGFdKVxuICAvLyBSZW1vdmUgdGhlIHF1ZXJ5IHBhcmFtcyBcImZlZWRiYWNrXCIgYW5kIGNsZWFyIGFsbFxuICBjb25zdCBjbGVhciA9ICgpID0+IHtcbiAgICBxdWVyeS5kZWxldGUoXCJmZWVkYmFja1wiKVxuICAgIG5hdmlnYXRlKFxuICAgICAge1xuICAgICAgICBzZWFyY2g6IHF1ZXJ5LnRvU3RyaW5nKCksXG4gICAgICB9LFxuICAgICAgeyByZXBsYWNlOiB0cnVlIH0sXG4gICAgKVxuICAgIHNldElzRmVlZGJhY2tNb2RlPy4oZmFsc2UpXG4gICAgc2V0T3BlbihmYWxzZSlcbiAgfVxuXG4gIGNvbnN0IGZlZWRiYWNrTW9kZSA9IHtcbiAgICAvLyBQYXJhbWV0ZXJzICh0byBzZW5kIGFsb25nIHVzZVVwZGF0ZVN0b3J5Q2FyZEZlZWRiYWNrKVxuICAgIHJhbmtpbmdNb2RlLFxuICAgIHNldFJhbmtpbmdNb2RlLFxuICAgIHVwZGF0ZVF1ZXJ5UmFua2luZyxcbiAgICBzZWFyY2hJbnRlbnQsXG4gICAgc2V0U2VhcmNoSW50ZW50LFxuICAgIHVzZXJUeXBlLFxuICAgIHNldFVzZXJUeXBlLFxuICAgIHN1YlR5cGUsXG4gICAgc2V0U3ViVHlwZSxcbiAgICBkZXNjcmlwdGlvbixcbiAgICBzZXREZXNjcmlwdGlvbixcbiAgICByYW5raW5nUHJvZmlsZXMsXG4gICAgLy8gU3RhdHVzXG4gICAgaXNGZWVkYmFja01vZGUsXG4gICAgY2xlYXIsXG4gICAgLy8gRHJhd2VyXG4gICAgb3BlbixcbiAgICBzZXRPcGVuLFxuICAgIHNhdmVkUXVlcnksXG4gIH1cbiAgcmV0dXJuIDxGZWVkYmFja0NvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2ZlZWRiYWNrTW9kZX0+e2NoaWxkcmVufTwvRmVlZGJhY2tDb250ZXh0LlByb3ZpZGVyPlxufVxuXG5jb25zdCB1c2VGZWVkYmFja0NvbnRleHQgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KEZlZWRiYWNrQ29udGV4dClcbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwidXNlRmVlZGJhY2tDb250ZXh0IG11c3QgYmUgdXNlZCB3aXRoaW4gYSBGZWVkYmFja1Byb3ZpZGVyXCIpXG4gIH1cbiAgcmV0dXJuIGNvbnRleHRcbn1cblxuZXhwb3J0IHsgdXNlRmVlZGJhY2tDb250ZXh0LCBGZWVkYmFja1Byb3ZpZGVyIH1cbiJdLCJuYW1lcyI6WyJGZWVkYmFja1Byb3ZpZGVyIiwidXNlRmVlZGJhY2tDb250ZXh0IiwiZ2V0U2VhcmNoSW50ZW50IiwidmFsdWUiLCJpc1NlYXJjaEludGVudCIsInNlYXJjaEludGVudE9wdGlvbnMiLCJmaW5kIiwib3B0aW9uIiwiZ2V0UGVyc29uYVR5cGUiLCJpc1BlcnNvbmFUeXBlIiwidXNlclR5cGVPcHRpb25zIiwiZ2V0UGVyc29uYVN1YlR5cGUiLCJpc1BlcnNvbmFTdWJUeXBlIiwic3ViVHlwZU9wdGlvbnMiLCJTRUFSQ0hfSU5URU5UIiwiUEVSU09OQV9UWVBFIiwiUEVSU09OQV9TVUJUWVBFIiwiREVTQ1JJUFRJT04iLCJGZWVkYmFja0NvbnRleHQiLCJjcmVhdGVDb250ZXh0IiwidW5kZWZpbmVkIiwiY2hpbGRyZW4iLCJxdWVyeVJhbmtpbmciLCJpc0ZlZWRiYWNrTW9kZSIsInNldElzRmVlZGJhY2tNb2RlIiwic2F2ZWRRdWVyeSIsIm9uVXBkYXRlIiwicXVlcnkiLCJ1c2VRdWVyeVBhcmFtcyIsInNlYXJjaFBhcmFtcyIsInVzZVNlYXJjaFBhcmFtcyIsIm5hdmlnYXRlIiwidXNlTmF2aWdhdGUiLCJvcGVuIiwic2V0T3BlbiIsInVzZVN0YXRlIiwicXVlcnlTZWFyY2hJbnRlbnQiLCJnZXQiLCJxdWVyeVBlcnNvbmFUeXBlIiwicXVlcnlQZXJzb25hU3ViVHlwZSIsInF1ZXJ5RGVzY3JpcHRpb24iLCJkYXRhIiwidXNlUmFua2luZ1R5cGVzIiwicmFua2luZ1Byb2ZpbGVzIiwic2V0UmFua2luZ1Byb2ZpbGVzIiwicmFua2luZ01vZGUiLCJzZXRSYW5raW5nTW9kZSIsInNlYXJjaEludGVudCIsInNldFNlYXJjaEludGVudCIsInVzZXJUeXBlIiwic2V0VXNlclR5cGUiLCJzdWJUeXBlIiwic2V0U3ViVHlwZSIsImRlc2NyaXB0aW9uIiwic2V0RGVzY3JpcHRpb24iLCJ1cGRhdGVRdWVyeVJhbmtpbmciLCJyYW5raW5nIiwiaWQiLCJmaWVsZHMiLCJ1c2VFZmZlY3QiLCJzZWFyY2giLCJxcyIsInN0cmluZ2lmeSIsImVuY29kZVZhbHVlc09ubHkiLCJyZXBsYWNlIiwicmVzdWx0cyIsImNsZWFyIiwiZGVsZXRlIiwidG9TdHJpbmciLCJmZWVkYmFja01vZGUiLCJQcm92aWRlciIsImNvbnRleHQiLCJ1c2VDb250ZXh0IiwiRXJyb3IiXSwicmFuZ2VNYXBwaW5n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