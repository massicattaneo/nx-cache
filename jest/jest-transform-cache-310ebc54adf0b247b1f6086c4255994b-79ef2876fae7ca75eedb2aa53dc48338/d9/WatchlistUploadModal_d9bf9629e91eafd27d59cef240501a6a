5689ee0f900b41f4b76d92a330042530
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "WatchlistUploadModal", {
    enumerable: true,
    get: function() {
        return WatchlistUploadModal;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _customerio = require("@rp/react/common/customer-io");
const _providers = require("@rp/react/web/common/providers");
const _core = require("@rp/react/web/mui/core");
const _WatchlistUploadModalContainer = require("./WatchlistUploadModalContainer");
const WatchlistUploadModal = ({ onAdd, open, setOpen, watchlist, buttonRef, isUploading, onDropFiles, uploadedData, error })=>{
    const { enqueueSuccess } = (0, _providers.useSnackbar)();
    if (!open) return null;
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(_WatchlistUploadModalContainer.WatchlistUploadModalContainer, {
        onSubmit: async (entities, stats)=>{
            const ids = entities.map((entity)=>{
                var _entity_key;
                return (_entity_key = entity === null || entity === void 0 ? void 0 : entity.key) !== null && _entity_key !== void 0 ? _entity_key : "";
            });
            setOpen(false);
            const updatedWatchlist = await onAdd(entities);
            if (ids.length > 0) {
                enqueueSuccess(/*#__PURE__*/ (0, _jsxruntime.jsxs)(_core.Box, {
                    children: [
                        ids.length,
                        " ",
                        ids.length === 1 ? "entity was" : "entities were",
                        " added to",
                        " ",
                        /*#__PURE__*/ (0, _jsxruntime.jsx)(_core.Box, {
                            component: "span",
                            fontWeight: 700,
                            children: watchlist.name
                        }),
                        "."
                    ]
                }));
            }
            if (!uploadedData) return;
            if (!updatedWatchlist) return;
            _customerio.watchlistCustomerIo.uploadModal.sendSubmit({
                watchlistId: updatedWatchlist.id,
                previousItems: watchlist.items.length,
                submitted: uploadedData.submitted,
                conflicts: uploadedData.submitted - uploadedData.matched,
                conflictsUnresolved: stats.conflicts.unresolved,
                conflictsResolved: stats.conflicts.resolved,
                conflictsDeleted: stats.conflicts.deleted,
                matched: uploadedData.matched,
                matchedUnmodified: stats.matched.unmodified,
                matchedModified: stats.matched.modified,
                matchedDeleted: stats.matched.deleted,
                addedItems: ids.length
            });
            _customerio.watchlistCustomerIo.uploadModal.reset();
        },
        watchlist: watchlist,
        error: error,
        onBrowse: ()=>{
            var _buttonRef_current;
            (_buttonRef_current = buttonRef.current) === null || _buttonRef_current === void 0 ? void 0 : _buttonRef_current.open().then(()=>{
                _customerio.watchlistCustomerIo.uploadModal.setUploadMethod("browseFromModal");
            });
        },
        isUploading: isUploading,
        open: open,
        onClose: ()=>{
            _customerio.watchlistCustomerIo.uploadModal.sendCancel({
                submitted: uploadedData ? uploadedData.submitted : undefined,
                conflicts: uploadedData ? uploadedData.submitted - uploadedData.matched : undefined,
                matched: uploadedData ? uploadedData.matched : undefined,
                previousItems: watchlist.items.length,
                watchlistId: watchlist.id
            });
            _customerio.watchlistCustomerIo.uploadModal.reset();
            setOpen(false);
        },
        onDropFiles: onDropFiles,
        data: uploadedData,
        onFilesRejected: ({ error })=>{
            _customerio.watchlistCustomerIo.uploadModal.setUploadMethod("dropOnModal");
            _customerio.watchlistCustomerIo.uploadModal.sendError(watchlist.id, error);
        }
    });
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvcmVhY3Qvd2ViL3dhdGNobGlzdHMvc3JjL2xpYi9XYXRjaGxpc3RVcGxvYWRNb2RhbC9XYXRjaGxpc3RVcGxvYWRNb2RhbC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVmT2JqZWN0IH0gZnJvbSBcInJlYWN0XCJcbmltcG9ydCB7IFdhdGNobGlzdCB9IGZyb20gXCJAcnAvY29tbW9uL2FwaS10eXBlc1wiXG5pbXBvcnQgeyB3YXRjaGxpc3RDdXN0b21lcklvIH0gZnJvbSBcIkBycC9yZWFjdC9jb21tb24vY3VzdG9tZXItaW9cIlxuaW1wb3J0IHtcbiAgQmF0Y2hFbnRpdHlTdWdnZXN0aW9uLFxuICBXYXRjaGxpc3RCYXRjaFN1Z2dlc3Rpb25Qb3N0UmVzcG9uc2VFeHRlbmRlZCxcbn0gZnJvbSBcIkBycC9yZWFjdC90YW5zdGFjay1hcGkvc3VnZ2VzdGlvblwiXG5pbXBvcnQgeyBVcGxvYWRJbnB1dFJlZiB9IGZyb20gXCJAcnAvcmVhY3Qvd2ViL2NvbW1vbi9iYXNlLWNvbXBvbmVudHNcIlxuaW1wb3J0IHsgdXNlU25hY2tiYXIgfSBmcm9tIFwiQHJwL3JlYWN0L3dlYi9jb21tb24vcHJvdmlkZXJzXCJcbmltcG9ydCB7IEJveCB9IGZyb20gXCJAcnAvcmVhY3Qvd2ViL211aS9jb3JlXCJcbmltcG9ydCB7IFdhdGNobGlzdFVwbG9hZE1vZGFsQ29udGFpbmVyIH0gZnJvbSBcIi4vV2F0Y2hsaXN0VXBsb2FkTW9kYWxDb250YWluZXJcIlxuXG50eXBlIFByb3BzID0ge1xuICBvbkFkZDogKGlkczogQXJyYXk8QmF0Y2hFbnRpdHlTdWdnZXN0aW9uPikgPT4gUHJvbWlzZTxXYXRjaGxpc3QgfCB1bmRlZmluZWQ+XG4gIG9wZW46IGJvb2xlYW5cbiAgc2V0T3BlbjogKG9wZW46IGJvb2xlYW4pID0+IHZvaWRcbiAgd2F0Y2hsaXN0OiBXYXRjaGxpc3RcbiAgYnV0dG9uUmVmOiBSZWZPYmplY3Q8VXBsb2FkSW5wdXRSZWYgfCBudWxsPlxuICBpc1VwbG9hZGluZzogYm9vbGVhblxuICBvbkRyb3BGaWxlczogKGZpbGVzOiBBcnJheTxGaWxlPikgPT4gdm9pZFxuICB1cGxvYWRlZERhdGE6IFdhdGNobGlzdEJhdGNoU3VnZ2VzdGlvblBvc3RSZXNwb25zZUV4dGVuZGVkIHwgbnVsbFxuICBlcnJvcjogRXJyb3IgfCBudWxsXG59XG5cbmV4cG9ydCBjb25zdCBXYXRjaGxpc3RVcGxvYWRNb2RhbCA9ICh7XG4gIG9uQWRkLFxuICBvcGVuLFxuICBzZXRPcGVuLFxuICB3YXRjaGxpc3QsXG4gIGJ1dHRvblJlZixcbiAgaXNVcGxvYWRpbmcsXG4gIG9uRHJvcEZpbGVzLFxuICB1cGxvYWRlZERhdGEsXG4gIGVycm9yLFxufTogUHJvcHMpID0+IHtcbiAgY29uc3QgeyBlbnF1ZXVlU3VjY2VzcyB9ID0gdXNlU25hY2tiYXIoKVxuICBpZiAoIW9wZW4pIHJldHVybiBudWxsXG4gIHJldHVybiAoXG4gICAgPFdhdGNobGlzdFVwbG9hZE1vZGFsQ29udGFpbmVyXG4gICAgICBvblN1Ym1pdD17YXN5bmMgKGVudGl0aWVzLCBzdGF0cykgPT4ge1xuICAgICAgICBjb25zdCBpZHMgPSBlbnRpdGllcy5tYXAoZW50aXR5ID0+IGVudGl0eT8ua2V5ID8/IFwiXCIpXG4gICAgICAgIHNldE9wZW4oZmFsc2UpXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRXYXRjaGxpc3QgPSBhd2FpdCBvbkFkZChlbnRpdGllcylcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZW5xdWV1ZVN1Y2Nlc3MoXG4gICAgICAgICAgICA8Qm94PlxuICAgICAgICAgICAgICB7aWRzLmxlbmd0aH0ge2lkcy5sZW5ndGggPT09IDEgPyBcImVudGl0eSB3YXNcIiA6IFwiZW50aXRpZXMgd2VyZVwifSBhZGRlZCB0b3tcIiBcIn1cbiAgICAgICAgICAgICAgPEJveCBjb21wb25lbnQ9XCJzcGFuXCIgZm9udFdlaWdodD17NzAwfT5cbiAgICAgICAgICAgICAgICB7d2F0Y2hsaXN0Lm5hbWV9XG4gICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAuXG4gICAgICAgICAgICA8L0JveD4sXG4gICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIGlmICghdXBsb2FkZWREYXRhKSByZXR1cm5cbiAgICAgICAgaWYgKCF1cGRhdGVkV2F0Y2hsaXN0KSByZXR1cm5cbiAgICAgICAgd2F0Y2hsaXN0Q3VzdG9tZXJJby51cGxvYWRNb2RhbC5zZW5kU3VibWl0KHtcbiAgICAgICAgICB3YXRjaGxpc3RJZDogdXBkYXRlZFdhdGNobGlzdC5pZCxcbiAgICAgICAgICBwcmV2aW91c0l0ZW1zOiB3YXRjaGxpc3QuaXRlbXMubGVuZ3RoLFxuICAgICAgICAgIHN1Ym1pdHRlZDogdXBsb2FkZWREYXRhLnN1Ym1pdHRlZCxcbiAgICAgICAgICBjb25mbGljdHM6IHVwbG9hZGVkRGF0YS5zdWJtaXR0ZWQgLSB1cGxvYWRlZERhdGEubWF0Y2hlZCxcbiAgICAgICAgICBjb25mbGljdHNVbnJlc29sdmVkOiBzdGF0cy5jb25mbGljdHMudW5yZXNvbHZlZCxcbiAgICAgICAgICBjb25mbGljdHNSZXNvbHZlZDogc3RhdHMuY29uZmxpY3RzLnJlc29sdmVkLFxuICAgICAgICAgIGNvbmZsaWN0c0RlbGV0ZWQ6IHN0YXRzLmNvbmZsaWN0cy5kZWxldGVkLFxuICAgICAgICAgIG1hdGNoZWQ6IHVwbG9hZGVkRGF0YS5tYXRjaGVkLFxuICAgICAgICAgIG1hdGNoZWRVbm1vZGlmaWVkOiBzdGF0cy5tYXRjaGVkLnVubW9kaWZpZWQsXG4gICAgICAgICAgbWF0Y2hlZE1vZGlmaWVkOiBzdGF0cy5tYXRjaGVkLm1vZGlmaWVkLFxuICAgICAgICAgIG1hdGNoZWREZWxldGVkOiBzdGF0cy5tYXRjaGVkLmRlbGV0ZWQsXG4gICAgICAgICAgYWRkZWRJdGVtczogaWRzLmxlbmd0aCxcbiAgICAgICAgfSlcbiAgICAgICAgd2F0Y2hsaXN0Q3VzdG9tZXJJby51cGxvYWRNb2RhbC5yZXNldCgpXG4gICAgICB9fVxuICAgICAgd2F0Y2hsaXN0PXt3YXRjaGxpc3R9XG4gICAgICBlcnJvcj17ZXJyb3J9XG4gICAgICBvbkJyb3dzZT17KCkgPT4ge1xuICAgICAgICBidXR0b25SZWYuY3VycmVudD8ub3BlbigpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHdhdGNobGlzdEN1c3RvbWVySW8udXBsb2FkTW9kYWwuc2V0VXBsb2FkTWV0aG9kKFwiYnJvd3NlRnJvbU1vZGFsXCIpXG4gICAgICAgIH0pXG4gICAgICB9fVxuICAgICAgaXNVcGxvYWRpbmc9e2lzVXBsb2FkaW5nfVxuICAgICAgb3Blbj17b3Blbn1cbiAgICAgIG9uQ2xvc2U9eygpID0+IHtcbiAgICAgICAgd2F0Y2hsaXN0Q3VzdG9tZXJJby51cGxvYWRNb2RhbC5zZW5kQ2FuY2VsKHtcbiAgICAgICAgICBzdWJtaXR0ZWQ6IHVwbG9hZGVkRGF0YSA/IHVwbG9hZGVkRGF0YS5zdWJtaXR0ZWQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgY29uZmxpY3RzOiB1cGxvYWRlZERhdGEgPyB1cGxvYWRlZERhdGEuc3VibWl0dGVkIC0gdXBsb2FkZWREYXRhLm1hdGNoZWQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgbWF0Y2hlZDogdXBsb2FkZWREYXRhID8gdXBsb2FkZWREYXRhLm1hdGNoZWQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgcHJldmlvdXNJdGVtczogd2F0Y2hsaXN0Lml0ZW1zLmxlbmd0aCxcbiAgICAgICAgICB3YXRjaGxpc3RJZDogd2F0Y2hsaXN0LmlkLFxuICAgICAgICB9KVxuICAgICAgICB3YXRjaGxpc3RDdXN0b21lcklvLnVwbG9hZE1vZGFsLnJlc2V0KClcbiAgICAgICAgc2V0T3BlbihmYWxzZSlcbiAgICAgIH19XG4gICAgICBvbkRyb3BGaWxlcz17b25Ecm9wRmlsZXN9XG4gICAgICBkYXRhPXt1cGxvYWRlZERhdGF9XG4gICAgICBvbkZpbGVzUmVqZWN0ZWQ9eyh7IGVycm9yIH0pID0+IHtcbiAgICAgICAgd2F0Y2hsaXN0Q3VzdG9tZXJJby51cGxvYWRNb2RhbC5zZXRVcGxvYWRNZXRob2QoXCJkcm9wT25Nb2RhbFwiKVxuICAgICAgICB3YXRjaGxpc3RDdXN0b21lcklvLnVwbG9hZE1vZGFsLnNlbmRFcnJvcih3YXRjaGxpc3QuaWQsIGVycm9yKVxuICAgICAgfX1cbiAgICAvPlxuICApXG59XG4iXSwibmFtZXMiOlsiV2F0Y2hsaXN0VXBsb2FkTW9kYWwiLCJvbkFkZCIsIm9wZW4iLCJzZXRPcGVuIiwid2F0Y2hsaXN0IiwiYnV0dG9uUmVmIiwiaXNVcGxvYWRpbmciLCJvbkRyb3BGaWxlcyIsInVwbG9hZGVkRGF0YSIsImVycm9yIiwiZW5xdWV1ZVN1Y2Nlc3MiLCJ1c2VTbmFja2JhciIsIldhdGNobGlzdFVwbG9hZE1vZGFsQ29udGFpbmVyIiwib25TdWJtaXQiLCJlbnRpdGllcyIsInN0YXRzIiwiaWRzIiwibWFwIiwiZW50aXR5Iiwia2V5IiwidXBkYXRlZFdhdGNobGlzdCIsImxlbmd0aCIsIkJveCIsImNvbXBvbmVudCIsImZvbnRXZWlnaHQiLCJuYW1lIiwid2F0Y2hsaXN0Q3VzdG9tZXJJbyIsInVwbG9hZE1vZGFsIiwic2VuZFN1Ym1pdCIsIndhdGNobGlzdElkIiwiaWQiLCJwcmV2aW91c0l0ZW1zIiwiaXRlbXMiLCJzdWJtaXR0ZWQiLCJjb25mbGljdHMiLCJtYXRjaGVkIiwiY29uZmxpY3RzVW5yZXNvbHZlZCIsInVucmVzb2x2ZWQiLCJjb25mbGljdHNSZXNvbHZlZCIsInJlc29sdmVkIiwiY29uZmxpY3RzRGVsZXRlZCIsImRlbGV0ZWQiLCJtYXRjaGVkVW5tb2RpZmllZCIsInVubW9kaWZpZWQiLCJtYXRjaGVkTW9kaWZpZWQiLCJtb2RpZmllZCIsIm1hdGNoZWREZWxldGVkIiwiYWRkZWRJdGVtcyIsInJlc2V0Iiwib25Ccm93c2UiLCJjdXJyZW50IiwidGhlbiIsInNldFVwbG9hZE1ldGhvZCIsIm9uQ2xvc2UiLCJzZW5kQ2FuY2VsIiwidW5kZWZpbmVkIiwiZGF0YSIsIm9uRmlsZXNSZWplY3RlZCIsInNlbmRFcnJvciJdLCJyYW5nZU1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsiLCJtYXBwaW5ncyI6Ijs7OzsrQkF3QmFBOzs7ZUFBQUE7Ozs7NEJBdEJ1QjsyQkFNUjtzQkFDUjsrQ0FDMEI7QUFjdkMsTUFBTUEsdUJBQXVCLENBQUMsRUFDbkNDLEtBQUssRUFDTEMsSUFBSSxFQUNKQyxPQUFPLEVBQ1BDLFNBQVMsRUFDVEMsU0FBUyxFQUNUQyxXQUFXLEVBQ1hDLFdBQVcsRUFDWEMsWUFBWSxFQUNaQyxLQUFLLEVBQ0M7SUFDTixNQUFNLEVBQUVDLGNBQWMsRUFBRSxHQUFHQyxJQUFBQSxzQkFBVztJQUN0QyxJQUFJLENBQUNULE1BQU0sT0FBTztJQUNsQixxQkFDRSxxQkFBQ1UsNERBQTZCO1FBQzVCQyxVQUFVLE9BQU9DLFVBQVVDO1lBQ3pCLE1BQU1DLE1BQU1GLFNBQVNHLEdBQUcsQ0FBQ0MsQ0FBQUE7b0JBQVVBO3VCQUFBQSxDQUFBQSxjQUFBQSxtQkFBQUEsNkJBQUFBLE9BQVFDLEdBQUcsY0FBWEQseUJBQUFBLGNBQWU7WUFBQztZQUNuRGYsUUFBUTtZQUNSLE1BQU1pQixtQkFBbUIsTUFBTW5CLE1BQU1hO1lBQ3JDLElBQUlFLElBQUlLLE1BQU0sR0FBRyxHQUFHO2dCQUNsQlgsNkJBQ0Usc0JBQUNZLFNBQUc7O3dCQUNETixJQUFJSyxNQUFNO3dCQUFDO3dCQUFFTCxJQUFJSyxNQUFNLEtBQUssSUFBSSxlQUFlO3dCQUFnQjt3QkFBVTtzQ0FDMUUscUJBQUNDLFNBQUc7NEJBQUNDLFdBQVU7NEJBQU9DLFlBQVk7c0NBQy9CcEIsVUFBVXFCLElBQUk7O3dCQUNYOzs7WUFJWjtZQUNBLElBQUksQ0FBQ2pCLGNBQWM7WUFDbkIsSUFBSSxDQUFDWSxrQkFBa0I7WUFDdkJNLCtCQUFtQixDQUFDQyxXQUFXLENBQUNDLFVBQVUsQ0FBQztnQkFDekNDLGFBQWFULGlCQUFpQlUsRUFBRTtnQkFDaENDLGVBQWUzQixVQUFVNEIsS0FBSyxDQUFDWCxNQUFNO2dCQUNyQ1ksV0FBV3pCLGFBQWF5QixTQUFTO2dCQUNqQ0MsV0FBVzFCLGFBQWF5QixTQUFTLEdBQUd6QixhQUFhMkIsT0FBTztnQkFDeERDLHFCQUFxQnJCLE1BQU1tQixTQUFTLENBQUNHLFVBQVU7Z0JBQy9DQyxtQkFBbUJ2QixNQUFNbUIsU0FBUyxDQUFDSyxRQUFRO2dCQUMzQ0Msa0JBQWtCekIsTUFBTW1CLFNBQVMsQ0FBQ08sT0FBTztnQkFDekNOLFNBQVMzQixhQUFhMkIsT0FBTztnQkFDN0JPLG1CQUFtQjNCLE1BQU1vQixPQUFPLENBQUNRLFVBQVU7Z0JBQzNDQyxpQkFBaUI3QixNQUFNb0IsT0FBTyxDQUFDVSxRQUFRO2dCQUN2Q0MsZ0JBQWdCL0IsTUFBTW9CLE9BQU8sQ0FBQ00sT0FBTztnQkFDckNNLFlBQVkvQixJQUFJSyxNQUFNO1lBQ3hCO1lBQ0FLLCtCQUFtQixDQUFDQyxXQUFXLENBQUNxQixLQUFLO1FBQ3ZDO1FBQ0E1QyxXQUFXQTtRQUNYSyxPQUFPQTtRQUNQd0MsVUFBVTtnQkFDUjVDO2FBQUFBLHFCQUFBQSxVQUFVNkMsT0FBTyxjQUFqQjdDLHlDQUFBQSxtQkFBbUJILElBQUksR0FBR2lELElBQUksQ0FBQztnQkFDN0J6QiwrQkFBbUIsQ0FBQ0MsV0FBVyxDQUFDeUIsZUFBZSxDQUFDO1lBQ2xEO1FBQ0Y7UUFDQTlDLGFBQWFBO1FBQ2JKLE1BQU1BO1FBQ05tRCxTQUFTO1lBQ1AzQiwrQkFBbUIsQ0FBQ0MsV0FBVyxDQUFDMkIsVUFBVSxDQUFDO2dCQUN6Q3JCLFdBQVd6QixlQUFlQSxhQUFheUIsU0FBUyxHQUFHc0I7Z0JBQ25EckIsV0FBVzFCLGVBQWVBLGFBQWF5QixTQUFTLEdBQUd6QixhQUFhMkIsT0FBTyxHQUFHb0I7Z0JBQzFFcEIsU0FBUzNCLGVBQWVBLGFBQWEyQixPQUFPLEdBQUdvQjtnQkFDL0N4QixlQUFlM0IsVUFBVTRCLEtBQUssQ0FBQ1gsTUFBTTtnQkFDckNRLGFBQWF6QixVQUFVMEIsRUFBRTtZQUMzQjtZQUNBSiwrQkFBbUIsQ0FBQ0MsV0FBVyxDQUFDcUIsS0FBSztZQUNyQzdDLFFBQVE7UUFDVjtRQUNBSSxhQUFhQTtRQUNiaUQsTUFBTWhEO1FBQ05pRCxpQkFBaUIsQ0FBQyxFQUFFaEQsS0FBSyxFQUFFO1lBQ3pCaUIsK0JBQW1CLENBQUNDLFdBQVcsQ0FBQ3lCLGVBQWUsQ0FBQztZQUNoRDFCLCtCQUFtQixDQUFDQyxXQUFXLENBQUMrQixTQUFTLENBQUN0RCxVQUFVMEIsRUFBRSxFQUFFckI7UUFDMUQ7O0FBR04ifQ==