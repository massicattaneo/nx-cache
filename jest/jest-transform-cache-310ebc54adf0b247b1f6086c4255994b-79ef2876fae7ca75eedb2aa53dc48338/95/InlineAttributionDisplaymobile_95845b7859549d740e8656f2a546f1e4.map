{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/Chat/ChatResponse/InlineAttribution/InlineAttributionDisplay.mobile.tsx"],"sourcesContent":["import { useState } from \"react\"\nimport { Swiper, SwiperSlide } from \"swiper/react\"\nimport { getTimePassed } from \"@rp/common/utils\"\nimport { DocumentIcon } from \"@rp/react/web/common/composite-components\"\nimport { useSourceImage } from \"@rp/react/web/common/providers\"\nimport { Box, Button, Skeleton, Typography } from \"@rp/react/web/mui/core\"\nimport { ExternalFavicon } from \"../ExternalFavicon\"\nimport { removeSnippetEllipsisSpace } from \"../removeSnippetEllipsisSpace\"\nimport { InlineAttributionSelector } from \"./InlineAttributionSelector\"\nimport { GroupedInlineAttributionList } from \"./getInlineAttributionData\"\n\ntype Props = {\n  attributions: GroupedInlineAttributionList\n  selectedAttribution: number\n  setSelectedAttribution: (index: number) => void\n}\nconst InlineAttributionDisplayMobile = ({\n  attributions,\n  selectedAttribution,\n  setSelectedAttribution,\n}: Props) => {\n  const [selectedChunk, setSelectedChunk] = useState(0)\n  const matches = attributions[selectedAttribution].data\n  const data = matches[selectedChunk]\n  const { hd, sourceName, ts } = matches[0]\n\n  const setAttributionAndResetChunk = (id: number) => {\n    setSelectedChunk(0)\n    setSelectedAttribution(id)\n  }\n\n  const [relatedSource, documentScope, contentType, srcKey, language] =\n    data.type === \"CQS\"\n      ? [data.relatedSource, data.documentScope, data.contentType, data.srcKey, data.language]\n      : []\n  const [externalFavicon] = data.type === \"EXTERNAL\" ? [data.externalFavicon] : []\n\n  const { isLoaded, src, hasError } = useSourceImage(relatedSource ? [relatedSource] : [])\n\n  const image = isLoaded ? (\n    <img alt={hd} src={src} />\n  ) : (\n    <Skeleton height=\"100%\" sx={{ transform: \"none\" }} />\n  )\n\n  return (\n    <Box\n      sx={{\n        py: 2.5,\n        bgcolor: \"elevation.dp24\",\n        borderTopLeftRadius: 12,\n        borderTopRightRadius: 12,\n        overflow: \"hidden\",\n      }}\n    >\n      {attributions.length > 1 ? (\n        <InlineAttributionSelector\n          attributions={attributions}\n          selectedIndex={selectedAttribution}\n          onClick={setAttributionAndResetChunk}\n        />\n      ) : null}\n      {relatedSource && !hasError && src !== \"\" ? (\n        <Box\n          sx={{\n            width: \"100%\",\n            height: 125,\n            mb: 2,\n            px: 2.5,\n            \"& img\": { objectFit: \"cover\", height: 1, width: 1, borderRadius: 2 },\n          }}\n        >\n          {image}\n        </Box>\n      ) : null}\n      <Box\n        sx={{\n          display: \"flex\",\n          color: \"text.secondary\",\n          alignItems: \"center\",\n          my: 1.5,\n          px: 2.5,\n          \"& p\": {\n            fontSize: 12,\n            letterSpacing: 0.25,\n          },\n        }}\n      >\n        {documentScope ? (\n          <DocumentIcon\n            documentScope={documentScope}\n            contentType={contentType}\n            text={sourceName}\n            srcKey={srcKey}\n          />\n        ) : null}\n        {externalFavicon ? (\n          <Box\n            sx={{\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: 0.5,\n              mr: 0.5,\n              overflow: \"hidden\",\n              \"& img, & svg\": {\n                height: 16,\n                width: 16,\n              },\n\n              \"& div\": {\n                display: \"flex\",\n              },\n            }}\n          >\n            <ExternalFavicon faviconUrl={externalFavicon} alt={sourceName} />\n            <Typography sx={{ whiteSpace: \"nowrap\", textOverflow: \"ellipsis\", overflow: \"hidden\" }}>\n              {sourceName}\n            </Typography>\n          </Box>\n        ) : null}\n        {ts ? <Typography sx={{ flexShrink: 0 }}>· {getTimePassed(ts)}</Typography> : null}\n        {language ? <Typography sx={{ ml: 0.5, flexShrink: 0 }}>· {language}</Typography> : null}\n      </Box>\n      <Typography\n        sx={{\n          color: \"text.primary\",\n          fontSize: 18,\n          fontWeight: 700,\n          lineHeight: \"24px\",\n          display: \"-webkit-box\",\n          overflowWrap: \"break-word\",\n          WebkitBoxOrient: \"vertical\",\n          WebkitLineClamp: 4,\n          overflow: \"hidden\",\n          mb: 2,\n          px: 2.5,\n        }}\n      >\n        {removeSnippetEllipsisSpace(hd)}\n      </Typography>\n\n      <Box\n        sx={{\n          px: 2.5,\n\n          \"& > div::-webkit-scrollbar\": {\n            display: \"none\",\n          },\n        }}\n      >\n        <Swiper\n          key={selectedAttribution}\n          slidesPerView={1}\n          style={{ overflow: \"visible\" }}\n          centeredSlides\n          spaceBetween={12}\n          onSlideChange={slide => {\n            setSelectedChunk(slide.realIndex)\n          }}\n        >\n          {matches.map(match => (\n            <SwiperSlide key={match.text} onMouseDown={event => event.preventDefault()}>\n              <Box\n                onClick={match.onClick}\n                sx={{\n                  border: 1,\n                  borderColor: \"outline.border\",\n                  p: 2,\n                  borderRadius: 1,\n                }}\n              >\n                <Typography\n                  sx={{\n                    fontSize: 18,\n                    color: \"text.secondary\",\n                    display: \"-webkit-box\",\n                    overflowWrap: \"break-word\",\n                    WebkitBoxOrient: \"vertical\",\n                    WebkitLineClamp: 4,\n                    overflow: \"hidden\",\n                  }}\n                >\n                  {removeSnippetEllipsisSpace(match.text)}\n                </Typography>\n              </Box>\n            </SwiperSlide>\n          ))}\n        </Swiper>\n      </Box>\n\n      <Box\n        sx={{\n          px: 2.5,\n        }}\n      >\n        <Button\n          onClick={matches[selectedChunk].onClick}\n          variant=\"contained-light\"\n          sx={{\n            color: \"primary.main\",\n            width: 1,\n            letterSpacing: 1,\n            mt: 2,\n            fontSize: 18,\n          }}\n        >\n          Read more\n        </Button>\n      </Box>\n    </Box>\n  )\n}\nexport { InlineAttributionDisplayMobile }\n"],"names":["InlineAttributionDisplayMobile","attributions","selectedAttribution","setSelectedAttribution","selectedChunk","setSelectedChunk","useState","matches","data","hd","sourceName","ts","setAttributionAndResetChunk","id","relatedSource","documentScope","contentType","srcKey","language","type","externalFavicon","isLoaded","src","hasError","useSourceImage","image","img","alt","Skeleton","height","sx","transform","Box","py","bgcolor","borderTopLeftRadius","borderTopRightRadius","overflow","length","InlineAttributionSelector","selectedIndex","onClick","width","mb","px","objectFit","borderRadius","display","color","alignItems","my","fontSize","letterSpacing","DocumentIcon","text","gap","mr","ExternalFavicon","faviconUrl","Typography","whiteSpace","textOverflow","flexShrink","getTimePassed","ml","fontWeight","lineHeight","overflowWrap","WebkitBoxOrient","WebkitLineClamp","removeSnippetEllipsisSpace","Swiper","slidesPerView","style","centeredSlides","spaceBetween","onSlideChange","slide","realIndex","map","match","SwiperSlide","onMouseDown","event","preventDefault","border","borderColor","p","Button","variant","mt"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}