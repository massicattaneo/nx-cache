{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/Chat/ChatResponse/ChatMetrics.tsx"],"sourcesContent":["import { LlmTimings } from \"@rp/react/common/hooks\"\nimport {\n  Accordion,\n  AccordionDetails,\n  AccordionSummary,\n  Box,\n  Table,\n  TableBody,\n  TableCell,\n  TableRow,\n  Typography,\n} from \"@rp/react/web/mui/core\"\nimport { ExpandMore } from \"@rp/react/web/mui/icons\"\n\nconst LABELS = [\"First Audit\", \"First Token\", \"Sources\", \"Completed\"]\n\nconst timeFormat = new Intl.DateTimeFormat(\"en\", {\n  hour: \"numeric\",\n  minute: \"numeric\",\n  second: \"numeric\",\n  hour12: false,\n})\n\ntype Props = {\n  timings: LlmTimings | undefined\n  interactionId: string\n}\n\nconst ChatMetrics = ({ timings, interactionId }: Props) => {\n  if (!timings || timings.start === undefined) {\n    return null\n  }\n\n  const timestamps = [timings.audit, timings.firstToken, timings.sources, timings.completed]\n\n  const durations = [\n    timings.audit !== undefined ? (timings.audit - timings.start) / 1000 : undefined,\n    timings.firstToken !== undefined ? (timings.firstToken - timings.start) / 1000 : undefined,\n    timings.sources !== undefined ? (timings.sources - timings.start) / 1000 : undefined,\n    timings.completed !== undefined ? (timings.completed - timings.start) / 1000 : undefined,\n  ]\n\n  const validDurations = durations.filter((duration): duration is number => duration !== undefined)\n\n  return (\n    <Box\n      sx={{\n        backgroundColor: \"elevation.dp02\",\n        borderRadius: 1,\n        p: 2,\n        mb: 3,\n      }}\n    >\n      <Box\n        sx={{\n          width: 1,\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          gap: 2,\n          alignItems: \"center\",\n        }}\n      >\n        <Typography sx={{ flexShrink: 0 }}>\n          <Typography component=\"span\" sx={{ mr: 0.5, color: \"text.secondary\", fontSize: 14 }}>\n            {timeFormat.format(timings.start)}\n          </Typography>\n          Start\n        </Typography>\n        <Typography sx={{ fontSize: 12, color: \"text.secondary\" }}>{interactionId}</Typography>\n      </Box>\n      {validDurations.map((duration, index) => (\n        <Typography key={index}>\n          <Typography component=\"span\" sx={{ mr: 0.5, color: \"text.secondary\", fontSize: 14 }}>\n            {timeFormat.format(timestamps[index])}\n          </Typography>\n          {LABELS[index]}: {duration}s\n        </Typography>\n      ))}\n      {timings.profiling && (\n        <Accordion>\n          <AccordionSummary\n            expandIcon={<ExpandMore />}\n            sx={{ backgroundColor: \"elevation.dp08\", mt: 2 }}\n          >\n            API Profiling\n          </AccordionSummary>\n          <AccordionDetails sx={{ backgroundColor: \"elevation.dp08\" }}>\n            <Table size=\"small\">\n              <TableBody>\n                {timings.profiling &&\n                  Object.entries(timings.profiling).map(([key, value]) => (\n                    <TableRow key={key}>\n                      <TableCell>{key}</TableCell>\n                      <TableCell sx={{ display: \"flex\", wordBreak: \"break-all\" }}>\n                        {Array.isArray(value)\n                          ? value.map((v, i) => (\n                              <Typography mr={1} key={i}>\n                                {v ?? \"null\"}\n                              </Typography>\n                            ))\n                          : value ?? \"null\"}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n              </TableBody>\n            </Table>\n          </AccordionDetails>\n        </Accordion>\n      )}\n    </Box>\n  )\n}\nexport { ChatMetrics }\n"],"names":["ChatMetrics","LABELS","timeFormat","Intl","DateTimeFormat","hour","minute","second","hour12","timings","interactionId","start","undefined","timestamps","audit","firstToken","sources","completed","durations","validDurations","filter","duration","Box","sx","backgroundColor","borderRadius","p","mb","width","display","justifyContent","gap","alignItems","Typography","flexShrink","component","mr","color","fontSize","format","map","index","profiling","Accordion","AccordionSummary","expandIcon","ExpandMore","mt","AccordionDetails","Table","size","TableBody","Object","entries","key","value","TableRow","TableCell","wordBreak","Array","isArray","v","i"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}