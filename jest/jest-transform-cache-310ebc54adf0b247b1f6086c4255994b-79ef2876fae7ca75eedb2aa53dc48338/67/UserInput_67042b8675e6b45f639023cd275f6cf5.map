{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/chat/src/lib/Chat/Chat/UserInput/UserInput.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\nimport { Box, IconButton, Typography } from \"@rp/react/web/mui/core\"\nimport { EditOutlined } from \"@rp/react/web/mui/icons\"\nimport { getTextMargin } from \"../getTextMargin\"\nimport { UserEditInput } from \"./UserEditInput\"\n\ntype Props = {\n  userInitials: string\n  children: string\n  onEdit?: (prompt: string) => void\n  disableScroll?: boolean\n  variant: \"desktop\" | \"mobile\"\n  scrollContainer?: Window | HTMLElement | null\n}\n\nconst MOBILE_USER_YOU_CONTAINER_CLASS_NAME = \"mobile-user-you-container\"\n\nconst UserInput = ({\n  children,\n  userInitials,\n  onEdit,\n  variant,\n  scrollContainer,\n  disableScroll,\n}: Props) => {\n  const [textRef, setTextRef] = useState<HTMLDivElement | null>(null)\n  const [editMode, setEditMode] = useState(false)\n  const isMobile = variant === \"mobile\"\n\n  useEffect(() => {\n    if (!onEdit) {\n      setEditMode(false)\n    }\n  }, [onEdit])\n\n  useEffect(() => {\n    if (scrollContainer && !disableScroll) {\n      setTimeout(() => {\n        const top =\n          scrollContainer instanceof Window\n            ? window.document.body.scrollHeight\n            : scrollContainer.scrollHeight -\n              Number(getComputedStyle(scrollContainer).height.replace(\"px\", \"\"))\n        scrollContainer.scroll({ top, behavior: \"smooth\" })\n      }, 40)\n    }\n  }, [scrollContainer, disableScroll])\n\n  return (\n    <Box\n      sx={{\n        display: \"flex\",\n        flexWrap: isMobile ? \"wrap\" : undefined,\n        gap: isMobile ? 1 : 2,\n        mx: isMobile ? 2 : 0,\n        alignItems: isMobile ? \"center\" : undefined,\n      }}\n    >\n      <Box\n        sx={{\n          height: isMobile ? 28 : 40,\n          width: isMobile ? 28 : 40,\n          color: \"rgba(255, 255, 255, 0.6)\",\n          backgroundColor: \"overlay.surface\",\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          borderRadius: 1,\n          fontSize: isMobile ? \"body2.fontSize\" : \"body1.fontSize\",\n          flexShrink: 0,\n        }}\n      >\n        {userInitials}\n      </Box>\n      {isMobile ? (\n        <Box\n          className={MOBILE_USER_YOU_CONTAINER_CLASS_NAME}\n          sx={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            flexGrow: 1,\n            \"& button\": {\n              backgroundColor: editMode ? \"rgba(255, 255, 255, 0.08) !important\" : \"transparent\",\n            },\n          }}\n        >\n          <Typography\n            sx={{\n              fontSize: \"body2.fontSize\",\n              color: \"text.secondary\",\n            }}\n          >\n            You\n          </Typography>\n          {onEdit ? (\n            <IconButton\n              onClick={() => setEditMode(prev => !prev)}\n              aria-selected={editMode}\n              size=\"small\"\n            >\n              <EditOutlined sx={{ width: 20, height: 20, color: \"grey.300\" }} />\n            </IconButton>\n          ) : null}\n        </Box>\n      ) : null}\n      {!editMode ? (\n        <Box\n          sx={{\n            mt: isMobile ? 0 : getTextMargin(textRef),\n            fontSize: isMobile ? 18 : 17,\n            flexBasis: isMobile ? \"100%\" : undefined,\n            lineHeight: 1.7,\n            wordBreak: \"break-word\",\n            cursor: !isMobile && onEdit ? \"pointer\" : \"auto\",\n            whiteSpace: \"pre-line\",\n            width: \"100%\",\n            \"& svg\": {\n              opacity: 0,\n              transition: \"opacity 0.2s\",\n            },\n            \"&:hover svg\": {\n              opacity: 1,\n            },\n          }}\n          onClick={isMobile || !onEdit ? undefined : () => setEditMode(true)}\n          ref={setTextRef}\n        >\n          {children}\n          {onEdit && !isMobile ? (\n            <EditOutlined\n              sx={{\n                color: \"grey.300\",\n                height: 16,\n                width: 16,\n                display: \"inline-block\",\n                ml: 1,\n                mb: -0.25,\n              }}\n            />\n          ) : null}\n        </Box>\n      ) : (\n        <UserEditInput\n          initialPrompt={children}\n          onClose={() => setEditMode(false)}\n          onUpdate={prompt => onEdit?.(prompt)}\n        />\n      )}\n    </Box>\n  )\n}\n\nexport { UserInput, MOBILE_USER_YOU_CONTAINER_CLASS_NAME }\n"],"names":["MOBILE_USER_YOU_CONTAINER_CLASS_NAME","UserInput","children","userInitials","onEdit","variant","scrollContainer","disableScroll","textRef","setTextRef","useState","editMode","setEditMode","isMobile","useEffect","setTimeout","top","Window","window","document","body","scrollHeight","Number","getComputedStyle","height","replace","scroll","behavior","Box","sx","display","flexWrap","undefined","gap","mx","alignItems","width","color","backgroundColor","justifyContent","borderRadius","fontSize","flexShrink","className","flexGrow","Typography","IconButton","onClick","prev","aria-selected","size","EditOutlined","mt","getTextMargin","flexBasis","lineHeight","wordBreak","cursor","whiteSpace","opacity","transition","ref","ml","mb","UserEditInput","initialPrompt","onClose","onUpdate","prompt"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IAyJoBA,oCAAoC;eAApCA;;IAAXC,SAAS;eAATA;;;;uBAzJ2B;sBACQ;uBACf;+BACC;+BACA;AAW9B,MAAMD,uCAAuC;AAE7C,MAAMC,YAAY,CAAC,EACjBC,QAAQ,EACRC,YAAY,EACZC,MAAM,EACNC,OAAO,EACPC,eAAe,EACfC,aAAa,EACP;IACN,MAAM,CAACC,SAASC,WAAW,GAAGC,IAAAA,eAAQ,EAAwB;IAC9D,MAAM,CAACC,UAAUC,YAAY,GAAGF,IAAAA,eAAQ,EAAC;IACzC,MAAMG,WAAWR,YAAY;IAE7BS,IAAAA,gBAAS,EAAC;QACR,IAAI,CAACV,QAAQ;YACXQ,YAAY;QACd;IACF,GAAG;QAACR;KAAO;IAEXU,IAAAA,gBAAS,EAAC;QACR,IAAIR,mBAAmB,CAACC,eAAe;YACrCQ,WAAW;gBACT,MAAMC,MACJV,2BAA2BW,SACvBC,OAAOC,QAAQ,CAACC,IAAI,CAACC,YAAY,GACjCf,gBAAgBe,YAAY,GAC5BC,OAAOC,iBAAiBjB,iBAAiBkB,MAAM,CAACC,OAAO,CAAC,MAAM;gBACpEnB,gBAAgBoB,MAAM,CAAC;oBAAEV;oBAAKW,UAAU;gBAAS;YACnD,GAAG;QACL;IACF,GAAG;QAACrB;QAAiBC;KAAc;IAEnC,qBACE,sBAACqB,SAAG;QACFC,IAAI;YACFC,SAAS;YACTC,UAAUlB,WAAW,SAASmB;YAC9BC,KAAKpB,WAAW,IAAI;YACpBqB,IAAIrB,WAAW,IAAI;YACnBsB,YAAYtB,WAAW,WAAWmB;QACpC;;0BAEA,qBAACJ,SAAG;gBACFC,IAAI;oBACFL,QAAQX,WAAW,KAAK;oBACxBuB,OAAOvB,WAAW,KAAK;oBACvBwB,OAAO;oBACPC,iBAAiB;oBACjBR,SAAS;oBACTK,YAAY;oBACZI,gBAAgB;oBAChBC,cAAc;oBACdC,UAAU5B,WAAW,mBAAmB;oBACxC6B,YAAY;gBACd;0BAECvC;;YAEFU,yBACC,sBAACe,SAAG;gBACFe,WAAW3C;gBACX6B,IAAI;oBACFC,SAAS;oBACTS,gBAAgB;oBAChBJ,YAAY;oBACZS,UAAU;oBACV,YAAY;wBACVN,iBAAiB3B,WAAW,yCAAyC;oBACvE;gBACF;;kCAEA,qBAACkC,gBAAU;wBACThB,IAAI;4BACFY,UAAU;4BACVJ,OAAO;wBACT;kCACD;;oBAGAjC,uBACC,qBAAC0C,gBAAU;wBACTC,SAAS,IAAMnC,YAAYoC,CAAAA,OAAQ,CAACA;wBACpCC,iBAAetC;wBACfuC,MAAK;kCAEL,cAAA,qBAACC,mBAAY;4BAACtB,IAAI;gCAAEO,OAAO;gCAAIZ,QAAQ;gCAAIa,OAAO;4BAAW;;yBAE7D;;iBAEJ;YACH,CAAC1B,yBACA,sBAACiB,SAAG;gBACFC,IAAI;oBACFuB,IAAIvC,WAAW,IAAIwC,IAAAA,4BAAa,EAAC7C;oBACjCiC,UAAU5B,WAAW,KAAK;oBAC1ByC,WAAWzC,WAAW,SAASmB;oBAC/BuB,YAAY;oBACZC,WAAW;oBACXC,QAAQ,CAAC5C,YAAYT,SAAS,YAAY;oBAC1CsD,YAAY;oBACZtB,OAAO;oBACP,SAAS;wBACPuB,SAAS;wBACTC,YAAY;oBACd;oBACA,eAAe;wBACbD,SAAS;oBACX;gBACF;gBACAZ,SAASlC,YAAY,CAACT,SAAS4B,YAAY,IAAMpB,YAAY;gBAC7DiD,KAAKpD;;oBAEJP;oBACAE,UAAU,CAACS,yBACV,qBAACsC,mBAAY;wBACXtB,IAAI;4BACFQ,OAAO;4BACPb,QAAQ;4BACRY,OAAO;4BACPN,SAAS;4BACTgC,IAAI;4BACJC,IAAI,CAAC;wBACP;yBAEA;;+BAGN,qBAACC,4BAAa;gBACZC,eAAe/D;gBACfgE,SAAS,IAAMtD,YAAY;gBAC3BuD,UAAUC,CAAAA,SAAUhE,mBAAAA,6BAAAA,OAASgE;;;;AAKvC"}