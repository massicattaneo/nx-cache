{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/discovery-sidebar/discovery-panel/src/DiscoveryPanel/DiscoveryPanel.mobile.tsx"],"sourcesContent":["import { useCallback, useRef, useState } from \"react\"\nimport { Swiper, SwiperSlide } from \"swiper/react\"\nimport { Typography } from \"@mui/material\"\nimport { CqsItem } from \"@rp/common/api-types\"\nimport { Watchlist } from \"@rp/common/api-types\"\nimport { MOBILE_SCROLL_THRESHOLD } from \"@rp/common/settings\"\nimport { AutoAnimateHeight } from \"@rp/react/web/common/composite-components\"\nimport {\n  LoadingFilter,\n  useDiscoveryPanelWidgetCategories,\n} from \"@rp/react/web/common/discovery-sidebar\"\nimport { DiscoveryPanelContainerMobile } from \"./DiscoveryPanel.styles\"\nimport { DiscoveryPanelWidget } from \"./DiscoveryPanelWidget\"\n\ntype Props = {\n  onAddToWatchlist?: (watchlist: Watchlist) => void\n  isFeedbackMode: boolean\n}\n\nconst DiscoveryPanelMobile = ({ onAddToWatchlist, isFeedbackMode }: Props) => {\n  const ref = useRef<HTMLDivElement | null>(null)\n  const [mentionsItem, setMentionsItem] = useState<Record<string, CqsItem | undefined>>({})\n  const setMentionItem = useCallback((category: string, value: CqsItem | undefined) => {\n    setMentionsItem(prev => {\n      return { ...prev, [category]: value }\n    })\n  }, [])\n  const { categories, isError, isLoading, widgetActions, labels } =\n    useDiscoveryPanelWidgetCategories()\n\n  const groups = isLoading ? labels : Object.keys(categories)\n\n  const scrollToWidgetTop = useCallback(() => {\n    const { top } = ref.current?.getBoundingClientRect() || {\n      top: 0,\n    }\n    if (top < MOBILE_SCROLL_THRESHOLD) {\n      window.scroll({\n        top: top + window.scrollY - MOBILE_SCROLL_THRESHOLD,\n        behavior: \"smooth\",\n      })\n    }\n  }, [ref])\n\n  if (isError) {\n    return null\n  }\n\n  return (\n    <div ref={ref}>\n      <DiscoveryPanelContainerMobile>\n        {groups.length !== 0 && (\n          <>\n            <Typography>Discover</Typography>\n            <Swiper\n              speed={500}\n              spaceBetween={8}\n              centeredSlides\n              slidesPerView={1.1}\n              onSlideChangeTransitionStart={() => {\n                groups.forEach(cat => {\n                  const category = categories[cat]\n                  widgetActions.reset(category.id)\n                })\n                scrollToWidgetTop()\n                setMentionsItem({})\n              }}\n            >\n              {isLoading ? (\n                <SwiperSlide key={\"loading\"}>\n                  <LoadingFilter />\n                </SwiperSlide>\n              ) : (\n                <>\n                  {groups.map(category => {\n                    return (\n                      <SwiperSlide key={category}>\n                        <AutoAnimateHeight minHeight={252}>\n                          <DiscoveryPanelWidget\n                            isFeedbackMode={isFeedbackMode}\n                            scrollToWidgetTop={scrollToWidgetTop}\n                            widgetCategory={categories[category]}\n                            widgetActions={widgetActions}\n                            mentionsItem={mentionsItem[category]}\n                            setMentionItem={setMentionItem}\n                            onAddToWatchlist={onAddToWatchlist}\n                          />\n                        </AutoAnimateHeight>\n                      </SwiperSlide>\n                    )\n                  })}\n                </>\n              )}\n            </Swiper>\n          </>\n        )}\n      </DiscoveryPanelContainerMobile>\n    </div>\n  )\n}\n\nexport { DiscoveryPanelMobile }\n"],"names":["DiscoveryPanelMobile","onAddToWatchlist","isFeedbackMode","ref","useRef","mentionsItem","setMentionsItem","useState","setMentionItem","useCallback","category","value","prev","categories","isError","isLoading","widgetActions","labels","useDiscoveryPanelWidgetCategories","groups","Object","keys","scrollToWidgetTop","top","current","getBoundingClientRect","MOBILE_SCROLL_THRESHOLD","window","scroll","scrollY","behavior","div","DiscoveryPanelContainerMobile","length","Typography","Swiper","speed","spaceBetween","centeredSlides","slidesPerView","onSlideChangeTransitionStart","forEach","cat","reset","id","SwiperSlide","LoadingFilter","map","AutoAnimateHeight","minHeight","DiscoveryPanelWidget","widgetCategory"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAqGSA;;;eAAAA;;;;uBArGqC;wBACV;0BACT;0BAGa;qCACN;kCAI3B;sCACuC;sCACT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOrC,MAAMA,uBAAuB,CAAC,EAAEC,gBAAgB,EAAEC,cAAc,EAAS;IACvE,MAAMC,MAAMC,IAAAA,aAAM,EAAwB;IAC1C,MAAM,CAACC,cAAcC,gBAAgB,GAAGC,IAAAA,eAAQ,EAAsC,CAAC;IACvF,MAAMC,iBAAiBC,IAAAA,kBAAW,EAAC,CAACC,UAAkBC;QACpDL,gBAAgBM,CAAAA;YACd,OAAO,wCAAKA;gBAAM,CAACF,SAAS,EAAEC;;QAChC;IACF,GAAG,EAAE;IACL,MAAM,EAAEE,UAAU,EAAEC,OAAO,EAAEC,SAAS,EAAEC,aAAa,EAAEC,MAAM,EAAE,GAC7DC,IAAAA,mDAAiC;IAEnC,MAAMC,SAASJ,YAAYE,SAASG,OAAOC,IAAI,CAACR;IAEhD,MAAMS,oBAAoBb,IAAAA,kBAAW,EAAC;YACpBN;QAAhB,MAAM,EAAEoB,GAAG,EAAE,GAAGpB,EAAAA,eAAAA,IAAIqB,OAAO,cAAXrB,mCAAAA,aAAasB,qBAAqB,OAAM;YACtDF,KAAK;QACP;QACA,IAAIA,MAAMG,iCAAuB,EAAE;YACjCC,OAAOC,MAAM,CAAC;gBACZL,KAAKA,MAAMI,OAAOE,OAAO,GAAGH,iCAAuB;gBACnDI,UAAU;YACZ;QACF;IACF,GAAG;QAAC3B;KAAI;IAER,IAAIW,SAAS;QACX,OAAO;IACT;IAEA,qBACE,qBAACiB;QAAI5B,KAAKA;kBACR,cAAA,qBAAC6B,mDAA6B;sBAC3Bb,OAAOc,MAAM,KAAK,mBACjB;;kCACE,qBAACC,oBAAU;kCAAC;;kCACZ,qBAACC,cAAM;wBACLC,OAAO;wBACPC,cAAc;wBACdC,cAAc;wBACdC,eAAe;wBACfC,8BAA8B;4BAC5BrB,OAAOsB,OAAO,CAACC,CAAAA;gCACb,MAAMhC,WAAWG,UAAU,CAAC6B,IAAI;gCAChC1B,cAAc2B,KAAK,CAACjC,SAASkC,EAAE;4BACjC;4BACAtB;4BACAhB,gBAAgB,CAAC;wBACnB;kCAECS,0BACC,qBAAC8B,mBAAW;sCACV,cAAA,qBAACC,+BAAa;2BADE,2BAIlB;sCACG3B,OAAO4B,GAAG,CAACrC,CAAAA;gCACV,qBACE,qBAACmC,mBAAW;8CACV,cAAA,qBAACG,sCAAiB;wCAACC,WAAW;kDAC5B,cAAA,qBAACC,0CAAoB;4CACnBhD,gBAAgBA;4CAChBoB,mBAAmBA;4CACnB6B,gBAAgBtC,UAAU,CAACH,SAAS;4CACpCM,eAAeA;4CACfX,cAAcA,YAAY,CAACK,SAAS;4CACpCF,gBAAgBA;4CAChBP,kBAAkBA;;;mCATNS;4BActB;;;;;;;AASlB"}