{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/apps/client-web/src/app/pages/Watchlist/WatchlistsListView.test.tsx"],"sourcesContent":["import { dbStub } from \"@rp/development/msw\"\nimport { renderWithProviders } from \"@rp/react/web/common/tools\"\nimport { fireEvent, waitFor } from \"@testing-library/react\"\nimport { WatchlistsListView } from \"./WatchlistsListView\"\n\nconst mockHistoryPush = jest.fn()\njest.mock(\"react-router-dom\", () => ({\n  ...jest.requireActual(\"react-router-dom\"),\n  useNavigate: () => mockHistoryPush,\n}))\n\ntest(\"should render the watchlists table\", async () => {\n  jest.useFakeTimers()\n  const wl = await dbStub.collection(\"watchlists\").findOne()\n  const { getByText, getByRole } = renderWithProviders(<WatchlistsListView />)\n\n  await waitFor(() => {\n    const title = getByText(wl?.name ?? \"\")\n    expect(title).toBeInTheDocument()\n    fireEvent.click(title)\n    global.preview()\n  })\n\n  // Clicking a title should open the watchlist\n  expect(mockHistoryPush).toHaveBeenCalledWith(`/watchlists/${wl?.id}`, {\n    state: { comingFrom: \"user\" },\n  })\n\n  const menu = getByRole(\"button\", { name: \"More actions\" })\n  fireEvent.click(menu)\n  expect(mockHistoryPush).toHaveBeenCalledTimes(1)\n})\n\ntest(\"should inform there are no watchlists\", async () => {\n  await dbStub.collection(\"watchlists\").clear()\n  const { getByText } = renderWithProviders(<WatchlistsListView />)\n  await waitFor(() => {\n    expect(getByText(\"You haven't created any watchlist yet\")).toBeInTheDocument()\n  })\n})\n\ntest(\"should permit the user to search\", async () => {\n  const { container, getByPlaceholderText, getAllByRole } = renderWithProviders(\n    <WatchlistsListView />,\n  )\n  await waitFor(() => {\n    expect(container).toContainHTML(\"Personal Watchlist\")\n    expect(getByPlaceholderText(\"Find your watchlists\")).toBeInTheDocument()\n    expect(getAllByRole(\"listitem\").length).toEqual(1)\n  })\n  fireEvent.change(getByPlaceholderText(\"Find your watchlists\"), {\n    target: { value: \"Personal XX\" },\n  })\n  await waitFor(() => {\n    expect(container).toContainHTML(\"No results found for your search\")\n  })\n})\n"],"names":["jest","mock","requireActual","useNavigate","mockHistoryPush","fn","test","useFakeTimers","wl","dbStub","collection","findOne","getByText","getByRole","renderWithProviders","WatchlistsListView","waitFor","title","name","expect","toBeInTheDocument","fireEvent","click","global","preview","toHaveBeenCalledWith","id","state","comingFrom","menu","toHaveBeenCalledTimes","clear","container","getByPlaceholderText","getAllByRole","toContainHTML","length","toEqual","change","target","value"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";AAMAA,KAAKC,IAAI,CAAC,oBAAoB,IAAO,wCAChCD,KAAKE,aAAa,CAAC;QACtBC,aAAa,IAAMC;;;;;;qBARE;uBACa;uBACD;oCACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEnC,MAAMA,kBAAkBJ,KAAKK,EAAE;AAM/BC,KAAK,sCAAsC;IACzCN,KAAKO,aAAa;IAClB,MAAMC,KAAK,MAAMC,WAAM,CAACC,UAAU,CAAC,cAAcC,OAAO;IACxD,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAE,GAAGC,IAAAA,0BAAmB,gBAAC,qBAACC,sCAAkB;IAExE,MAAMC,IAAAA,cAAO,EAAC;YACYR;QAAxB,MAAMS,QAAQL,UAAUJ,CAAAA,WAAAA,eAAAA,yBAAAA,GAAIU,IAAI,cAARV,sBAAAA,WAAY;QACpCW,OAAOF,OAAOG,iBAAiB;QAC/BC,gBAAS,CAACC,KAAK,CAACL;QAChBM,OAAOC,OAAO;IAChB;IAEA,6CAA6C;IAC7CL,OAAOf,iBAAiBqB,oBAAoB,CAAC,CAAC,YAAY,EAAEjB,eAAAA,yBAAAA,GAAIkB,EAAE,CAAC,CAAC,EAAE;QACpEC,OAAO;YAAEC,YAAY;QAAO;IAC9B;IAEA,MAAMC,OAAOhB,UAAU,UAAU;QAAEK,MAAM;IAAe;IACxDG,gBAAS,CAACC,KAAK,CAACO;IAChBV,OAAOf,iBAAiB0B,qBAAqB,CAAC;AAChD;AAEAxB,KAAK,yCAAyC;IAC5C,MAAMG,WAAM,CAACC,UAAU,CAAC,cAAcqB,KAAK;IAC3C,MAAM,EAAEnB,SAAS,EAAE,GAAGE,IAAAA,0BAAmB,gBAAC,qBAACC,sCAAkB;IAC7D,MAAMC,IAAAA,cAAO,EAAC;QACZG,OAAOP,UAAU,0CAA0CQ,iBAAiB;IAC9E;AACF;AAEAd,KAAK,oCAAoC;IACvC,MAAM,EAAE0B,SAAS,EAAEC,oBAAoB,EAAEC,YAAY,EAAE,GAAGpB,IAAAA,0BAAmB,gBAC3E,qBAACC,sCAAkB;IAErB,MAAMC,IAAAA,cAAO,EAAC;QACZG,OAAOa,WAAWG,aAAa,CAAC;QAChChB,OAAOc,qBAAqB,yBAAyBb,iBAAiB;QACtED,OAAOe,aAAa,YAAYE,MAAM,EAAEC,OAAO,CAAC;IAClD;IACAhB,gBAAS,CAACiB,MAAM,CAACL,qBAAqB,yBAAyB;QAC7DM,QAAQ;YAAEC,OAAO;QAAc;IACjC;IACA,MAAMxB,IAAAA,cAAO,EAAC;QACZG,OAAOa,WAAWG,aAAa,CAAC;IAClC;AACF"}