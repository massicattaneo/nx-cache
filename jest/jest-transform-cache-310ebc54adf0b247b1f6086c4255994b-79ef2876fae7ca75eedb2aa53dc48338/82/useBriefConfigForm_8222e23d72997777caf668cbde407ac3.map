{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/common/brief/src/atoms/useBriefConfigForm.ts"],"sourcesContent":["import { useCallback } from \"react\"\nimport { useAtom } from \"jotai\"\nimport { useUser } from \"@clerk/clerk-react\"\nimport { NotificationSchedule, isEmailNotificationSchedule } from \"@rp/common/api-types\"\nimport { USER_TIMEZONE } from \"@rp/common/utils\"\nimport { BriefConfigForm } from \"@rp/react/tanstack-api/brief\"\nimport { atomBriefConfigForm } from \"./briefAtoms\"\n\ntype UseBriefConfigFormState = {\n  form: BriefConfigForm\n  initializeForm: () => void\n  setForm: (form: BriefConfigForm) => void\n  setName: (name: string) => void\n  setScheduleFromNotification: (notificationSchedule: NotificationSchedule) => void\n  setWatchlistId: (watchlistId: string) => void\n}\n\nconst useBriefConfigForm = (): UseBriefConfigFormState => {\n  const [form, setFormAtom] = useAtom(atomBriefConfigForm)\n  const { user } = useUser()\n\n  const initializeForm = useCallback(() => {\n    setFormAtom({\n      name: \"\",\n      schedule: {\n        schedulerExpression: \"0 7 ? * 1-5 *\",\n        timezone: USER_TIMEZONE.value,\n        destination: \"email\",\n        destinationParams: { emails: [user?.primaryEmailAddress?.emailAddress || \"\"] },\n      },\n      watchlistId: \"\",\n    })\n  }, [setFormAtom, user?.primaryEmailAddress?.emailAddress])\n\n  const setWatchlistId = useCallback(\n    (watchlistId: string) => setFormAtom(prev => ({ ...prev, watchlistId })),\n    [setFormAtom],\n  )\n\n  const setScheduleFromNotification = useCallback(\n    (notificationSchedule: NotificationSchedule) => {\n      if (!isEmailNotificationSchedule(notificationSchedule)) return\n\n      setFormAtom(prev => ({\n        ...prev,\n        schedule: {\n          ...prev.schedule,\n          schedulerExpression: notificationSchedule.schedulerExpression,\n          timezone: notificationSchedule.timezone,\n          destination: \"email\",\n          destinationParams: { emails: notificationSchedule.destinationParams.emails },\n        },\n      }))\n    },\n    [setFormAtom],\n  )\n\n  const setName = useCallback(\n    (name: string) => setFormAtom(prev => ({ ...prev, name })),\n    [setFormAtom],\n  )\n\n  return {\n    form,\n    initializeForm,\n    setForm: setFormAtom,\n    setName,\n    setWatchlistId,\n    setScheduleFromNotification,\n  }\n}\n\nexport { useBriefConfigForm }\nexport type { UseBriefConfigFormState }\n"],"names":["useBriefConfigForm","user","form","setFormAtom","useAtom","atomBriefConfigForm","useUser","initializeForm","useCallback","name","schedule","schedulerExpression","timezone","USER_TIMEZONE","value","destination","destinationParams","emails","primaryEmailAddress","emailAddress","watchlistId","setWatchlistId","prev","setScheduleFromNotification","notificationSchedule","isEmailNotificationSchedule","setName","setForm"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAwESA;;;eAAAA;;;uBAxEmB;uBACJ;4BACA;0BAC0C;uBACpC;4BAEM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWpC,MAAMA,qBAAqB;QAeRC;IAdjB,MAAM,CAACC,MAAMC,YAAY,GAAGC,IAAAA,cAAO,EAACC,+BAAmB;IACvD,MAAM,EAAEJ,IAAI,EAAE,GAAGK,IAAAA,mBAAO;IAExB,MAAMC,iBAAiBC,IAAAA,kBAAW,EAAC;YAOCP;QANlCE,YAAY;YACVM,MAAM;YACNC,UAAU;gBACRC,qBAAqB;gBACrBC,UAAUC,oBAAa,CAACC,KAAK;gBAC7BC,aAAa;gBACbC,mBAAmB;oBAAEC,QAAQ;wBAAChB,CAAAA,iBAAAA,4BAAAA,4BAAAA,KAAMiB,mBAAmB,cAAzBjB,gDAAAA,0BAA2BkB,YAAY,KAAI;qBAAG;gBAAC;YAC/E;YACAC,aAAa;QACf;IACF,GAAG;QAACjB;QAAaF,iBAAAA,4BAAAA,4BAAAA,KAAMiB,mBAAmB,cAAzBjB,gDAAAA,0BAA2BkB,YAAY;KAAC;IAEzD,MAAME,iBAAiBb,IAAAA,kBAAW,EAChC,CAACY,cAAwBjB,YAAYmB,CAAAA,OAAS,wCAAKA;gBAAMF;iBACzD;QAACjB;KAAY;IAGf,MAAMoB,8BAA8Bf,IAAAA,kBAAW,EAC7C,CAACgB;QACC,IAAI,CAACC,IAAAA,qCAA2B,EAACD,uBAAuB;QAExDrB,YAAYmB,CAAAA,OAAS,wCAChBA;gBACHZ,UAAU,wCACLY,KAAKZ,QAAQ;oBAChBC,qBAAqBa,qBAAqBb,mBAAmB;oBAC7DC,UAAUY,qBAAqBZ,QAAQ;oBACvCG,aAAa;oBACbC,mBAAmB;wBAAEC,QAAQO,qBAAqBR,iBAAiB,CAACC,MAAM;oBAAC;;;IAGjF,GACA;QAACd;KAAY;IAGf,MAAMuB,UAAUlB,IAAAA,kBAAW,EACzB,CAACC,OAAiBN,YAAYmB,CAAAA,OAAS,wCAAKA;gBAAMb;iBAClD;QAACN;KAAY;IAGf,OAAO;QACLD;QACAK;QACAoB,SAASxB;QACTuB;QACAL;QACAE;IACF;AACF"}