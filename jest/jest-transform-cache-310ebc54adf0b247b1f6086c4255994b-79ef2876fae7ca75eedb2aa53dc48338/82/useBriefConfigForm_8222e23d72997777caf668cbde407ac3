2259ca9db56ea82f70f604f2606a4ba3
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "useBriefConfigForm", {
    enumerable: true,
    get: function() {
        return useBriefConfigForm;
    }
});
const _react = require("react");
const _jotai = require("jotai");
const _clerkreact = require("@clerk/clerk-react");
const _apitypes = require("@rp/common/api-types");
const _utils = require("@rp/common/utils");
const _briefAtoms = require("./briefAtoms");
function _define_property(obj, key, value) {
    if (key in obj) {
        Object.defineProperty(obj, key, {
            value: value,
            enumerable: true,
            configurable: true,
            writable: true
        });
    } else {
        obj[key] = value;
    }
    return obj;
}
function _object_spread(target) {
    for(var i = 1; i < arguments.length; i++){
        var source = arguments[i] != null ? arguments[i] : {};
        var ownKeys = Object.keys(source);
        if (typeof Object.getOwnPropertySymbols === "function") {
            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym) {
                return Object.getOwnPropertyDescriptor(source, sym).enumerable;
            }));
        }
        ownKeys.forEach(function(key) {
            _define_property(target, key, source[key]);
        });
    }
    return target;
}
function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);
    if (Object.getOwnPropertySymbols) {
        var symbols = Object.getOwnPropertySymbols(object);
        if (enumerableOnly) {
            symbols = symbols.filter(function(sym) {
                return Object.getOwnPropertyDescriptor(object, sym).enumerable;
            });
        }
        keys.push.apply(keys, symbols);
    }
    return keys;
}
function _object_spread_props(target, source) {
    source = source != null ? source : {};
    if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
        ownKeys(Object(source)).forEach(function(key) {
            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
    }
    return target;
}
const useBriefConfigForm = ()=>{
    var _user_primaryEmailAddress;
    const [form, setFormAtom] = (0, _jotai.useAtom)(_briefAtoms.atomBriefConfigForm);
    const { user } = (0, _clerkreact.useUser)();
    const initializeForm = (0, _react.useCallback)(()=>{
        var _user_primaryEmailAddress;
        setFormAtom({
            name: "",
            schedule: {
                schedulerExpression: "0 7 ? * 1-5 *",
                timezone: _utils.USER_TIMEZONE.value,
                destination: "email",
                destinationParams: {
                    emails: [
                        (user === null || user === void 0 ? void 0 : (_user_primaryEmailAddress = user.primaryEmailAddress) === null || _user_primaryEmailAddress === void 0 ? void 0 : _user_primaryEmailAddress.emailAddress) || ""
                    ]
                }
            },
            watchlistId: ""
        });
    }, [
        setFormAtom,
        user === null || user === void 0 ? void 0 : (_user_primaryEmailAddress = user.primaryEmailAddress) === null || _user_primaryEmailAddress === void 0 ? void 0 : _user_primaryEmailAddress.emailAddress
    ]);
    const setWatchlistId = (0, _react.useCallback)((watchlistId)=>setFormAtom((prev)=>_object_spread_props(_object_spread({}, prev), {
                watchlistId
            })), [
        setFormAtom
    ]);
    const setScheduleFromNotification = (0, _react.useCallback)((notificationSchedule)=>{
        if (!(0, _apitypes.isEmailNotificationSchedule)(notificationSchedule)) return;
        setFormAtom((prev)=>_object_spread_props(_object_spread({}, prev), {
                schedule: _object_spread_props(_object_spread({}, prev.schedule), {
                    schedulerExpression: notificationSchedule.schedulerExpression,
                    timezone: notificationSchedule.timezone,
                    destination: "email",
                    destinationParams: {
                        emails: notificationSchedule.destinationParams.emails
                    }
                })
            }));
    }, [
        setFormAtom
    ]);
    const setName = (0, _react.useCallback)((name)=>setFormAtom((prev)=>_object_spread_props(_object_spread({}, prev), {
                name
            })), [
        setFormAtom
    ]);
    return {
        form,
        initializeForm,
        setForm: setFormAtom,
        setName,
        setWatchlistId,
        setScheduleFromNotification
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tY2F0dGFuZW8vd29ya3NwYWNlL2Zyb250ZW5kL2xpYnMvcmVhY3QvY29tbW9uL2JyaWVmL3NyYy9hdG9tcy91c2VCcmllZkNvbmZpZ0Zvcm0udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHsgdXNlQXRvbSB9IGZyb20gXCJqb3RhaVwiXG5pbXBvcnQgeyB1c2VVc2VyIH0gZnJvbSBcIkBjbGVyay9jbGVyay1yZWFjdFwiXG5pbXBvcnQgeyBOb3RpZmljYXRpb25TY2hlZHVsZSwgaXNFbWFpbE5vdGlmaWNhdGlvblNjaGVkdWxlIH0gZnJvbSBcIkBycC9jb21tb24vYXBpLXR5cGVzXCJcbmltcG9ydCB7IFVTRVJfVElNRVpPTkUgfSBmcm9tIFwiQHJwL2NvbW1vbi91dGlsc1wiXG5pbXBvcnQgeyBCcmllZkNvbmZpZ0Zvcm0gfSBmcm9tIFwiQHJwL3JlYWN0L3RhbnN0YWNrLWFwaS9icmllZlwiXG5pbXBvcnQgeyBhdG9tQnJpZWZDb25maWdGb3JtIH0gZnJvbSBcIi4vYnJpZWZBdG9tc1wiXG5cbnR5cGUgVXNlQnJpZWZDb25maWdGb3JtU3RhdGUgPSB7XG4gIGZvcm06IEJyaWVmQ29uZmlnRm9ybVxuICBpbml0aWFsaXplRm9ybTogKCkgPT4gdm9pZFxuICBzZXRGb3JtOiAoZm9ybTogQnJpZWZDb25maWdGb3JtKSA9PiB2b2lkXG4gIHNldE5hbWU6IChuYW1lOiBzdHJpbmcpID0+IHZvaWRcbiAgc2V0U2NoZWR1bGVGcm9tTm90aWZpY2F0aW9uOiAobm90aWZpY2F0aW9uU2NoZWR1bGU6IE5vdGlmaWNhdGlvblNjaGVkdWxlKSA9PiB2b2lkXG4gIHNldFdhdGNobGlzdElkOiAod2F0Y2hsaXN0SWQ6IHN0cmluZykgPT4gdm9pZFxufVxuXG5jb25zdCB1c2VCcmllZkNvbmZpZ0Zvcm0gPSAoKTogVXNlQnJpZWZDb25maWdGb3JtU3RhdGUgPT4ge1xuICBjb25zdCBbZm9ybSwgc2V0Rm9ybUF0b21dID0gdXNlQXRvbShhdG9tQnJpZWZDb25maWdGb3JtKVxuICBjb25zdCB7IHVzZXIgfSA9IHVzZVVzZXIoKVxuXG4gIGNvbnN0IGluaXRpYWxpemVGb3JtID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldEZvcm1BdG9tKHtcbiAgICAgIG5hbWU6IFwiXCIsXG4gICAgICBzY2hlZHVsZToge1xuICAgICAgICBzY2hlZHVsZXJFeHByZXNzaW9uOiBcIjAgNyA/ICogMS01ICpcIixcbiAgICAgICAgdGltZXpvbmU6IFVTRVJfVElNRVpPTkUudmFsdWUsXG4gICAgICAgIGRlc3RpbmF0aW9uOiBcImVtYWlsXCIsXG4gICAgICAgIGRlc3RpbmF0aW9uUGFyYW1zOiB7IGVtYWlsczogW3VzZXI/LnByaW1hcnlFbWFpbEFkZHJlc3M/LmVtYWlsQWRkcmVzcyB8fCBcIlwiXSB9LFxuICAgICAgfSxcbiAgICAgIHdhdGNobGlzdElkOiBcIlwiLFxuICAgIH0pXG4gIH0sIFtzZXRGb3JtQXRvbSwgdXNlcj8ucHJpbWFyeUVtYWlsQWRkcmVzcz8uZW1haWxBZGRyZXNzXSlcblxuICBjb25zdCBzZXRXYXRjaGxpc3RJZCA9IHVzZUNhbGxiYWNrKFxuICAgICh3YXRjaGxpc3RJZDogc3RyaW5nKSA9PiBzZXRGb3JtQXRvbShwcmV2ID0+ICh7IC4uLnByZXYsIHdhdGNobGlzdElkIH0pKSxcbiAgICBbc2V0Rm9ybUF0b21dLFxuICApXG5cbiAgY29uc3Qgc2V0U2NoZWR1bGVGcm9tTm90aWZpY2F0aW9uID0gdXNlQ2FsbGJhY2soXG4gICAgKG5vdGlmaWNhdGlvblNjaGVkdWxlOiBOb3RpZmljYXRpb25TY2hlZHVsZSkgPT4ge1xuICAgICAgaWYgKCFpc0VtYWlsTm90aWZpY2F0aW9uU2NoZWR1bGUobm90aWZpY2F0aW9uU2NoZWR1bGUpKSByZXR1cm5cblxuICAgICAgc2V0Rm9ybUF0b20ocHJldiA9PiAoe1xuICAgICAgICAuLi5wcmV2LFxuICAgICAgICBzY2hlZHVsZToge1xuICAgICAgICAgIC4uLnByZXYuc2NoZWR1bGUsXG4gICAgICAgICAgc2NoZWR1bGVyRXhwcmVzc2lvbjogbm90aWZpY2F0aW9uU2NoZWR1bGUuc2NoZWR1bGVyRXhwcmVzc2lvbixcbiAgICAgICAgICB0aW1lem9uZTogbm90aWZpY2F0aW9uU2NoZWR1bGUudGltZXpvbmUsXG4gICAgICAgICAgZGVzdGluYXRpb246IFwiZW1haWxcIixcbiAgICAgICAgICBkZXN0aW5hdGlvblBhcmFtczogeyBlbWFpbHM6IG5vdGlmaWNhdGlvblNjaGVkdWxlLmRlc3RpbmF0aW9uUGFyYW1zLmVtYWlscyB9LFxuICAgICAgICB9LFxuICAgICAgfSkpXG4gICAgfSxcbiAgICBbc2V0Rm9ybUF0b21dLFxuICApXG5cbiAgY29uc3Qgc2V0TmFtZSA9IHVzZUNhbGxiYWNrKFxuICAgIChuYW1lOiBzdHJpbmcpID0+IHNldEZvcm1BdG9tKHByZXYgPT4gKHsgLi4ucHJldiwgbmFtZSB9KSksXG4gICAgW3NldEZvcm1BdG9tXSxcbiAgKVxuXG4gIHJldHVybiB7XG4gICAgZm9ybSxcbiAgICBpbml0aWFsaXplRm9ybSxcbiAgICBzZXRGb3JtOiBzZXRGb3JtQXRvbSxcbiAgICBzZXROYW1lLFxuICAgIHNldFdhdGNobGlzdElkLFxuICAgIHNldFNjaGVkdWxlRnJvbU5vdGlmaWNhdGlvbixcbiAgfVxufVxuXG5leHBvcnQgeyB1c2VCcmllZkNvbmZpZ0Zvcm0gfVxuZXhwb3J0IHR5cGUgeyBVc2VCcmllZkNvbmZpZ0Zvcm1TdGF0ZSB9XG4iXSwibmFtZXMiOlsidXNlQnJpZWZDb25maWdGb3JtIiwidXNlciIsImZvcm0iLCJzZXRGb3JtQXRvbSIsInVzZUF0b20iLCJhdG9tQnJpZWZDb25maWdGb3JtIiwidXNlVXNlciIsImluaXRpYWxpemVGb3JtIiwidXNlQ2FsbGJhY2siLCJuYW1lIiwic2NoZWR1bGUiLCJzY2hlZHVsZXJFeHByZXNzaW9uIiwidGltZXpvbmUiLCJVU0VSX1RJTUVaT05FIiwidmFsdWUiLCJkZXN0aW5hdGlvbiIsImRlc3RpbmF0aW9uUGFyYW1zIiwiZW1haWxzIiwicHJpbWFyeUVtYWlsQWRkcmVzcyIsImVtYWlsQWRkcmVzcyIsIndhdGNobGlzdElkIiwic2V0V2F0Y2hsaXN0SWQiLCJwcmV2Iiwic2V0U2NoZWR1bGVGcm9tTm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9uU2NoZWR1bGUiLCJpc0VtYWlsTm90aWZpY2F0aW9uU2NoZWR1bGUiLCJzZXROYW1lIiwic2V0Rm9ybSJdLCJyYW5nZU1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsiLCJtYXBwaW5ncyI6Ijs7OzsrQkF3RVNBOzs7ZUFBQUE7Ozt1QkF4RW1CO3VCQUNKOzRCQUNBOzBCQUMwQzt1QkFDcEM7NEJBRU07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBV3BDLE1BQU1BLHFCQUFxQjtRQWVSQztJQWRqQixNQUFNLENBQUNDLE1BQU1DLFlBQVksR0FBR0MsSUFBQUEsY0FBTyxFQUFDQywrQkFBbUI7SUFDdkQsTUFBTSxFQUFFSixJQUFJLEVBQUUsR0FBR0ssSUFBQUEsbUJBQU87SUFFeEIsTUFBTUMsaUJBQWlCQyxJQUFBQSxrQkFBVyxFQUFDO1lBT0NQO1FBTmxDRSxZQUFZO1lBQ1ZNLE1BQU07WUFDTkMsVUFBVTtnQkFDUkMscUJBQXFCO2dCQUNyQkMsVUFBVUMsb0JBQWEsQ0FBQ0MsS0FBSztnQkFDN0JDLGFBQWE7Z0JBQ2JDLG1CQUFtQjtvQkFBRUMsUUFBUTt3QkFBQ2hCLENBQUFBLGlCQUFBQSw0QkFBQUEsNEJBQUFBLEtBQU1pQixtQkFBbUIsY0FBekJqQixnREFBQUEsMEJBQTJCa0IsWUFBWSxLQUFJO3FCQUFHO2dCQUFDO1lBQy9FO1lBQ0FDLGFBQWE7UUFDZjtJQUNGLEdBQUc7UUFBQ2pCO1FBQWFGLGlCQUFBQSw0QkFBQUEsNEJBQUFBLEtBQU1pQixtQkFBbUIsY0FBekJqQixnREFBQUEsMEJBQTJCa0IsWUFBWTtLQUFDO0lBRXpELE1BQU1FLGlCQUFpQmIsSUFBQUEsa0JBQVcsRUFDaEMsQ0FBQ1ksY0FBd0JqQixZQUFZbUIsQ0FBQUEsT0FBUyx3Q0FBS0E7Z0JBQU1GO2lCQUN6RDtRQUFDakI7S0FBWTtJQUdmLE1BQU1vQiw4QkFBOEJmLElBQUFBLGtCQUFXLEVBQzdDLENBQUNnQjtRQUNDLElBQUksQ0FBQ0MsSUFBQUEscUNBQTJCLEVBQUNELHVCQUF1QjtRQUV4RHJCLFlBQVltQixDQUFBQSxPQUFTLHdDQUNoQkE7Z0JBQ0haLFVBQVUsd0NBQ0xZLEtBQUtaLFFBQVE7b0JBQ2hCQyxxQkFBcUJhLHFCQUFxQmIsbUJBQW1CO29CQUM3REMsVUFBVVkscUJBQXFCWixRQUFRO29CQUN2Q0csYUFBYTtvQkFDYkMsbUJBQW1CO3dCQUFFQyxRQUFRTyxxQkFBcUJSLGlCQUFpQixDQUFDQyxNQUFNO29CQUFDOzs7SUFHakYsR0FDQTtRQUFDZDtLQUFZO0lBR2YsTUFBTXVCLFVBQVVsQixJQUFBQSxrQkFBVyxFQUN6QixDQUFDQyxPQUFpQk4sWUFBWW1CLENBQUFBLE9BQVMsd0NBQUtBO2dCQUFNYjtpQkFDbEQ7UUFBQ047S0FBWTtJQUdmLE9BQU87UUFDTEQ7UUFDQUs7UUFDQW9CLFNBQVN4QjtRQUNUdUI7UUFDQUw7UUFDQUU7SUFDRjtBQUNGIn0=