{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/providers/src/FollowContext/FollowButton.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\nimport { CqsSavedQuery } from \"@rp/common/api-types\"\nimport { Button, CircularProgress, SxProps, alpha, useTheme } from \"@rp/react/web/mui/core\"\nimport { useFollow } from \"./useFollow\"\n\nenum FollowButtonStatus {\n  FOLLOW = \"FOLLOW\",\n  FOLLOWING = \"FOLLOWING\",\n  UNFOLLOW = \"UNFOLLOW\",\n}\n\ntype FollowButtonProps = {\n  id: string\n  saveStatus?: CqsSavedQuery[\"saveStatus\"]\n  sx?: SxProps\n  defaultStatus?: FollowButtonStatus | undefined\n}\n\nconst FollowButton = ({ id, saveStatus, sx, defaultStatus }: FollowButtonProps) => {\n  const { isLoading, isPending, onFollow, isFollowing, isUnfollowModalOpen, isFollowModalOpen } =\n    useFollow(id)\n  const theme = useTheme()\n  const [status, setStatus] = useState<FollowButtonStatus | undefined>(defaultStatus)\n  const mouseExit = useRef(true)\n\n  useEffect(() => {\n    if (isPending) return\n    if (isFollowModalOpen) return setStatus(FollowButtonStatus.FOLLOW)\n    if (isUnfollowModalOpen) return setStatus(FollowButtonStatus.UNFOLLOW)\n    else if (isFollowing) return setStatus(FollowButtonStatus.FOLLOWING)\n    else return setStatus(FollowButtonStatus.FOLLOW)\n  }, [isFollowing, isPending, isUnfollowModalOpen, isFollowModalOpen])\n\n  return (\n    <Button\n      sx={{\n        flexShrink: 0,\n        width: \"110px\",\n        opacity: isUnfollowModalOpen || isPending || isFollowModalOpen ? \"1 !important\" : undefined,\n        pb: \"4px\",\n        ...sx,\n        \"&\":\n          isUnfollowModalOpen || status === FollowButtonStatus.UNFOLLOW\n            ? {\n                color: theme.palette.red[500],\n                border: `1px solid ${theme.palette.red[500]}`,\n                backgroundColor: alpha(theme.palette.red[500], 0.12),\n              }\n            : null,\n      }}\n      onMouseEnter={() => {\n        if (isFollowing && mouseExit.current) setStatus(FollowButtonStatus.UNFOLLOW)\n        mouseExit.current = false\n      }}\n      onMouseLeave={() => {\n        if (isFollowing && !isUnfollowModalOpen) setStatus(FollowButtonStatus.FOLLOWING)\n        mouseExit.current = true\n      }}\n      onClick={event => {\n        event.preventDefault()\n        event.stopPropagation()\n        if (status === FollowButtonStatus.FOLLOWING && isFollowing) return\n        onFollow({ id, saveStatus })\n      }}\n      variant={\n        status === FollowButtonStatus.UNFOLLOW ||\n        status === FollowButtonStatus.FOLLOWING ||\n        isLoading ||\n        isPending\n          ? \"contained-light\"\n          : \"contained\"\n      }\n    >\n      {(isLoading && !defaultStatus) || isPending ? (\n        <>\n          &nbsp;\n          <CircularProgress size=\"20px\" />\n          &nbsp;\n        </>\n      ) : (\n        status\n      )}\n    </Button>\n  )\n}\n\nexport { FollowButton, FollowButtonStatus }\n"],"names":["FollowButton","FollowButtonStatus","id","saveStatus","sx","defaultStatus","isLoading","isPending","onFollow","isFollowing","isUnfollowModalOpen","isFollowModalOpen","useFollow","theme","useTheme","status","setStatus","useState","mouseExit","useRef","useEffect","Button","flexShrink","width","opacity","undefined","pb","color","palette","red","border","backgroundColor","alpha","onMouseEnter","current","onMouseLeave","onClick","event","preventDefault","stopPropagation","variant","CircularProgress","size"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;IAsFSA,YAAY;eAAZA;;IAAcC,kBAAkB;eAAlBA;;;;uBAtFqB;sBAEuB;2BACzC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAErBA;;;;GAAAA,uBAAAA;AAaL,MAAMD,eAAe,CAAC,EAAEE,EAAE,EAAEC,UAAU,EAAEC,EAAE,EAAEC,aAAa,EAAqB;IAC5E,MAAM,EAAEC,SAAS,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,WAAW,EAAEC,mBAAmB,EAAEC,iBAAiB,EAAE,GAC3FC,IAAAA,oBAAS,EAACV;IACZ,MAAMW,QAAQC,IAAAA,cAAQ;IACtB,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAiCZ;IACrE,MAAMa,YAAYC,IAAAA,aAAM,EAAC;IAEzBC,IAAAA,gBAAS,EAAC;QACR,IAAIb,WAAW;QACf,IAAII,mBAAmB,OAAOK;QAC9B,IAAIN,qBAAqB,OAAOM;aAC3B,IAAIP,aAAa,OAAOO;aACxB,OAAOA;IACd,GAAG;QAACP;QAAaF;QAAWG;QAAqBC;KAAkB;IAEnE,qBACE,qBAACU,YAAM;QACLjB,IAAI;YACFkB,YAAY;YACZC,OAAO;YACPC,SAASd,uBAAuBH,aAAaI,oBAAoB,iBAAiBc;YAClFC,IAAI;WACDtB;YACH,KACEM,uBAAuBK,wBACnB;gBACEY,OAAOd,MAAMe,OAAO,CAACC,GAAG,CAAC,IAAI;gBAC7BC,QAAQ,CAAC,UAAU,EAAEjB,MAAMe,OAAO,CAACC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC7CE,iBAAiBC,IAAAA,WAAK,EAACnB,MAAMe,OAAO,CAACC,GAAG,CAAC,IAAI,EAAE;YACjD,IACA;;QAERI,cAAc;YACZ,IAAIxB,eAAeS,UAAUgB,OAAO,EAAElB;YACtCE,UAAUgB,OAAO,GAAG;QACtB;QACAC,cAAc;YACZ,IAAI1B,eAAe,CAACC,qBAAqBM;YACzCE,UAAUgB,OAAO,GAAG;QACtB;QACAE,SAASC,CAAAA;YACPA,MAAMC,cAAc;YACpBD,MAAME,eAAe;YACrB,IAAIxB,0BAA2CN,aAAa;YAC5DD,SAAS;gBAAEN;gBAAIC;YAAW;QAC5B;QACAqC,SACEzB,yBACAA,0BACAT,aACAC,YACI,oBACA;kBAGL,AAACD,aAAa,CAACD,iBAAkBE,0BAChC;;gBAAE;8BAEA,qBAACkC,sBAAgB;oBAACC,MAAK;;gBAAS;;aAIlC3B;;AAIR"}