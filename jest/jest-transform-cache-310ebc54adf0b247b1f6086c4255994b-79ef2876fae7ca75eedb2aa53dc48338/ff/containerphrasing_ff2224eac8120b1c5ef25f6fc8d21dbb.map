{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/node_modules/mdast-util-to-markdown/lib/util/container-phrasing.js"],"sourcesContent":["/**\n * @typedef {import('../types.js').Handle} Handle\n * @typedef {import('../types.js').Info} Info\n * @typedef {import('../types.js').PhrasingParents} PhrasingParents\n * @typedef {import('../types.js').State} State\n */\n\n/**\n * Serialize the children of a parent that contains phrasing children.\n *\n * These children will be joined flush together.\n *\n * @param {PhrasingParents} parent\n *   Parent of flow nodes.\n * @param {State} state\n *   Info passed around about the current state.\n * @param {Info} info\n *   Info on where we are in the document we are generating.\n * @returns {string}\n *   Serialized children, joined together.\n */\nexport function containerPhrasing(parent, state, info) {\n  const indexStack = state.indexStack\n  const children = parent.children || []\n  /** @type {Array<string>} */\n  const results = []\n  let index = -1\n  let before = info.before\n\n  indexStack.push(-1)\n  let tracker = state.createTracker(info)\n\n  while (++index < children.length) {\n    const child = children[index]\n    /** @type {string} */\n    let after\n\n    indexStack[indexStack.length - 1] = index\n\n    if (index + 1 < children.length) {\n      /** @type {Handle} */\n      // @ts-expect-error: hush, it’s actually a `zwitch`.\n      let handle = state.handle.handlers[children[index + 1].type]\n      /** @type {Handle} */\n      // @ts-expect-error: hush, it’s actually a `zwitch`.\n      if (handle && handle.peek) handle = handle.peek\n      after = handle\n        ? handle(children[index + 1], parent, state, {\n            before: '',\n            after: '',\n            ...tracker.current()\n          }).charAt(0)\n        : ''\n    } else {\n      after = info.after\n    }\n\n    // In some cases, html (text) can be found in phrasing right after an eol.\n    // When we’d serialize that, in most cases that would be seen as html\n    // (flow).\n    // As we can’t escape or so to prevent it from happening, we take a somewhat\n    // reasonable approach: replace that eol with a space.\n    // See: <https://github.com/syntax-tree/mdast-util-to-markdown/issues/15>\n    if (\n      results.length > 0 &&\n      (before === '\\r' || before === '\\n') &&\n      child.type === 'html'\n    ) {\n      results[results.length - 1] = results[results.length - 1].replace(\n        /(\\r?\\n|\\r)$/,\n        ' '\n      )\n      before = ' '\n\n      // To do: does this work to reset tracker?\n      tracker = state.createTracker(info)\n      tracker.move(results.join(''))\n    }\n\n    results.push(\n      tracker.move(\n        state.handle(child, parent, state, {\n          ...tracker.current(),\n          before,\n          after\n        })\n      )\n    )\n\n    before = results[results.length - 1].slice(-1)\n  }\n\n  indexStack.pop()\n\n  return results.join('')\n}\n"],"names":["containerPhrasing","parent","state","info","indexStack","children","results","index","before","push","tracker","createTracker","length","child","after","handle","handlers","type","peek","current","charAt","replace","move","join","slice","pop"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA;;;;;CAKC,GAED;;;;;;;;;;;;;CAaC;;;;+BACeA;;;eAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAT,SAASA,kBAAkBC,MAAM,EAAEC,KAAK,EAAEC,IAAI;IACnD,MAAMC,aAAaF,MAAME,UAAU;IACnC,MAAMC,WAAWJ,OAAOI,QAAQ,IAAI,EAAE;IACtC,0BAA0B,GAC1B,MAAMC,UAAU,EAAE;IAClB,IAAIC,QAAQ,CAAC;IACb,IAAIC,SAASL,KAAKK,MAAM;IAExBJ,WAAWK,IAAI,CAAC,CAAC;IACjB,IAAIC,UAAUR,MAAMS,aAAa,CAACR;IAElC,MAAO,EAAEI,QAAQF,SAASO,MAAM,CAAE;QAChC,MAAMC,QAAQR,QAAQ,CAACE,MAAM;QAC7B,mBAAmB,GACnB,IAAIO;QAEJV,UAAU,CAACA,WAAWQ,MAAM,GAAG,EAAE,GAAGL;QAEpC,IAAIA,QAAQ,IAAIF,SAASO,MAAM,EAAE;YAC/B,mBAAmB,GACnB,oDAAoD;YACpD,IAAIG,SAASb,MAAMa,MAAM,CAACC,QAAQ,CAACX,QAAQ,CAACE,QAAQ,EAAE,CAACU,IAAI,CAAC;YAC5D,mBAAmB,GACnB,oDAAoD;YACpD,IAAIF,UAAUA,OAAOG,IAAI,EAAEH,SAASA,OAAOG,IAAI;YAC/CJ,QAAQC,SACJA,OAAOV,QAAQ,CAACE,QAAQ,EAAE,EAAEN,QAAQC,OAAO;gBACzCM,QAAQ;gBACRM,OAAO;eACJJ,QAAQS,OAAO,KACjBC,MAAM,CAAC,KACV;QACN,OAAO;YACLN,QAAQX,KAAKW,KAAK;QACpB;QAEA,0EAA0E;QAC1E,qEAAqE;QACrE,UAAU;QACV,4EAA4E;QAC5E,sDAAsD;QACtD,yEAAyE;QACzE,IACER,QAAQM,MAAM,GAAG,KAChBJ,CAAAA,WAAW,QAAQA,WAAW,IAAG,KAClCK,MAAMI,IAAI,KAAK,QACf;YACAX,OAAO,CAACA,QAAQM,MAAM,GAAG,EAAE,GAAGN,OAAO,CAACA,QAAQM,MAAM,GAAG,EAAE,CAACS,OAAO,CAC/D,eACA;YAEFb,SAAS;YAET,0CAA0C;YAC1CE,UAAUR,MAAMS,aAAa,CAACR;YAC9BO,QAAQY,IAAI,CAAChB,QAAQiB,IAAI,CAAC;QAC5B;QAEAjB,QAAQG,IAAI,CACVC,QAAQY,IAAI,CACVpB,MAAMa,MAAM,CAACF,OAAOZ,QAAQC,OAAO,wCAC9BQ,QAAQS,OAAO;YAClBX;YACAM;;QAKNN,SAASF,OAAO,CAACA,QAAQM,MAAM,GAAG,EAAE,CAACY,KAAK,CAAC,CAAC;IAC9C;IAEApB,WAAWqB,GAAG;IAEd,OAAOnB,QAAQiB,IAAI,CAAC;AACtB"}