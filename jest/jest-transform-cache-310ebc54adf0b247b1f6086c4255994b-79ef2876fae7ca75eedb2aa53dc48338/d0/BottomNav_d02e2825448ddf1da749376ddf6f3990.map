{"version":3,"sources":["/Users/mcattaneo/workspace/frontend/libs/react/web/common/layout/src/BottomNav/BottomNav/BottomNav.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\"\nimport { useNavigate } from \"react-router-dom\"\nimport { useUser } from \"@clerk/clerk-react\"\nimport { ADD_CHAT_BUTTON_ID } from \"@rp/common/settings\"\nimport { getUserInitials } from \"@rp/common/utils\"\nimport { LoadingSpinner } from \"@rp/react/web/common/base-components\"\nimport { useHandleNewQuery, useHashParams } from \"@rp/react/web/common/hooks\"\nimport { useDeviceInfo } from \"@rp/react/web/common/hooks\"\nimport { AutoCompleteMobile } from \"@rp/react/web/common/search-autosuggest-input\"\nimport { BottomNavigation, Paper, SvgIcon, Typography } from \"@rp/react/web/mui/core\"\nimport { Add, FormatListBulleted } from \"@rp/react/web/mui/icons\"\nimport {\n  CHATS_ROUTE,\n  CHAT_ROUTE,\n  FILES_ROUTE,\n  HOME_ROUTE,\n  SEARCHES_ROUTE,\n  SEARCH_ID_ROUTE,\n  WATCHLISTS_ROUTE,\n  WATCHLIST_EDIT,\n  WATCHLIST_ID_ROUTE,\n  useRouteTracker,\n} from \"@rp/react/web/router\"\nimport { HeaderAvatar } from \"../../Header/Header.styles\"\nimport { BottomNavigationButton, BottomNavigationButtonStyled } from \"../BottomNavigationButton\"\nimport { DrawerUserMenu } from \"../DrawerUserMenu\"\nimport { DrawerMyContent } from \"./DrawerMyContent\"\n\ntype Props = {\n  isSearchOpen: boolean\n  setIsSearchOpen: (isOpen: boolean) => void\n  openAdminPanel: () => void\n  openSubscriptionManagement: () => void\n}\n\nconst BottomNav = ({\n  isSearchOpen,\n  setIsSearchOpen,\n  openAdminPanel,\n  openSubscriptionManagement,\n}: Props) => {\n  const { isIOS, safeArea } = useDeviceInfo()\n  const navigate = useNavigate()\n  const { handleNewQuery, isLoading } = useHandleNewQuery()\n  const pathname = useRouteTracker()\n  const [value, setValue] = useState(pathname)\n\n  const { user } = useUser()\n  const [{ document: documentId }] = useHashParams()\n\n  // Drawer\n  const [openDrawer, setOpenDrawer] = useState(false)\n  const [myContentDrawer, setMyContentDrawer] = useState(false)\n\n  const WATCHLISTS_ROUTES = useMemo(\n    () => [WATCHLISTS_ROUTE, WATCHLIST_EDIT, WATCHLIST_ID_ROUTE],\n    [],\n  )\n\n  const MY_CONTENT_ROUTES = useMemo(() => {\n    return [SEARCHES_ROUTE, FILES_ROUTE, CHATS_ROUTE, ...WATCHLISTS_ROUTES]\n  }, [WATCHLISTS_ROUTES])\n\n  const userInitials = getUserInitials(user?.fullName)\n\n  useEffect(() => {\n    setIsSearchOpen(false)\n    setValue(MY_CONTENT_ROUTES.includes(pathname) ? \"my-content\" : pathname)\n  }, [MY_CONTENT_ROUTES, pathname, setIsSearchOpen])\n\n  const handleChange = (_event?: React.SyntheticEvent, newValue?: string) => {\n    if (!newValue || newValue === \"user-menu\") {\n      return\n    }\n\n    if (newValue === \"my-content\") {\n      setMyContentDrawer(prev => !prev)\n      return\n    }\n\n    // Open the Autosuggest if no ran search\n    if (newValue === SEARCH_ID_ROUTE) {\n      setIsSearchOpen(true)\n      return\n    }\n\n    // Scroll to top when click the button in the same page\n    if (newValue !== HOME_ROUTE && newValue === pathname) {\n      window.scrollTo({ top: 0, behavior: \"smooth\" })\n      return\n    }\n\n    setTimeout(() => window.scrollTo({ top: 0, behavior: \"smooth\" }), 100)\n  }\n\n  const iconSize = {\n    height: \"26px\",\n    fontSize: \"26px\",\n  }\n\n  if (isLoading) {\n    return <LoadingSpinner fillBackground />\n  }\n\n  return (\n    <>\n      <Paper\n        sx={theme => ({\n          position: \"fixed\",\n          bottom: 0,\n          left: 0,\n          right: 0,\n          zIndex: 2,\n          paddingBottom: safeArea.bottom,\n          borderTop: `1px solid ${theme.palette.outline.sidebar}`,\n          display: documentId ? \"none\" : undefined,\n        })}\n        elevation={3}\n      >\n        <BottomNavigation\n          sx={{ gap: 0.5, \"& button\": { padding: 0 } }}\n          showLabels\n          value={value}\n          onChange={handleChange}\n          className=\"bottom-nav\"\n        >\n          <BottomNavigationButton\n            tag=\"My Content\"\n            value=\"my-content\"\n            icon={<SvgIcon component={FormatListBulleted} inheritViewBox sx={{ ...iconSize }} />}\n            iconDisabled={\n              <SvgIcon component={FormatListBulleted} inheritViewBox sx={{ ...iconSize }} />\n            }\n            selected={MY_CONTENT_ROUTES.includes(pathname)}\n          />\n          <BottomNavigationButton\n            tag=\"Chat\"\n            id={ADD_CHAT_BUTTON_ID}\n            icon={\n              <SvgIcon\n                component={Add}\n                inheritViewBox\n                sx={{\n                  height: 20,\n                  width: 20,\n                  mb: 0.5,\n                  backgroundColor: \"primary.main\",\n                  color: \"surface.main\",\n                  borderRadius: 1,\n                }}\n              />\n            }\n            onClick={() => {\n              navigate(CHAT_ROUTE, { state: { new: true } })\n            }}\n            iconDisabled={\n              <SvgIcon\n                component={Add}\n                inheritViewBox\n                sx={{\n                  height: 20,\n                  width: 20,\n                  mb: 0.5,\n                  backgroundColor: \"primary.main\",\n                  color: \"surface.main\",\n                  borderRadius: 1,\n                }}\n              />\n            }\n            selected={false}\n          />\n          <BottomNavigationButtonStyled\n            onClick={() => setOpenDrawer(!openDrawer)}\n            value=\"user-menu\"\n            label={<Typography>You</Typography>}\n            icon={\n              <HeaderAvatar\n                sx={{\n                  height: 24,\n                  width: 24,\n                  fontSize: \"10px\",\n                }}\n                src={user?.hasImage ? user?.imageUrl : undefined}\n                alt={user?.fullName ?? \"User Avatar\"}\n              >\n                {userInitials}\n              </HeaderAvatar>\n            }\n          />\n        </BottomNavigation>\n      </Paper>\n      <DrawerMyContent\n        open={myContentDrawer}\n        onChange={newPath => {\n          setMyContentDrawer(!myContentDrawer)\n          handleChange(undefined, newPath)\n        }}\n        onClose={() => setMyContentDrawer(false)}\n      />\n      <DrawerUserMenu\n        openSubscriptionManagement={openSubscriptionManagement}\n        openAdminPanel={openAdminPanel}\n        open={openDrawer}\n        toggleDrawer={() => setOpenDrawer(!openDrawer)}\n      />\n\n      {isSearchOpen || isLoading ? (\n        <AutoCompleteMobile\n          forceShowRecentSearches\n          onClose={() => {\n            /**\n             * HACK for IOS browser\n             * we should find a proper way of fixing this defect\n             * https://ravenpack.atlassian.net/browse/RPX-2159\n             */\n            if (isIOS) {\n              setTimeout(() => window.scrollTo({ top: 0 }))\n            }\n          }}\n          onChange={handleNewQuery}\n          searchActions={{ isOpen: isSearchOpen, setIsOpen: setIsSearchOpen }}\n        />\n      ) : null}\n    </>\n  )\n}\n\nexport { BottomNav }\n"],"names":["BottomNav","isSearchOpen","setIsSearchOpen","openAdminPanel","openSubscriptionManagement","isIOS","safeArea","useDeviceInfo","navigate","useNavigate","handleNewQuery","isLoading","useHandleNewQuery","pathname","useRouteTracker","value","setValue","useState","user","useUser","document","documentId","useHashParams","openDrawer","setOpenDrawer","myContentDrawer","setMyContentDrawer","WATCHLISTS_ROUTES","useMemo","WATCHLISTS_ROUTE","WATCHLIST_EDIT","WATCHLIST_ID_ROUTE","MY_CONTENT_ROUTES","SEARCHES_ROUTE","FILES_ROUTE","CHATS_ROUTE","userInitials","getUserInitials","fullName","useEffect","includes","handleChange","_event","newValue","prev","SEARCH_ID_ROUTE","HOME_ROUTE","window","scrollTo","top","behavior","setTimeout","iconSize","height","fontSize","LoadingSpinner","fillBackground","Paper","sx","theme","position","bottom","left","right","zIndex","paddingBottom","borderTop","palette","outline","sidebar","display","undefined","elevation","BottomNavigation","gap","padding","showLabels","onChange","className","BottomNavigationButton","tag","icon","SvgIcon","component","FormatListBulleted","inheritViewBox","iconDisabled","selected","id","ADD_CHAT_BUTTON_ID","Add","width","mb","backgroundColor","color","borderRadius","onClick","CHAT_ROUTE","state","new","BottomNavigationButtonStyled","label","Typography","HeaderAvatar","src","hasImage","imageUrl","alt","DrawerMyContent","open","newPath","onClose","DrawerUserMenu","toggleDrawer","AutoCompleteMobile","forceShowRecentSearches","searchActions","isOpen","setIsOpen"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAmOSA;;;eAAAA;;;;uBAnOoC;gCACjB;4BACJ;0BACW;uBACH;gCACD;uBACkB;wCAEd;sBAC0B;uBACrB;wBAYjC;8BACsB;wCACwC;gCACtC;iCACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAShC,MAAMA,YAAY,CAAC,EACjBC,YAAY,EACZC,eAAe,EACfC,cAAc,EACdC,0BAA0B,EACpB;IACN,MAAM,EAAEC,KAAK,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,oBAAa;IACzC,MAAMC,WAAWC,IAAAA,2BAAW;IAC5B,MAAM,EAAEC,cAAc,EAAEC,SAAS,EAAE,GAAGC,IAAAA,wBAAiB;IACvD,MAAMC,WAAWC,IAAAA,uBAAe;IAChC,MAAM,CAACC,OAAOC,SAAS,GAAGC,IAAAA,eAAQ,EAACJ;IAEnC,MAAM,EAAEK,IAAI,EAAE,GAAGC,IAAAA,mBAAO;IACxB,MAAM,CAAC,EAAEC,UAAUC,UAAU,EAAE,CAAC,GAAGC,IAAAA,oBAAa;IAEhD,SAAS;IACT,MAAM,CAACC,YAAYC,cAAc,GAAGP,IAAAA,eAAQ,EAAC;IAC7C,MAAM,CAACQ,iBAAiBC,mBAAmB,GAAGT,IAAAA,eAAQ,EAAC;IAEvD,MAAMU,oBAAoBC,IAAAA,cAAO,EAC/B,IAAM;YAACC,wBAAgB;YAAEC,sBAAc;YAAEC,0BAAkB;SAAC,EAC5D,EAAE;IAGJ,MAAMC,oBAAoBJ,IAAAA,cAAO,EAAC;QAChC,OAAO;YAACK,sBAAc;YAAEC,mBAAW;YAAEC,mBAAW;eAAKR;SAAkB;IACzE,GAAG;QAACA;KAAkB;IAEtB,MAAMS,eAAeC,IAAAA,sBAAe,EAACnB,iBAAAA,2BAAAA,KAAMoB,QAAQ;IAEnDC,IAAAA,gBAAS,EAAC;QACRrC,gBAAgB;QAChBc,SAASgB,kBAAkBQ,QAAQ,CAAC3B,YAAY,eAAeA;IACjE,GAAG;QAACmB;QAAmBnB;QAAUX;KAAgB;IAEjD,MAAMuC,eAAe,CAACC,QAA+BC;QACnD,IAAI,CAACA,YAAYA,aAAa,aAAa;YACzC;QACF;QAEA,IAAIA,aAAa,cAAc;YAC7BjB,mBAAmBkB,CAAAA,OAAQ,CAACA;YAC5B;QACF;QAEA,wCAAwC;QACxC,IAAID,aAAaE,uBAAe,EAAE;YAChC3C,gBAAgB;YAChB;QACF;QAEA,uDAAuD;QACvD,IAAIyC,aAAaG,kBAAU,IAAIH,aAAa9B,UAAU;YACpDkC,OAAOC,QAAQ,CAAC;gBAAEC,KAAK;gBAAGC,UAAU;YAAS;YAC7C;QACF;QAEAC,WAAW,IAAMJ,OAAOC,QAAQ,CAAC;gBAAEC,KAAK;gBAAGC,UAAU;YAAS,IAAI;IACpE;IAEA,MAAME,WAAW;QACfC,QAAQ;QACRC,UAAU;IACZ;IAEA,IAAI3C,WAAW;QACb,qBAAO,qBAAC4C,8BAAc;YAACC,cAAc;;IACvC;QAiFmBtC;IA/EnB,qBACE;;0BACE,qBAACuC,WAAK;gBACJC,IAAIC,CAAAA,QAAU,CAAA;wBACZC,UAAU;wBACVC,QAAQ;wBACRC,MAAM;wBACNC,OAAO;wBACPC,QAAQ;wBACRC,eAAe3D,SAASuD,MAAM;wBAC9BK,WAAW,CAAC,UAAU,EAAEP,MAAMQ,OAAO,CAACC,OAAO,CAACC,OAAO,CAAC,CAAC;wBACvDC,SAASjD,aAAa,SAASkD;oBACjC,CAAA;gBACAC,WAAW;0BAEX,cAAA,sBAACC,sBAAgB;oBACff,IAAI;wBAAEgB,KAAK;wBAAK,YAAY;4BAAEC,SAAS;wBAAE;oBAAE;oBAC3CC,UAAU;oBACV7D,OAAOA;oBACP8D,UAAUpC;oBACVqC,WAAU;;sCAEV,qBAACC,8CAAsB;4BACrBC,KAAI;4BACJjE,OAAM;4BACNkE,oBAAM,qBAACC,aAAO;gCAACC,WAAWC,yBAAkB;gCAAEC,cAAc;gCAAC3B,IAAI,mBAAKN;;4BACtEkC,4BACE,qBAACJ,aAAO;gCAACC,WAAWC,yBAAkB;gCAAEC,cAAc;gCAAC3B,IAAI,mBAAKN;;4BAElEmC,UAAUvD,kBAAkBQ,QAAQ,CAAC3B;;sCAEvC,qBAACkE,8CAAsB;4BACrBC,KAAI;4BACJQ,IAAIC,4BAAkB;4BACtBR,oBACE,qBAACC,aAAO;gCACNC,WAAWO,UAAG;gCACdL,cAAc;gCACd3B,IAAI;oCACFL,QAAQ;oCACRsC,OAAO;oCACPC,IAAI;oCACJC,iBAAiB;oCACjBC,OAAO;oCACPC,cAAc;gCAChB;;4BAGJC,SAAS;gCACPxF,SAASyF,kBAAU,EAAE;oCAAEC,OAAO;wCAAEC,KAAK;oCAAK;gCAAE;4BAC9C;4BACAb,4BACE,qBAACJ,aAAO;gCACNC,WAAWO,UAAG;gCACdL,cAAc;gCACd3B,IAAI;oCACFL,QAAQ;oCACRsC,OAAO;oCACPC,IAAI;oCACJC,iBAAiB;oCACjBC,OAAO;oCACPC,cAAc;gCAChB;;4BAGJR,UAAU;;sCAEZ,qBAACa,oDAA4B;4BAC3BJ,SAAS,IAAMxE,cAAc,CAACD;4BAC9BR,OAAM;4BACNsF,qBAAO,qBAACC,gBAAU;0CAAC;;4BACnBrB,oBACE,qBAACsB,0BAAY;gCACX7C,IAAI;oCACFL,QAAQ;oCACRsC,OAAO;oCACPrC,UAAU;gCACZ;gCACAkD,KAAKtF,CAAAA,iBAAAA,2BAAAA,KAAMuF,QAAQ,IAAGvF,iBAAAA,2BAAAA,KAAMwF,QAAQ,GAAGnC;gCACvCoC,KAAKzF,CAAAA,iBAAAA,iBAAAA,2BAAAA,KAAMoB,QAAQ,cAAdpB,4BAAAA,iBAAkB;0CAEtBkB;;;;;;0BAMX,qBAACwE,gCAAe;gBACdC,MAAMpF;gBACNoD,UAAUiC,CAAAA;oBACRpF,mBAAmB,CAACD;oBACpBgB,aAAa8B,WAAWuC;gBAC1B;gBACAC,SAAS,IAAMrF,mBAAmB;;0BAEpC,qBAACsF,8BAAc;gBACb5G,4BAA4BA;gBAC5BD,gBAAgBA;gBAChB0G,MAAMtF;gBACN0F,cAAc,IAAMzF,cAAc,CAACD;;YAGpCtB,gBAAgBU,0BACf,qBAACuG,0CAAkB;gBACjBC,uBAAuB;gBACvBJ,SAAS;oBACP;;;;aAIC,GACD,IAAI1G,OAAO;wBACT8C,WAAW,IAAMJ,OAAOC,QAAQ,CAAC;gCAAEC,KAAK;4BAAE;oBAC5C;gBACF;gBACA4B,UAAUnE;gBACV0G,eAAe;oBAAEC,QAAQpH;oBAAcqH,WAAWpH;gBAAgB;iBAElE;;;AAGV"}